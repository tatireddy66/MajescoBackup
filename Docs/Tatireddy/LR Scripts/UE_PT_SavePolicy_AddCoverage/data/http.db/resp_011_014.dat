define("MP",["ContextMenu","Editor","Communication","PageHelper","RuleHelper"],function(f,a,g,e,c){var d=new function(h){return{StingrayJsVersion:"2.7.1.0",Initialize:function(j){jQuery.extend(d.Config,j);this.Tools.Initialize()},Modules:{description:"Various modules/objects"},Types:{description:"Type definitions"},Components:{description:"Screen components"},Editor:{description:"Editor tools"},Events:{description:"Core events"}}};var b=new function(){try{var j=null,n=null,q,o,v=this;function r(F,E,D,C){Log.Add("Tools."+F,E,D,C)}function u(){var D=$("#shell");var C={Editor:{html:{snap:[5,5],pageLayout:"middle"},ace:{enabled:true,theme:"chrome",codeTips:false,wordWrap:false},property:{pinned:false},toolBars:{developer:{width:0,position:{left:D.offset().left+D.width()+40,top:100}},page:{width:0,position:{left:D.offset().left-50,top:100}},process:{width:0,position:{left:D.offset().left+D.width()-20,top:100}}},tabs:{logging:{pinned:false,viewStyle:"float",position:{left:"center",top:"middle"},size:{width:600,height:400}},reqList:{pinned:false,filter:"",viewStyle:"float",showAll:false,filterVars:false,position:{left:"center",top:"middle"},size:{width:600,height:400}},watchList:{pinned:false,filter:"",viewStyle:"float",position:{left:"center",top:"middle"},size:{width:600,height:400}},ajax:{pinned:false,viewStyle:"float",position:{left:"center",top:"middle"},size:{width:600,height:400}},process:{extendBy:500}}},ScriptFunctions:[]};$.extend(b.Config,C)}function l(E,G,D,F){var C=n.find("#"+E);if(G){if(!C.length){C=$(D);if(q){q.after(C)}else{n.append(C)}if(F){C.bind("click",F)}}q=C}else{C.remove()}}function y(){try{if(j){return}r("InitToolbar","Called");j=$('<div id="DevToolBar" class="verticalToolbar aboveSpinner"/>');$("#bottom").after(j);n=$('<div class="toolbarSection">');j.append(n);j.draggable({cancel:"img",start:function(E,F){Global.DisableHighlightingInChrome(true)},stop:function(E,F){Global.DisableHighlightingInChrome(false);Global.UpdateLastPosition(j,F)}}).resizable({start:function(){Global.DisableHighlightingInChrome(true)},stop:function(E,F){Global.DisableHighlightingInChrome(false)}}).disableSelection();var C=b.Config.Editor.toolBars.developer;j.css("left",C.position.left+"px").css("top",C.position.top+"px").data("lastLeft",C.position.left).data("lastTop",C.position.top);if(C.width){j.css("width",C.width+"px")}$(window).bind("scroll.DevToolBar",function(){if(j.is(":visible")){j.css("top",(j.data("lastTop")+$(document).scrollTop())+"px")}})}catch(D){r("InitToolbar",D,Log.Type.Error)}}function A(C){if(b.Config.loggingEnabled){Log.Show(C)}}function z(C){if(b.Config.reqlistEnabled){ReqList.Show(C)}}function w(C){if(b.Config.watchlistEnabled){WatchList.Show(C)}}function k(C){if(b.Config.ajaxEnabled){AjaxTab.Show(C)}}function m(E){var G=$("#shell");var F="30px";if(!E){E=b.Config.Editor.html.pageLayout;E=E.toLowerCase();var D=["middle","left","right"];var C=$.inArray(E,D);if(C>=0&&C<=1){C++}else{C=0}E=D[C]}else{E=E.toLowerCase()}b.Config.Editor.html.pageLayout=E;switch(E){case"left":G.css("margin-left",F);G.css("margin-right","auto");break;case"right":G.css("margin-left","auto");G.css("margin-right",F);break;default:G.css("margin-left","auto");G.css("margin-right","auto");break}}function s(){}function h(){var C=e.ValidatePage()+c.ValidatePage();if(C){jAlert("There are some warnings on this page. Please view details in the logging pane.<p>"+C+"</p>","Page validation")}else{jAlert("No problems found. Page seem OK.","Page validation")}}function t(){var J=function(){var K=C.find("option:selected");if(K.length!=1){jAlert("Only a single VRM page can be open!");return}else{return $(K[0]).val()}};var E=function(){g.CustomRequest("admintabs.max?action=ReloadPages","VrmPageListDD",null,null);C.focus()};var F=function(){var K=J();if(!K){return}I.dialog("close");g.EditorRequest(K)};var D=function(){I.dialog("close");g.EditorCreateNew();C.html("")};var H=function(){var K=J();if(!K){return}I.dialog("close");jPrompt("Please enter a new name",K,"Copy a VRM page",function(M){if(M==null){return}var L=function(O){try{O=$.parseJSON(O);if(!Utilities.IsObject(O)){throw"Bad response! Expected object!"}if(O.newPage){r("CopyPage","New "+O.newPage+".vrm & "+O.newPage+".sql files created.",Log.Type.Debug);g.EditorRequest(O.newPage);C.html("");return}if(O.error){jAlert(O.error);return}throw"Bad response! No page or error!"}catch(P){r("CopyPage",P,Log.Type.Error)}};var N=$.param({oldPage:K,newPage:M});g.CustomRequest("admintabs.max?action=CopyPage",L,null,N)})};var C;var I=$("#SelectPageToEditDlg");if(!I.length){C=$('<select id="VrmPageListDD" multiple=""></select>');C.bind("dblclick",F).bind("keydown",function(K){if(K.keyCode==$.ui.keyCode.ENTER){F()}});I=$('<div id="SelectPageToEditDlg"></div>');I.html(C);var G={Reload:E,New:D,Copy:H,Open:F};I.dialog({width:300,height:400,autoOpen:false,closeOnEscape:true,resizable:true,modal:true,buttons:G,dialogClass:"clientDialog",title:"Select a VRM page",open:function(){if(!a.Enabled){b.ToolsInForeground(false)}if(!C.find("option").length){E()}C.focus()},close:function(){if(!a.Enabled){b.ToolsInForeground(true)}}})}I.dialog("open")}function B(){var C=function(H){E.dialog("close");var L=b.Config.Editor;var J=$(document);var F=function(M,N){if(N.data("lastLeft")&&N.data("lastTop")){M.position.left=N.data("lastLeft");M.position.top=N.data("lastTop");M.size.width=Utilities.ToNumber(N.parent().width());M.size.height=Utilities.ToNumber(N.parent().height())}};var K=j;if(K.length){L.toolBars.developer.position.left=K.data("lastLeft");L.toolBars.developer.position.top=K.data("lastTop");L.toolBars.developer.width=Utilities.ToNumber(K.width())}K=$("#RuleToolbar");if(K.length){L.toolBars.process.position.left=K.data("lastLeft");L.toolBars.process.position.top=K.data("lastTop");L.toolBars.process.width=Utilities.ToNumber(K.width())}K=$("#ComponentToolbar");if(K.length){L.toolBars.page.position.left=K.data("lastLeft");L.toolBars.page.position.top=K.data("lastTop");L.toolBars.page.width=Utilities.ToNumber(K.width())}K=$("#LoggingDiv");if(K.length){F(L.tabs.logging,K)}K=$("#ReqListDiv");if(K.length){F(L.tabs.reqList,K)}K=$("#WatchListDiv");if(K.length){F(L.tabs.watchList,K)}K=$("#AjaxDiv");if(K.length){F(L.tabs.ajax,K)}var I='Cfg="Editor":';if(H){I+="{}"}else{I+=encodeURIComponent(JSON.stringify(L))}var G="admintabs.max?action=SaveConfig";g.CustomRequest(G,null,null,I)};var E=$("#SaveConfigurationDlg");if(!E.length){E=$('<div id="SaveConfigurationDlg"></div>');E.html("<p>You can either save your current configuration or reset to the default settings.<p/><p>In order to see the default setting you must re-login.</p>");var D={"Reset to default":function(){C(true)},"Save current":function(){C(false)}};E.dialog({width:370,height:180,autoOpen:false,closeOnEscape:true,resizable:false,modal:true,buttons:D,dialogClass:"clientDialog",title:"Save User Preferences",open:function(){if(!a.Enabled){b.ToolsInForeground(false)}},close:function(){if(!a.Enabled){b.ToolsInForeground(true)}}})}E.dialog("open")}function x(C){C=(C)?C:"";jAlert(C+d.StingrayJsVersion)}return{description:"Debugging tools",Initialized:false,Enabled:false,Config:{},ConfigUpdate:function(C){$.extend(this.Config,C);this.ShowToolbar()},ShowToolbar:function(){try{var E=this.Config,C;if(!this.Initialized||E.isEditor){return}y();C=E.loggingEnabled;l("dtbLog",C,'<img id="dtbLog" title="Open a Log Viewer" src="../../images/dev-logging.png" />',function(){A()});C=E.reqlistEnabled;l("dtbRL",C,'<img id="dtbRL" title="Open a ReqList Viewer" src="../../images/dev-reqlist.png" />',function(){z()});C=E.watchlistEnabled;l("dtbWL",C,'<img id="dtbWL" title="Open a WatchList Viewer" src="../../images/dev-watchlist.png" />',function(){w()});C=E.ajaxEnabled;l("dtbAjax",C,'<img id="dtbAjax" title="Open an Ajax Viewer" src="../../images/dev-ajax.png" />',function(){k()});C=true;l("dtbPos",C,'<img id="dtbPos" title="Toggle Page Layout" src="../../images/dev-layout.png" />',function(){m()});C=!a.Enabled;l("dtbSel",C,'<img id="dtbSel" title="Select a page to edit" src="../../images/dev-select.png" />',t);C=!a.Enabled;l("dtbEdit",C,'<img id="dtbEdit" title="Edit this page" src="../../images/dev-edit.png" />',function(){g.EditorRequest()});C=JSON&&JSON.stringify;l("dtbCfg",C,'<img id="dtbCfg" title="Save current configuration and layout" src="../../images/dev-config.png" />',B);C=a.Enabled;l("dtbSrch",C,'<img id="dtbSrch" title="Find on the page" src="../../images/dev-search.png" />',function(){a.Search()});C=a.Enabled;l("dtbVal",C,'<img id="dtbVal" title="Validate this page" src="../../images/dev-validation.png" />',h);C=a.Enabled&&!a.LockedBy;l("dtbQSave",C,'<img id="dtbQSave" title="Save without leaving the editor (Quick save)" src="../../images/dev-quick.png" />',function(){PropertyEd.QuickSave()});C=a.Enabled&&!a.LockedBy;l("dtbFSave",C,'<img id="dtbFSave" title="Save and exit (Full save)" src="../../images/dev-save.png" />',function(){PropertyEd.Save()});C=a.Enabled;l("dtbExit",C,'<img id="dtbExit" title="Exit without saving the page (Cancel editing)" src="../../images/dev-exit.png" />',function(){PropertyEd.Disable()});C=!a.Enabled;l("dtbVer",C,'<img id="dtbVer" title="Show version" src="../../images/dev-version.png" />',function(){x("Client Version: ")});j.toggleClass("aboveSpinner",!a.Enabled)}catch(D){r("ShowToolbar",D,Log.Type.Error)}},Initialize:function(D){try{var F=$("#DeveloperTabs");if(this.Initialized||!F.length||!F.find("div").is(":visible")){return}g.EnableSessionTimer=false;F.tabs();u();$.extend(true,this.Config,D);var C=this.Config.ScriptFunctions;C=C.sort(function(H,G){return H.name>G.name});Log.Initialize();ReqList.Initialize();WatchList.Initialize();AjaxTab.Initialize();f.Initialize();RulesMaker.Initialize($("#preproc"),$("#postproc"));m(this.Config.Editor.html.pageLayout);o=$("#vrmName","#bottom");this.Enabled=true;this.Initialized=true;this.ShowToolbar()}catch(E){r("Initialize",E,Log.Type.Error)}},AceIsEnabled:function(){return !Browser.IsMSIE()&&window.ace&&this.Config.Editor.ace.enabled},ToolsInForeground:function(C){$("#DevToolBar").toggleClass("aboveSpinner",C);$("#LoggingDiv").parent().toggleClass("aboveSpinner",C);$("#ReqListDiv").parent().toggleClass("aboveSpinner",C);$("#WatchListDiv").parent().toggleClass("aboveSpinner",C);$("#AjaxDiv").parent().toggleClass("aboveSpinner",C)},ShowVrmName:function(C){if(!this.Initialized||!C){return}o.html('VRM page name: "'+C.toUpperCase()+'"')}}}catch(p){r("Main",p,Log.Type.Error)}};d.Tools=b;return d});CustomScript=new function(){this.Reset=function(){jQuery.each(CustomScript,function(a,b){if(a!="Reset"){CustomScript[a]=null}})}};if(!JSON){var JSON={parse:function(c){var a=/^[\],:{}\s]*$/;var b=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g;var d=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g;var e=/(?:^|:|,)(?:\s*\[)+/g;if(typeof c!=="string"||!c){return null}c=jQuery.trim(c);if(a.test(c.replace(b,"@").replace(d,"]").replace(e,""))){return(new Function("return "+c))()}else{jQuery.error("Invalid JSON: "+c)}}}}define("Log",[],function(){var b=new function(){this.Error="error";this.Info="info";this.Warning="warning";this.Debug="debug";this.Search="search"};var a=new function(h){var e=null,j,r,s,c=null,p=0,f=new Date(),m;function o(u){p++;var t=$("<tr/>");t.append("<td class='index'>"+p+"</td>");t.append("<td class='time'>"+u.Time+"</td>");t.append("<td class='source'>"+u.Source+"</td>");var v=$("<td class='"+u.Type+"' />");v.append(u.Message);t.append(v);return t}function k(v,u,t){this.Source=v;this.Message=u;this.Time=Utilities.GetFormattedTime();this.Type=t}function g(){p=0;if(c){c.empty().remove()}c=$('<table class="Logging"><tr><th>ID</th><th>Time</th><th>Source</th><th>Message</th></tr></table>');s.append(c);$("#dtbLog").removeClass("error warning debug search")}function n(){if(p<3000){return}if((p%100)==0){c.find("tr:gt(0):lt(101)").empty().remove()}}function q(){m=MP.Tools.Config.Editor.tabs.logging;if(!m.size){m.size={width:600,height:400}}}function l(){if(a.Enabled){e.dialog("option","title","Log viewer")}else{e.dialog("option","title","Log viewer - Disabled")}var u=$(".ui-dialog-buttonpane",e.parent());var t=function(v){return $("button:contains("+v+")",u)};if(a.Enabled){t("Enable").html("Disable")}else{t("Disable").html("Enable")}if(m.pinned){t("Pin").html("Unpin")}else{t("Unpin").html("Pin")}if(r==j){t("Tab View").html("View Here")}else{t("View Here").html("Tab View")}}function d(t){if(!Utilities.IsObject(t)){return t}var u;if(t.message){u=t.message}else{u=t.Message.description}u+=" [";if(t.fileName){u+=t.fileName+", "}if(t.lineNumber){u+=t.lineNumber+", "}if(t.EntryID){u+=t.EntryID}else{u+=p}u+="]";return u}return{Enabled:false,Initialized:false,Debug:function(t){this.Add("DEBUG",t,b.Debug)},Add:function(v,B,t,D){t=t||b.Info;D=D||false;if(!this.Initialized){if(t!=b.Error){return}if(window.console!=h&&window.console.log!=h){console.log(v," Error: ",B)}var x=new Date();var w=new Date(x-f);if(w>2000&&$.inArray(v,["Comm.CustomRequest","Comm.SerialRequest","Comm.LinkRequest"])==-1){f=x;var A="ReqList="+ReqList.GetList();var E=$("#middle").attr("VRMName");var y=d(B);var u="Logging.max?action=log&Source="+v+" ("+Global.Version()+")&VRMName="+E+"&Message="+y;Communication.CustomRequest(u,null,null,A)}return}if(this.Enabled&&s.is(":visible")||$.inArray(t,[b.Error,b.Warning,b.Debug,b.Search])>-1){n();var y="";var z=Utilities.IsObject(B);if(t==b.Search&&z){y=$("<a>Locate</a>");y.bind("click",function(){var G;if(B.GetControl){G=B.GetControl()}else{G=B.Icon.GetImage();var F=G.parent().attr("ID");RulesMaker.ShowProcessTab(F)}Global.ScrollToElement(G,null,function(){Global.ShakeElement(G)})});B.HighlightAsFound(true)}else{y=d(B)}var C=new k(v,y,t);c.append(o(C));if(C.Type!=b.Info){$("#dtbLog").toggleClass(C.Type,true)}}if(t==b.Error&&!D){throw B}},ClearTab:function(){if(!this.Initialized){return}g();this.Add("Log.ClearTab","Called")},Show:function(t){if(!this.Initialized){return}e.dialog("open");if(t&&!this.Enabled){this.Switch()}},Hide:function(){if(this.Initialized){e.dialog("close")}},Switch:function(){this.Enabled=!this.Enabled;l()},Pin:function(t){if(t==h){m.pinned=!m.pinned}else{m.pinned=t}l();if(m.pinned){$(window).bind("scroll.pinLogDiv",function(){var u=e.parent();if(u.is(":visible")){u.css("top",(e.data("lastTop")+$(document).scrollTop())+"px")}})}else{$(window).unbind("scroll.pinLogDiv")}},MoveTo:function(t){if(!t){t=(r==e)?"tab":"float"}else{t=t.toLowerCase()}m.viewStyle=t;var v=s.detach();var u='This view is inactive. You can either <a class="activateViewLink">activate this view</a> or <a class="goToViewLink">go to the other view</a>.';if(t=="tab"){r=j;this.Hide();e.html(u);e.find(".activateViewLink").bind("click",function(){a.MoveTo("float")});e.find(".goToViewLink").bind("click",function(){a.Hide();Global.ScrollToElement($("#LoggingLink"))});j.html("");v.appendTo(j);if(this.Initialized){Global.ScrollToElement($("#LoggingLink"))}}else{r=e;j.html(u);j.find(".activateViewLink").bind("click",function(){a.MoveTo("tab")});j.find(".goToViewLink").bind("click",function(){a.Show();Global.ScrollToElement(e.parent())});e.html("");v.appendTo(e)}l()},Initialize:function(){try{if(!MP.Tools.Config.loggingEnabled||this.Initialized){return}q();j=$("#LoggingTab");e=$("#LoggingDiv");if(!e.length){e=$('<div id="LoggingDiv"><div class="toolWrapper"></div></div>')}s=e.find(".toolWrapper");r=e;var u={Clear:function(){a.ClearTab()},Enable:function(){a.Switch()},Pin:function(){a.Pin()},"Tab View":function(){a.MoveTo()}};e.dialog({width:m.size.width,height:m.size.height,position:[m.position.left,m.position.top],minWidth:300,minHeight:200,autoOpen:false,closeOnEscape:false,modal:false,buttons:u,dialogClass:"aboveSpinner",resizeStart:function(){Global.DisableHighlightingInChrome(true)},resizeStop:function(){Global.DisableHighlightingInChrome(false)},dragStart:function(v,w){Global.DisableHighlightingInChrome(true)},dragStop:function(v,w){Global.DisableHighlightingInChrome(false);Global.UpdateLastPosition(e,w)},open:function(v){l();if(e.data("lastLeft")&&e.data("lastTop")){e.dialog("option",{position:[e.data("lastLeft"),e.data("lastTop")]})}else{Global.UpdateLastPosition(e)}}});g();this.MoveTo(m.viewStyle);this.Pin(m.pinned||false);this.Initialized=true}catch(t){this.Add("Initialize",t,b.Error)}}}};a.Type=b;return a});TransferListHelper=new function(){var a="TrfListHelper.";function c(j,h,g,f){Log.Add(a+j,h,g,f)}function b(g,f){this.Left=g;this.Right=f}function e(g){try{c("GetLists","Called");var k=$(g).parents(".StaticContainer");var f=$(k).find("select")[0];var j=$(k).find("select")[1];return new b($(f),$(j))}catch(h){c("GetLists",h,Log.Type.Error)}}function d(m,l,j){try{c("TransferSelected","Called");var f=new Array();for(var h=0;h<m[0].options.length;h++){var g=m[0].options[h];if(g.selected||j){f.push(g)}}for(var h=0;h<f.length;h++){var g=f[h];$(g).remove().appendTo(l);$(g).removeAttr("selected")}Utilities.SortSelect(m);Utilities.SortSelect(l)}catch(k){c("TransferSelected",k,Log.Type.Error)}}return{MoveSelectedLeft:function(f){try{c("MoveSelectedLeft","Called");var h=e(f);d(h.Right,h.Left,false)}catch(g){c("MoveSelectedLeft",g,Log.Type.Error)}},MoveSelectedRight:function(f){try{c("MoveSelectedRight","Called");var h=e(f);d(h.Left,h.Right,false)}catch(g){c("MoveSelectedRight",g,Log.Type.Error)}},MoveAllLeft:function(f){try{c("MoveAllLeft","Called");var h=e(f);d(h.Right,h.Left,true)}catch(g){c("MoveAllLeft",g,Log.Type.Error)}},MoveAllRight:function(f){try{c("MoveAllRight","Called");var h=e(f);d(h.Left,h.Right,true)}catch(g){c("MoveAllRight",g,Log.Type.Error)}},Serialize:function(h){try{c("Serialize","Called");var f="";$(h).find(".component").each(function(){if($(this).attr("TransferList")!=null){$(this).find("select").each(function(){var j=$(this).attr("name");f+="&"+j+"_count="+$(this)[0].options.length;for(var l=0;l<$(this)[0].options.length;l++){var k=$(this)[0].options[l];f+="&"+j+"_"+l+"="+$(k).attr("value")}})}});return f}catch(g){c("Serialize",g,Log.Type.Error)}}}};define("Storage",[],function(){function a(){try{var c="Storage.";var b=this;var d=new Array();function e(l,k,j,h){Log.Add(c+l,k,j,h)}function g(j,h){this.Component=j;this.ID=h;this.Destroy=function(){this.Component=null;this.ID=null}}this.AddComponent=function(j,h){try{e("AddComponent","Called");var l=new g(j,h);d[d.length]=l}catch(k){e("AddComponent",k,Log.Type.Error)}};this.GetComponent=function(h){try{for(var j=0;j<d.length;j++){var l=d[j];if(l.ID==h){return l.Component}}return null}catch(k){e("GetComponent",k,Log.Type.Error)}};this.GetCount=function(){return d.length};this.GetItemArray=function(){try{e("GetItemArray","Called");var j=new Array();for(var h=0;h<d.length;h++){j[h]=d[h].Component}return j}catch(k){e("GetItemArray",k,Log.Type.Error)}};this.GetIdArray=function(){try{e("GetIdArray","Called");var j=new Array();for(var h=0;h<d.length;h++){j[h]=d[h].ID}return j}catch(k){e("GetIdArray",k,Log.Type.Error)}};this.Remove=function(h){try{e("Remove","Called: "+h);for(var j=0;j<d.length;j++){var l=d[j];if(l.ID==h){l.Destroy();d.splice(j,1);return}}}catch(k){e("Remove",k,Log.Type.Error)}};this.Reset=function(){try{e("Reset","Called");for(var h=0;h<d.length;h++){d[h].Destroy()}d=null;d=new Array()}catch(j){e("Reset",j,Log.Type.Error)}}}catch(f){e("Main",f,Log.Type.Error)}}return a});define("Helper",["PageHelper"],function(b){var a=new function(){this.GetEditorComponent=function(c){return b.GetEditorComponent(c)},this.RemoveComponentID=function(c){b.RemoveComponentID(c)}};return a});define("PageHelper",["Storage","ContextMenu","ContextMenuItems"],function(h,f,e){var j={EditorCheckBox:"EditorCheckBox",EditorDropDown:"EditorDropDown",EditorLabel:"EditorLabel",EditorLink:"EditorLink",EditorDiv:"EditorDiv",EditorMemo:"EditorMemo",EditorRadio:"EditorRadio",EditorSubmitButton:"EditorSubmitButton",EditorText:"EditorText",TransferList:"TransferList",EditableContent:"EditableContent",DynamicContainer:"DynamicContainer",StaticContainer:"StaticContainer",ScriptingContainer:"ScriptingContainer",ValidationContainer:"ValidationContainer"};var k=[];var d=[];var g;for(g in j){if(Object.prototype.hasOwnProperty.call(j,g)){k.push(j[g]);d.push(g)}}var a={};require(k,function(){for(var l=0;l<d.length;++l){a[d[l]]=arguments[l]}});var c={};require(["Editor"],function(l){c=l});var b=new function(){try{var y="PgHelper.",z=0,r=new Array(),v=new h(),o="",x="";function m(D,C,B,A){Log.Add(y+D,C,B,A)}function w(B,E,A){try{m("CreateComponent","Called");var C="";var D=a[B];var G=new D();if(G==null){throw"A component '"+B+"' could not be created!"}if(G.NameRequired){if(B=="TransferList"){C=E||Utilities.PromptForName(false);if(C==Utilities.ModalResult.Cancel||C==Utilities.ModalResult.Empty){return false}}else{C=B.replace("Editor","");if(A){C=E||C}else{C=b.MakeUniquePageID(E||C)}}}G.Create(C);G.GetControl()[0][B]=G;return G}catch(F){m("CreateComponent",F,Log.Type.Error)}}function s(A){var B=b.GetEditorComponent(A);B.EditMode();b.AddStoredComponent(B);var C=$(A);if(!C.is(":visible")){m("AddEditorToComponent","Incompatible element! To hide the element use 'Client Condition' property instead setting its visibility in style!\n"+Utilities.IdentifyChildren(C),Log.Type.Warning);C.attr("isHidden",true);C.show()}return B}function q(A){try{var D=b.GetEditorComponent(A);if(!D){return}var F=b.GetComponentID(A);v.Remove(F);D.HighlightAsSelected(false);D.HighlightAsFound(false);D.HighlightAsError(false);D.DefaultMode();var E=$(A);if(E.attr("isHidden")){E.removeAttr("isHidden");E.hide()}var B=E.attr("Class");B=Utilities.RemoveWhiteSpaces(B);B=Utilities.Trim(B);E.attr("Class",B);E.removeAttr("origL");E.removeAttr("origT");E.removeAttr("unselectable");E.removeAttr("aria-disabled");if(E.attr("condition")==""){E.removeAttr("condition")}E.removeClass("ui-resizable-autohide");E.removeClass("ui-state-disabled");E.find(".ui-selectee").removeClass("ui-selectee")}catch(C){m("RemoveEditorFromComponent",C,Log.Type.Error,true)}}function u(A){try{z+=1;m("SetComponentID","ID="+z);$(A).attr("EditorID",z)}catch(B){m("SetComponentID",B,Log.Type.Error)}}function l(){try{if(!r.length){var A=f.EventComponent;var C=b.GetComponentID(A);if(!C){C=b.GetParentID(A)}b.AddSelected(C)}}catch(B){m("EnsureSelection",B,Log.Type.Error)}}function n(A){var B;var C=s(A);if(C.GetID){B=C.GetID();B=b.MakeUniquePageID(B);C.SetID(B)}if(C.GetName){B=C.GetName();B=b.MakeUniquePageID(B);C.SetName(B)}b.AddSelected(C);return C}function t(B,A){var F=$('<div class="mp-help"/>');F.appendTo(B);F.bind("click",function(){var G=window.open(A,"helplink","width=500,height=500,scrollbars=1,resizable=1,toolbar=0,location=0,menubar=0,status=0");G.focus()});var E=B.attr("ref");if($.inArray(E,["EditorText","EditorMemo","EditorDropDown","EditorSubmitButton"])>-1){var D=(E=="EditorSubmitButton")?8:2;var C=B.find(":input");F.css({top:C.position().top+C.outerHeight()/2-F.outerHeight()/2+1,left:C.position().left+C.outerWidth()+D})}return F}return{Search:function(C,B){var A=v.GetItemArray();if(C){m("Search","Searching "+A.length+" HTML elements for '"+C+"'",Log.Type.Debug)}else{m("Search","Clearing",Log.Type.Info)}$.each(A,function(){var D=this;try{D.Search(C,B);D.HighlightAsError(false)}catch(E){m("BadComponent",D,Log.Type.Search);D.HighlightAsError(true)}})},ClearStoredComponents:function(){try{m("ClearStoredComponents","Called");v.Reset();z=0}catch(A){m("ClearStoredComponents",A,Log.Type.Error)}},AddStoredComponent:function(A){try{if(A){m("AddStoredComponent","Called");u(A.GetControl());v.AddComponent(A,z)}}catch(B){m("AddStoredComponent",B,Log.Type.Error)}},GetStoredComponent:function(B){try{return v.GetComponent(B)}catch(A){m("GetStoredComponent",A,Log.Type.Error)}},CreateEditorComponent:function(B,C,A){try{if(!B){throw"No reference!"}m("CreateEditorComponent","Called");var E=w(B,C,A);b.AddStoredComponent(E);return E}catch(D){m("CreateEditorComponent",D,Log.Type.Error)}},DeleteEditorComponent:function(A){try{var C=b.GetComponentID(A);if(C){m("DeleteEditorComponent","Called");v.Remove(C);$(A).remove()}}catch(B){m("DeleteEditorComponent",B,Log.Type.Error)}},GetEditorComponent:function(B){try{B=$(B);var E=b.GetComponentRef(B);if(!E){throw"Missing ref attribute!"}var F=null;var A=B[0];try{F=A[E];if(!F){throw"Error!"}return F}catch(D){var C=a[E];if(!C){throw'The control of type "'+E+'" not initialized!'}F=new C();F.Load(B);A[E]=F;return F}}catch(D){m("GetEditorComponent",D.message||D+" "+Utilities.IdentifyChildren(B),Log.Type.Error)}},MakeUniquePageID:function(C,F){if(!C){return""}var B=C.replace(/\d+$/,"");var G=B;var A=F||0;var E,D=0;while(true){E=$("#"+G,"#rightColumn").length;if(E<=A){break}D++;G=B+D.toString()}return G},GetComponentRefByID:function(D){var B=b.GetStoredComponent(D),C=B.GetControl(),A=b.GetComponentRef(C);return A},GetParentRef:function(A){try{var D=$(A)[0].parentNode;var C=b.GetComponentRef(D);return C}catch(B){m("GetParentRef",B,Log.Type.Error)}},GetParentID:function(A){try{var C=$(A)[0].parentNode;var D=b.GetComponentID(C);return D}catch(B){m("GetParentID",B,Log.Type.Error)}},GetParentCtrl:function(A){try{var D=$(A)[0].parentNode;var C=b.GetComponentCtrl(D);return C}catch(B){m("GetParentCtrl",B,Log.Type.Error)}},GetComponentRef:function(A){try{return $(A).attr("ref")}catch(B){m("GetComponentRef",B,Log.Type.Error)}},GetComponentID:function(A){try{return $(A).attr("EditorID")}catch(B){m("GetComponentID",B,Log.Type.Error)}},GetComponentCtrl:function(A){try{return b.GetEditorComponent(A)}catch(B){m("GetComponentCtrl",B,Log.Type.Error)}},RemoveComponentID:function(A){try{var C=b.GetComponentID(A);if(C){m("RemoveComponentID","ID="+C);$(A).removeAttr("EditorID")}}catch(B){m("RemoveComponentID",B,Log.Type.Error)}},IsSelected:function(A){return(A&&$.inArray(A,r)>-1)},GetSelected:function(){return r},AddSelected:function(B){if(!B){return}if(Utilities.IsObject(B)){var A=B;B=b.GetComponentID(A.GetControl())}else{var A=b.GetStoredComponent(B)}if(b.IsSelected(B)){return}if(A&&A.HighlightAsSelected){A.HighlightAsSelected(true);r.push(B)}},Select:function(D){try{m("Select","Called");b.ClearSelected();var J=f.EventComponent;var A=b.GetComponentRef(J);if($.inArray(A,["StaticContainer"])==-1){return}var L=b.GetComponentID(J);if(!L){return}var I=v.GetItemArray();for(var H=0;H<I.length;H++){var G=I[H],B=G.GetControl(),C=b.GetParentID(B),F=b.GetComponentRef(B),K=false;if(C==L&&!F.match(/Container/)){switch(D){case"all":K=true;break;case"below":K=G.GetTop&&G.GetTop()>f.OffsetY-30;break;case"right":K=G.GetLeft&&G.GetLeft()>f.OffsetX;break;case"above":K=G.GetTop&&G.GetTop()<f.OffsetY-30;break;case"left":K=G.GetLeft&&G.GetLeft()<f.OffsetX;break}if(K){b.AddSelected(G)}}}}catch(E){m("SelectBelow",E,Log.Type.Error)}},ClearSelected:function(){try{m("ClearSelected","Called");for(var A=0;A<r.length;A++){var C=b.GetStoredComponent(r[A]);if(C&&C.HighlightAsSelected){C.HighlightAsSelected(false)}}r=null;r=[]}catch(B){m("ClearSelected",B,Log.Type.Error)}},SnapToGrid:function(){try{m("SnapToGrid","Called");l();var B=MP.Tools.Config.Editor.html.snap;for(var C=0;C<r.length;C++){var E=b.GetStoredComponent(r[C]);if(!E){continue}var A=E.GetLeft();A=Utilities.SnapTo(A,B[0]);E.SetLeft(A);var F=E.GetTop();F=Utilities.SnapTo(F,B[1]);E.SetTop(F)}}catch(D){m("SnapToGrid",D,Log.Type.Error)}},GetMost:function(D){l();if(!r.length){return 0}D=D.toLowerCase();var B,C,E,A=9999999;for(B=0;B<r.length;B++){C=b.GetStoredComponent(r[B]);if(C){E=(D=="top")?C.GetTop():C.GetLeft();A=E<A?E:A}}return A},AlignLeft:function(){try{m("AlignLeft","Called");var C,E,B=b.GetMost("left"),A=MP.Tools.Config.Editor.html.snap;B=Utilities.SnapTo(B,A[0]);for(C=0;C<r.length;C++){E=b.GetStoredComponent(r[C]);if(E){E.SetLeft(B)}}}catch(D){m("AlignLeft",D,Log.Type.Error)}},AlignRight:function(){try{m("AlignRight","Called");l();var D,F,H,C,B,G=0;for(D=0;D<r.length;D++){F=b.GetStoredComponent(r[D]);if(F){H=F.GetControl();C=H.width();B=F.GetLeft()+C;G=B>G?B:G}}var A=MP.Tools.Config.Editor.html.snap;G=Utilities.SnapTo(G,A[0]);for(D=0;D<r.length;D++){F=b.GetStoredComponent(r[D]);if(F){H=F.GetControl();C=H.width();F.SetLeft(G-C)}}}catch(E){m("AlignRight",E,Log.Type.Error)}},AlignTop:function(){try{m("AlignTop","Called");var B,D,E=b.GetMost("top"),A=MP.Tools.Config.Editor.html.snap;E=Utilities.SnapTo(E,A[1]);for(B=0;B<r.length;B++){D=b.GetStoredComponent(r[B]);if(D){D.SetTop(E)}}}catch(C){m("AlignTop",C,Log.Type.Error)}},SpaceVertically:function(){try{m("SpaceVertically","Called");l();jPrompt("Please enter a vertical spacing between tops of the selected components",40,"Space Vertically",function(D){if(D==null){return}var F,I,B=[];for(F=0;F<r.length;F++){I=b.GetStoredComponent(r[F]);if(I){B.push(I)}}B.sort(function(K,J){return(J.GetTop()<K.GetTop())});var E=Utilities.ToNumber(D);var C,H,G;for(F=0;F<B.length;F++){I=B[F];G=I.GetTop();if(F==0){C=G;H=G}else{if(H!=G){C=C+E;H=G}}I.SetTop(C)}})}catch(A){m("SpaceVertically",A,Log.Type.Error)}},SpaceHorizontally:function(){try{m("SpaceHorizontally","Called");l();jPrompt("Please enter a horizontal spacing between left sides of the selected components",100,"Space Horizontally",function(D){if(D==null){return}var F,H,B=[];for(F=0;F<r.length;F++){H=b.GetStoredComponent(r[F]);if(H){B.push(H)}}B.sort(function(K,J){return(J.GetLeft()<K.GetLeft())});var E=Utilities.ToNumber(D);var G,I,C;for(F=0;F<B.length;F++){H=B[F];C=H.GetLeft();if(F==0){G=C;I=C}else{if(I!=C){G=G+E;I=C}}H.SetLeft(G)}})}catch(A){m("SpaceHorizontally",A,Log.Type.Error)}},Duplicate:function(){try{m("Duplicate","Called");var A=f.EventComponent,C=b.GetComponentRef(A);if($.inArray(C,["ScriptingContainer","StaticContainer","DynamicContainer","EditableContent"])>-1){jAlert("Only a single component can be verticaly duplicated. For containers use copy/paste.");return}b.ClearSelected();l();if(r.length!=1){return}jPrompt("Please enter how many copies and their vertical spacing","5, 20","Duplicate Component",function(O){if(O==null){return}var J=O.split(","),K=(J.length>0)?parseInt(J[0]):0,D=(J.length>1)?parseInt(J[1]):0;if(!K){return}D=D||20;var E=b.GetStoredComponent(r[0]),N=E.GetTop(),I=b.GetHtmlOfSelectedComponents(false),F=E.GetControl(),P=b.GetParentCtrl(F),G=b.GetParentRef(F);for(var H=0;H<K;H++){var M=b.AddComponentFromHtmlString(I,P);if(G=="StaticContainer"){N+=D;M.SetTop(N)}else{var L=M.GetControl();L.css("position","relative").css("left","").css("top","").css("width","");E.Refresh()}}})}catch(B){m("Duplicate",B,Log.Type.Error)}},Questionnaire:function(){try{m("Questionnaire","Called");var A=f.EventComponent,D=b.GetComponentRef(A);if(D!="StaticContainer"){jAlert("Questionnaires may be built only in body of static containers!");return}var F=$('<div id="QuestionnaireDlg"><label>Question = Name:</label><br><textarea id="data"/><p></p></div>');var E=$("p",F);E.append('Width <input id="width" value="500" style="width: 50px"/> ');E.append('Spacing <input id="spacing" value="25" style="width: 50px"/> ');E.append('Fill <input id="fill" value=" ." style="width: 50px"/> ');var H=$("#data",F);var C={Build:function(N){x=H.val();var K=x.split("\n"),L=Utilities.ToNumber($("#width",F).val())||500,P=Utilities.ToNumber($("#spacing",F).val())||25,M=$("#fill",F).val(),J=MP.Tools.Config.Editor.html.snap,I=Utilities.SnapTo(f.OffsetX,J[0]),O=Utilities.SnapTo(f.OffsetY,J[1]);$.each(K,function(T,Q){var T=Q.search(/=[^=]*$/);if(T<0){return}var R=Q.substring(0,T).trim(),S=Q.substring(T+1).trim(),V;V=b.CreateEditorComponent("EditorLabel","");V.AppendTo(A);V.SetLeft(I);V.SetTop(O);V.SetCaption(R);if(M){var U=V.GetControl();while(U.width()<L){R=R+M;V.SetCaption(R)}}V=b.CreateEditorComponent("EditorRadio",S,true);V.AppendTo(A);V.SetLeft(I+L+20);V.SetTop(O);V.SetCaption("Yes");V=b.CreateEditorComponent("EditorRadio",S,true);V.AppendTo(A);V.SetLeft(I+L+70);V.SetTop(O);V.SetCaption("No");V.SetValue("0");O+=P});F.dialog("close")},"Load Last":function(I){H.val(x);H.focus()}};var G=function(){var I=F.height();H.height(I-60)};F.dialog({width:500,height:400,autoOpen:false,closeOnEscape:true,modal:true,buttons:C,title:"Build Questionnaire",resizeStart:function(){Global.DisableHighlightingInChrome(true)},resizeStop:function(){Global.DisableHighlightingInChrome(false);G()},dragStart:function(){Global.DisableHighlightingInChrome(true)},dragStop:function(){Global.DisableHighlightingInChrome(false)},close:function(){F.remove()},open:function(){H.focus();G()}});F.dialog("open")}catch(B){m("Questionnaire",B,Log.Type.Error)}},SortTabIndex:function(){try{m("SortTabIndex","Called");l();jPrompt("Please enter an initial Tab Index value",1,"SortTabIndex",function(D){if(D==null){return}var E,F,C=[];for(E=0;E<r.length;E++){F=b.GetStoredComponent(r[E]);if(F){C.push(F)}}C.sort(function(H,G){var H=H.GetTop()+"."+H.GetLeft();var G=G.GetTop()+"."+G.GetLeft();H=parseFloat(H);G=parseFloat(G);return(G<H)});var B=Utilities.ToNumber(D);for(E=0;E<C.length;E++){F=C[E];F.SetTabIndex(B);B++}})}catch(A){m("SortTabIndex",A,Log.Type.Error)}},SetProperty:function(A,B,D){try{m("SetProperty",A);l();jPrompt("Please enter a value for "+D,B,A,function(E){if(E==null){return}if(Utilities.IsNumber(B)){E=Utilities.ToNumber(E)}for(var F=0;F<r.length;F++){var G=b.GetStoredComponent(r[F]);if(G&&G[A]){if($.inArray(A,["SetID","SetName"])>-1){E=b.MakeUniquePageID(E)}G[A](E)}}})}catch(C){m("SetProperty",C,Log.Type.Error)}},MakeContextMenu:function(){try{var A=new e();var B;B=A.Add("Copy >");A.Add("To Browser",function(){b.CopyToBrowser(false)},B);if(Browser.IsMSIE()){A.Add("To Clipboard",function(){b.CopyToClipboard(false)},B)}A.Add("To Text Area",function(){b.CopyToTextarea(false)},B);B=A.Add("Cut >");A.Add("To Browser",function(){b.CopyToBrowser(true)},B);if(Browser.IsMSIE()){A.Add("To Clipboard",function(){b.CopyToClipboard(true)},B)}A.Add("To Text Area",function(){b.CopyToTextarea(true)},B);B=A.Add("Paste >");A.Add("From Browser",function(){b.PasteFromBrowser()},B);if(Browser.IsMSIE()){A.Add("From Clipboard",function(){b.PasteFromClipboard()},B)}A.Add("From Text Area",function(){b.PasteFromTextarea()},B);B=A.Add("Select >");A.Add("All",function(){b.Select("all")},B);A.Add("Below",function(){b.Select("below")},B);A.Add("Right",function(){b.Select("right")},B);A.Add("Above",function(){b.Select("above")},B);A.Add("Left",function(){b.Select("left")},B);B=A.Add("Component >");A.Add("Delete",function(){b.DeleteSelection()},B);A.Add("HTML",function(){b.EditHTML()},B);A.Add("Duplicate",function(){b.Duplicate()},B);A.Add("Questionnaire",function(){b.Questionnaire()},B);B=A.Add("Position >");A.Add("Snap to Grid",function(){b.SnapToGrid()},B);A.Add("Align Left",function(){b.AlignLeft()},B);A.Add("Align Top",function(){b.AlignTop()},B);A.Add("Align Right",function(){b.AlignRight()},B);A.Add("Set Left",function(){b.SetProperty("SetLeft",b.GetMost("left")||10,"Left")},B);A.Add("Set Top",function(){b.SetProperty("SetTop",b.GetMost("top")||10,"Top")},B);A.Add("Space Vertically",function(){b.SpaceVertically()},B);A.Add("Space Horizontally",function(){b.SpaceHorizontally()},B);A.Add("Sort Tab Index",function(){b.SortTabIndex()},B);B=A.Add("Property >");A.Add("Required",function(){b.SetProperty("SetRequired",true,"Required")},B);A.Add("Width",function(){b.SetProperty("SetWidth",100,"Width")},B);A.Add("Height",function(){b.SetProperty("SetHeight",50,"Height")},B);A.Add("Caption",function(){b.SetProperty("SetCaption","","Caption")},B);A.Add("Tooltip",function(){b.SetProperty("SetTooltip","Please enter a...","Tooltip")},B);A.Add("Server Cond.",function(){b.SetProperty("SetSvrCondition","","Server Condition")},B);A.Add("Client Cond.",function(){b.SetProperty("SetCliCondition","","Client Condition")},B);A.Add("Tab Index",function(){b.SetProperty("SetTabIndex",1,"Tab Index")},B);A.Add("Name",function(){b.SetProperty("SetName","Component1","Name")},B);A.Add("ID",function(){b.SetProperty("SetID","Component1","ID")},B);A.Add("Valueless Attr.",function(){b.SetProperty("SetValueLessAttrs","","Valueless Attributes")},B);A.Add("Style",function(){b.SetProperty("SetStyle","","Style")},B);A.Add("Class",function(){b.SetProperty("SetClass","Default","Class")},B);A.Add("Value",function(){b.SetProperty("SetValue","1","Value")},B);A.Add("Size",function(){b.SetProperty("SetSize","","Size")},B);A.Add("Help Link",function(){b.SetProperty("SetHelpLink","../../help.html","Size")},B);A.Add("Options",function(){b.SetProperty("SetOptions","<option value='1'>Text</option>","Options")},B);A.Add("Multi Select",function(){b.SetProperty("SetMultiSelect",true,"Multi Select")},B);A.Add("Target",function(){b.SetProperty("SetTarget","Communication.LinkRequest();","Target")},B);A.Add("Flipped",function(){b.SetProperty("SetFlipped",true,"Flipped")},B);B=A.Add("Search >");A.Add("Search...",function(){c.Search()},B);A.Add("Clear",function(){c.ClearSearch()},B);B=A.Add("File >");if(c.Enabled&&!c.LockedBy){A.Add("Quick Save",function(){PropertyEd.QuickSave()},B);A.Add("Save & Exit",function(){PropertyEd.Save()},B)}A.Add("Exit...",function(){PropertyEd.Disable()},B);return A.GetHTML()}catch(C){m("MakeContextMenu",C,Log.Type.Error)}},CopyToBrowser:function(B){try{m("CopyToBrowser","Called");o=b.GetHtmlOfSelectedComponents(B)}catch(A){m("CopyToBrowser",A,Log.Type.Error)}},PasteFromBrowser:function(){try{m("PasteFromBrowser","Called");b.AddComponentsFromHtmlString(o)}catch(A){m("PasteFromBrowser",A,Log.Type.Error)}},CopyToClipboard:function(B){try{m("CopyToClipboard","Called");o=b.GetHtmlOfSelectedComponents(B);Global.SetClipboard(o)}catch(A){m("CopyToClipboard",A,Log.Type.Error)}},PasteFromClipboard:function(){try{m("PasteFromClipboard","Called");var A=Global.GetClipboard();b.AddComponentsFromHtmlString(A)}catch(B){m("PasteFromClipboard",B,Log.Type.Error)}},CopyToTextarea:function(B){try{m("CopyToTextarea","Called");o=b.GetHtmlOfSelectedComponents(B);c.ShowTextareaForm(o)}catch(A){m("CopyToTextarea",A,Log.Type.Error)}},PasteFromTextarea:function(){try{m("PasteFromTextarea","Called");c.ShowTextareaForm("",function(B){b.AddComponentsFromHtmlString(B)})}catch(A){m("PasteFromTextarea",A,Log.Type.Error)}},DeleteSelection:function(){try{m("DeleteSelection","Called");l();c.HideProperties();for(var A=0;A<r.length;A++){var D=b.GetStoredComponent(r[A]);if(D){var E=D.GetControl();var C=b.GetComponentRef(E);if($.inArray(C,["EditableContent"])>-1){continue}if($.inArray(C,["ScriptingContainer","StaticContainer","DynamicContainer"])==-1){b.DeleteEditorComponent(E);continue}jConfirm("You are about to delete an entire container!\nAre you sure?","Confirm Delete",function(F){if(F){b.DeleteEditorComponent(E)}})}}b.ClearSelected()}catch(B){m("DeleteSelection",B,Log.Type.Error)}},EditHTML:function(){try{m("EditHTML","Called");this.ClearSelected();var A=b.GetHtmlOfSelectedComponents(false);if(!A){return}l();c.ShowAceEditorForm(A,"HTML Editor","WARNING: Not following editor API may corrupt the page or the editor!",function(C){var G=b.GetSelected()[0];var E=b.GetStoredComponent(G);var F=E.GetControl();var D=b.GetParentRef(F);if($.inArray(D,["EditableContent","DynamicContainer"])>-1){F.after(C)}else{D=b.GetParentCtrl(F);D=D.GetControl();D.append(C)}b.ClearSelected();b.DeleteEditorComponent(F);b.ConvertDefaultToEditorComponents()})}catch(B){m("EditHTML",B,Log.Type.Error)}},ConvertDefaultToEditorComponents:function(A,D){D=D||$("#rightColumn");$(".component",D).each(function(){try{var F=b.GetComponentID(this);if(!F){s(this)}}catch(E){m("ConvertDefaultToEditorComponents",E,Log.Type.Error,true)}});if(A&&D.length){try{var C=b.GetComponentID(D);if(!C){s(D)}}catch(B){m("ConvertDefaultToEditorComponents",B,Log.Type.Error,true)}}},ConvertEditorToDefaultComponents:function(A){if(!A.length){return}$(".component",A).each(function(){q(this)});q(A)},AddComponentFromHtmlString:function(D,A){try{if(!D){return}var F=(A.GetControl)?A.GetControl():A;b.ClearSelected();var E=$(D);E.appendTo(F);var C=n(E);E.find(".component").each(function(){n(this)});return C}catch(B){m("AddComponentFromHtmlString",B,Log.Type.Error)}},AddComponentsFromHtmlString:function(C){try{if(!C){return}var K=f.EventComponent;var D=b.GetComponentRef(K);if($.inArray(D,["EditableContent","StaticContainer","DynamicContainer"])==-1){return}b.ClearSelected();o=C;var L=$(C);var G=9999999,E=9999999;var J=[];L.each(function(P,R){var U=$(L[P]);var Q=U.html();if(!Q){return}U.appendTo(K);var S=n(U);U.find(".component").each(function(){n(this)});var O=S.GetLeft();G=O<G?O:G;var T=S.GetTop();E=T<E?T:E;J.push(S)});for(var I=0;I<J.length;I++){var A=J[I];if(D=="StaticContainer"){var F=MP.Tools.Config.Editor.html.snap;var N=A.GetLeft()-G+f.OffsetX-5;var M=A.GetTop()-E+f.OffsetY-25;A.SetLeft(Utilities.SnapTo(N,F[0]));A.SetTop(Utilities.SnapTo(M,F[1]))}else{var B=A.GetControl();B.css("position","relative").css("left","").css("top","").css("width","");A.Refresh()}}return J}catch(H){m("AddComponentsFromHtmlString",H,Log.Type.Error)}},GetHtmlOfSelectedComponents:function(E){try{var A="";l();for(var B=0;B<r.length;B++){var F=b.GetStoredComponent(r[B]);if(F){var G=F.GetControl();var D=b.GetComponentRef(G);if($.inArray(D,["EditableContent"])>-1){continue}b.ConvertEditorToDefaultComponents(G);A+=G.formOuterHTML();if(E){G.remove()}else{b.ConvertDefaultToEditorComponents()}}}b.ClearSelected();A=b.CleanVRM(A);return A}catch(C){m("GetHtmlOfSelectedComponents",C,Log.Type.Error)}},ValidatePage:function(){try{b.Search();var A=v.GetItemArray(),E=0,F=0,C=0,B="";m("ValidatePage","Validating "+A.length+" HTML components",Log.Type.Debug);$.each(A,function(){var G=false,I=b.GetComponentRef(this.GetControl());if(this.GetTooltip&&this.GetName&&!this.GetTooltip()){E++;G=true;m(this.GetName()+".NoTooltip",this,Log.Type.Search)}if(this.GetName&&!this.GetName()){F++;G=true;m(I+".NoName",this,Log.Type.Search)}if($.inArray(I,["EditorRadio","EditableContent"])==-1){var J;if(!J&&this.GetID){J=this.GetID()}if(!J&&this.GetName){J=this.GetName()}if(J){var H=$('[id="'+J+'"]');if(H.length>1){C++;G=true;m(J+".DuplicateID",this,Log.Type.Search)}}}this.HighlightAsError(G)});if(E){B+="Missing tooltips: "+E+"<br>"}if(F){B+="Components with no names: "+F+"<br>"}if(C){B+="Duplicate IDs: "+C+"<br>"}if(B){m("ValidatePage","Discovered "+parseInt(E+F+C)+" possible problems!",Log.Type.Debug)}}catch(D){m("ValidatePage",D,Log.Type.Error)}return B},CleanVRM:function(B){try{m("CleanVRM","Called");B=B.replace(/done[0-9]{1,}=\"[0-9]{1,}\"\s{0,}/g,"");B=B.replace(/targetlink2onclick/g,"onclick");return B}catch(A){m("CleanVRM",A,Log.Type.Error)}},AddHelpLink:function(D){var C=D.GetControl(),B=D.GetHelpLink();if(!B){return}var E=function(){C.data("MouseIn",true);var G=$("div.mp-help",C);if(G.length){return}G=t(C,B);G.bind("mouseenter",function(){C.data("MouseIn",true)});G.bind("mouseleave",function(){C.data("MouseIn",false)});G.fadeIn(500)};var A=function(){var G=$("div.mp-help",C);if(!G.length){return}if(C.find("input,textarea,select").is(":focus")){return}C.data("MouseIn",false);setTimeout(function(){if(!C.data("MouseIn")){G.fadeOut(500,function(){G.remove()})}},500)};if(Global.FadingHelpLinks){C.bind("mouseenter",E);C.bind("focusin",E);C.bind("mouseleave",A);C.bind("focusout",A)}else{var F=$("div.mp-help",C);if(F.length){return}F=t(C,B);F.show()}}}}catch(p){m("Main",p,Log.Type.Error)}};return b});define("Editor",["PageHelper","RuleHelper","ContextMenu","IconMover","IconConnector","RuleStorage"],function(f,b,e,d,c,g){var a=new function(){try{var j="Editor.";var h=null;function k(p,o,n,m){Log.Add(j+p,o,n,m)}return{Enabled:false,Changing:false,VRMName:"",LockedBy:"",Search:function(){function m(){var q=$("#fw",o).val();var p=$("#cs",o)[0].checked;f.Search(q,p);b.Search(q,p)}var o=$("#SearchForDlg");if(!o.length){o=$('<div id="SearchForDlg" style="text-align: left;"><label for="fw">Find What:</label><input type="text" id="fw" name="fw" value=""/><br/><br/><input type="checkbox" id="cs" name="cs" value="1"/><label for="cs">Case sensitive</label></div>');var n={Search:function(p){m();o.dialog("close")},Clear:function(){a.ClearSearch();o.dialog("close")}};o.dialog({width:200,height:200,autoOpen:false,closeOnEscape:true,modal:true,buttons:n,title:"Find",open:function(){o.find("#fw").focus().select()}});o.keypress(function(p){if(p.keyCode==$.ui.keyCode.ENTER){m()}})}o.dialog("open")},ClearSearch:function(){f.Search();b.Search()},DeleteComponent:function(m){try{var o=m||h;if(!o){return}k("DeleteComponent","Called");a.HideProperties();f.DeleteEditorComponent(o);h=null}catch(n){k("DeleteComponent",n,Log.Type.Error)}},BuildComponent:function(p,o,n){try{if(p==null){k("BuildComponent","The Template control passed in did not specify a ref attribute",Log.Type.Error)}var r=f.CreateEditorComponent(p);if(r){r.AppendTo(o);r.Refresh();if(n){var m=MP.Tools.Config.Editor.html.snap;r.SetLeft(Utilities.SnapTo(n.left-5,m[0]));r.SetTop(Utilities.SnapTo(n.top-25,m[1]))}}}catch(q){k("BuildComponent",q,Log.Type.Error)}},DisableSelectibleInIE:function(n,m){if(!Browser.IsMSIE()){return}if(m){n.selectable("disable")}else{n.selectable("enable")}},DisableEditor:function(){try{if(!this.Enabled){return}k("DisableEditor","Called");this.Changing=true;$(".ShowOutEditor").children().show();var n=$("#rightColumn");f.ConvertEditorToDefaultComponents(n);f.ClearStoredComponents();n.undelegate(".component").undelegate(".EditorMemo").selectable("destroy");$("#preproc, #postproc").undelegate(".icon").selectable("destroy");this.Enabled=false;MP.Tools.ToolsInForeground(true);MP.Tools.ShowToolbar()}catch(m){k("DisableEditor",m,Log.Type.Error)}this.Changing=false},EnableEditor:function(q,n){try{if(this.Enabled){return}k("EnableEditor","Called");this.Changing=true;$(".HideInEditor").children().hide();this.VRMName=q||this.VRMName;if(this.VRMName){$("#middle").attr("VRMName",this.VRMName);MP.Tools.ShowVrmName(this.VRMName)}this.LockedBy=n;if(n){jAlert("This page is locked by "+n+"\nYou will not be able to save any changes!")}e.Add("#rightColumn",f.MakeContextMenu);var r=$("#rightColumn");f.ConvertDefaultToEditorComponents(true,r);r.delegate(".component","dblclick",function(s){s.stopPropagation();a.ShowProperties($(this))});r.delegate(".EditorMemo","click",function(s){s.stopPropagation();$(this).find("textarea").focus()});r=$("#preproc, #postproc");var o=false;var m=r;r.delegate(".icon","dblclick",function(s){var t=$(this).attr("id");RulesMaker.ShowProperties(t)});r.delegate(".icon","mousedown",function(t){try{o=true;a.DisableSelectibleInIE(m,true);var v=$(this).attr("id");d.Load(v);d.Enable();if(t.which==1){e.Hide()}var u=g.GetComponent(v);u.Icon.SetIconMover(d)}catch(s){k("MouseDown",s,Log.Type.Error)}});r.delegate(".icon","mouseup",function(u){try{o=false;var s=$(this);var w=s.attr("id");if(u.which==3){RulesMaker.SelectThisOnlyIfNotSelected(w)}c.IconClicked(w,u.which);d.Reset();var v=g.GetComponent(w);v.SetX(s.position().left);v.SetY(s.position().top);a.DisableSelectibleInIE(m,false)}catch(t){k("MouseUp",t,Log.Type.Error)}});r.bind("mousedown",function(t){try{if(o){return false}e.Hide();c.CanvasClicked(t.which)}catch(s){k("MouseDown",s,Log.Type.Error)}});r.selectable({filter:"img",selected:function(s,t){var u=$(t.selected).attr("id");RulesMaker.AddSelected(u)},start:function(s,t){Global.DisableHighlightingInChrome(true);RulesMaker.ClearSelected()},stop:function(s,t){Global.DisableHighlightingInChrome(false)}});this.Enabled=true;MP.Tools.ToolsInForeground(false);MP.Tools.ShowToolbar()}catch(p){k("EnableEditor",p,Log.Type.Error)}this.Changing=false},HideProperties:function(){try{k("HideProperties","Called");PropertyEd.Hide()}catch(m){k("HideProperties",m,Log.Type.Error)}},Refresh:function(){try{if(!this.Enabled){return}k("Refresh","Called");f.ConvertDefaultToEditorComponents(true)}catch(m){k("Refresh",m,Log.Type.Error)}},ShowProperties:function(m){try{k("ShowProperties","Called");var p=f.GetEditorComponent(m);var n=p.GetProperties();var q=p.refClassName;try{if(p.GetName){q=q+" - Name: "+p.GetName()}if(p.GetID){q=q+" - ID: "+p.GetID()}}catch(o){k("ShowProperties",o,Log.Type.Error,true)}h=$(m);PropertyEd.Show(n,a.DeleteComponent,q)}catch(o){k("ShowProperties",o,Log.Type.Error)}},GetProperties:function(){try{var n=f.GetEditorComponent(h);return n.GetProperties()}catch(m){k("GetProperties",m,Log.Type.Error)}},ShowAceEditorForm:function(p,s,o,t){var r;var q=$('<div id="AceEditorDlg"><label>'+o+'</label><br><textarea id="xc"/></div>');var m=q.find("#xc");var n={Apply:function(u){if(t){var v;if(r){v=r.getValue()}else{v=m.val()}t(v)}q.dialog("close")}};q.dialog({width:700,height:500,autoOpen:false,closeOnEscape:false,modal:true,buttons:n,title:s,resizeStart:function(){Global.DisableHighlightingInChrome(true)},resizeStop:function(){Global.DisableHighlightingInChrome(false);if(r){r.resize()}},dragStart:function(){Global.DisableHighlightingInChrome(true)},dragStop:function(){Global.DisableHighlightingInChrome(false)},close:function(){if(r){r.destroy()}q.remove()},open:function(){m.val(p);if(MP.Tools.AceIsEnabled()){r=Global.ConvertToAceEditor(m,"html",true)}}});q.dialog("open")},ShowTextareaForm:function(o,q){var p=$('<div id="CopyPasteDlg"><label>XML Code:</label><br><textarea id="xc"/></div>');var m=p.find("#xc");var n={OK:function(r){if(q){q(m.val())}p.dialog("close")}};p.dialog({width:400,height:400,autoOpen:false,closeOnEscape:true,modal:true,buttons:n,title:"Copy/Paste",resizeStart:function(){Global.DisableHighlightingInChrome(true)},resizeStop:function(){Global.DisableHighlightingInChrome(false)},dragStart:function(){Global.DisableHighlightingInChrome(true)},dragStop:function(){Global.DisableHighlightingInChrome(false)},close:function(){p.remove()},open:function(){m.val(o);m.focus();m.select()}});p.dialog("open")},GetAcceptedComponents:function(m){try{var p="";for(var n=0;n<m.length;n++){p+="img[ref='"+m[n]+"'],"}p=p.substring(0,p.length-1);return p}catch(o){k("GetAcceptedComponents",o,Log.Type.Error)}}}}catch(l){k("Main",l,Log.Type.Error)}};return a});define("PropertyFields",["ValidatorContainer"],function(c){var e={"":""};var b,d;for(b in c.Filters){if(!Object.prototype.hasOwnProperty.call(c.Filters,b)){continue}d=c.Filters[b];e[b]={text:d.name}}var a={EditorTextFilters:{label:"Filters",description:"Data filters",type:"multi",data:[{name:"Filter",label:"Filter",type:"select",data:e},{name:"DType",label:"Type",type:"select",data:",DATE,FLOAT,INTEGER,STRING".split(",")},{name:"Param",label:"Parameter",type:"text",sizeHint:"wide"}]},Borderless:{label:"Borderless",description:"Whether the control shows a border",type:"checkbox",live:true},Caption:{label:"Caption",description:"The caption of the component",type:"text",live:true,sizeHint:"wide"},HtmlBody:{label:"HTML body",description:"The HTML body of the component",type:"text",live:false,sizeHint:"large",language:"html"},Checked:{label:"Checked",description:"Whether or not the component is checked",type:"text",live:true,sizeHint:"small"},Class:{label:"Class",description:"The css class of the component",type:"select",data:["Default","PageTitle","DefaultBold","Required","RequiredBold","Extended","ExtendedBold","RequiredExtended","RequiredExtendedBold","InfoColor","AttentionColor"],live:true},ClassText:{label:"Class",description:"The css class of the component",type:"text",sizeHint:"wide",live:true},SvrCondition:{label:"Server Condition",description:"A server side script condition for the element to be delivered or not",type:"text",sizeHint:"wide"},CliCondition:{label:"Client Condition",description:"A client side JS condition for the element to be initially shown or not",type:"text",sizeHint:"wide"},DefaultButton:{label:"Default button",description:"Check to invoke the click event on enter key press on any element of the parent Static Container",type:"checkbox",live:false},EditHTML:{label:"Edit HTML",description:"Replaces the text area with an html editor",type:"checkbox",live:false},Spellcheck:{label:"Spellcheck",description:"Enables the text area to be spellchecked",type:"checkbox",live:false},Flipped:{label:"Flipped",description:"Flip input's side",type:"checkbox",live:true},Height:{label:"Height",description:"The height of the component",type:"text",sizeHint:"small",live:true},ID:{label:"ID",description:"The ID of the component",type:"text"},Left:{label:"Left",description:"The left position of the component",type:"text",live:true,sizeHint:"small"},MaxLength:{label:"Maximum length",description:"The maximum number of characters allowed",type:"text",live:true,sizeHint:"small"},MultiSelect:{label:"Multi-select",description:"Allow multiple items to be selected",type:"checkbox",live:true},Name:{label:"Name",description:"The name of the component",type:"text"},OnClick:{label:"On click",description:"The javascript that executes when the component is clicked",type:"text"},Options:{label:"Options",description:"The variable that fills the dropdown options",type:"text",sizeHint:"wide"},Required:{label:"Required",description:"If the component requires input",type:"checkbox",live:true},Secure:{label:"Secure",description:'Secure input with masked value. Use function "SecureVarForDisplay" to set the mask',type:"checkbox",live:false},Watchpoint:{label:"Watch Point",description:"Set a watchpoint which will cause Stingray to send all ReqList changes back to the editor",type:"checkbox",live:true},Scripts:{label:"Scripts",description:"Javascript functions that will be made available on this page",type:"text",live:false,sizeHint:"large",language:"javascript"},ScriptFunctions:{label:"Script functions",description:"User functions",type:"multi",data:[{name:"Name",label:"Event",type:"select",data:{BLUR:{text:"Blur/unfocus"},CHANGE:{text:"Change/edit"},CLICK:{text:"Click"},DBLCLICK:{text:"Double-click"},FOCUS:{text:"Focus"},MOUSEDOWN:{text:"Mouse button down"},MOUSEMOVE:{text:"Mouse move"},MOUSEOUT:{text:"Mouse move out"},MOUSEOVER:{text:"Mouse move over"},MOUSEUP:{text:"Mouse button up"},KEYPRESS:{text:"Key Press"},KEYUP:{text:"Key Up"},KEYDOWN:{text:"Key Down"}}},{name:"Body",label:"Handler",type:"text",sizeHint:"medium"}]},Size:{label:"Size",description:"The size attribute of an input",type:"text",sizeHint:"small",live:true},Style:{label:"Style",description:"The style applied to the component",type:"text",live:true,sizeHint:"wide"},TabIndex:{label:"Tab index",description:"The tab index of the component",type:"text",live:false,sizeHint:"small"},Tags:{label:"Tags",description:"Attributes without value (eg. disabled, readonly, checked...) added to the input element",type:"text",live:true},Target:{label:"Target",description:"The stingray target div that will receive the rendered template html",type:"text",sizeHint:"wide"},Top:{label:"Top",description:"The top position of the component",type:"text",live:true,sizeHint:"small"},Tooltip:{label:"Tooltip",description:"The tooltip that displays above a component",type:"text",live:true,sizeHint:"wide"},HelpLink:{label:"Help Link",description:"URL address to a HTML help document",type:"text",live:false,sizeHint:"wide"},Type:{label:"Type",description:"The type of button",type:"select",live:true},Validate:{label:"Validate",description:"If the button should validated the page",type:"checkbox",live:true},Value:{label:"Value",description:"The value of the component",type:"text",live:true,sizeHint:"small"},ValueLessAttrs:{label:"Valueless attrs",description:"The attributes ",type:"text",live:true,sizeHint:"wide"},Width:{label:"Width",description:"The width of the component",type:"text",live:true,sizeHint:"small"},EventVRM:{label:"Event VRM",description:"The VRM [with params] to be called by Ajax",type:"text"},Event:{label:"Event",description:"The event that fires the ajax post",type:"select"},AjaxEnabled:{label:"Ajax enabled",description:"Whether the ajax post feature is enabled",type:"checkbox"},Comment:{label:"Comment",description:"Component comments that show on hover. The first line (up to 50 characters) display next to the component ",type:"text",live:true,sizeHint:"wide"},CompiledScriptFunction:{label:"Function",description:"Script Function",type:"csf",data:[]},SCRIPT:{label:"Script",description:"Script code",type:"text",sizeHint:"large",language:"server script"},Language:{label:"Language",description:"The type of language the script is written in",type:"select",live:false,data:["Server Script"]},SqlTrnName:{label:"Name",description:"A unique name of SQL transaction",type:"text"},SqlTrnType:{label:"Type",description:"The type of needed SQL transaction",type:"select",live:false,data:["Begin","Commit","Rollback"]},ErrorMessage:{label:"Error message",description:"The error message that will be displayed to the user",type:"text",sizeHint:"large"},J1:{label:"J1",description:"The Component that is called by default",type:"text"},J2:{label:"J2",description:"The Component that is called on a false condition",type:"text"},MathParams:{label:"Math parameters",description:"Math Properties",type:"multi",data:[{name:"Name",label:"Name",type:"text",sizeHint:"small"},{name:"Format",label:"Format",type:"select",data:"INTEGER,LONGDATETIME,LONGDATETIMEAMPM,SHORTDATE,ROUND,FLOAT".split(",")},{name:"Value",label:"Param value",type:"text",sizeHint:"wide"}]},Query:{label:"Query",description:"A SQL query",type:"text",sizeHint:"large",language:"sql"},QueryParams:{label:"Parameters",description:"Set Query Parameters",type:"multi",data:[{name:"Name",label:"Name",type:"text",sizeHint:"small"},{name:"Type",label:"Type",type:"select",data:"BOOLEAN,CURRENCY,DATETIME,FLOAT,INTEGER,STRING,SECURE".split(",")},{name:"Value",label:"Value",type:"text",sizeHint:"wide"}]},RuleName:{label:"Rule name",description:"The vrm to be called",type:"text"},SetParams:{label:"ReqList Variables",description:"Set ReqList Variables",type:"multi",data:[{name:"Name",label:"Name",type:"text",sizeHint:"small"},{name:"Value",label:"Value",type:"text",sizeHint:"wide"}]},X:{label:"X",description:"The left coordinate of the component",type:"text",live:true},Y:{label:"Y",description:"The top coordinate of the component",type:"text",live:true}};return a});define("TemplateBase",["PropertyFields","Utilities","PageHelper","Editor"],function(a,d,f,b){var c=0;function e(k){var o="TmpBase.";var q=this;var l=null;var p=null;var g;var r;function h(x,v,u,t){var y=(!l)?"":l.attr("EditorID");var w=o+x;w+=(!p)?"":"."+p.attr("id")||p.attr("name");w=(!y)?w:w+"."+y;Log.Add(w,v,u,t)}function n(){try{h("attachValuelessAttrs","Called");if(!p){return}var v=p.attr("valuelessAttrs");if(!v){return}var s=v.match(/[a-zA-Z0-9#_]+/g);if(s==null){return}for(var t=0;t<s.length;t++){try{if(s[t].indexOf("#")>-1){p.attr(s[t],"")}else{p.attr(s[t]," ")}}catch(u){}}}catch(u){h("attachValuelessAttrs",u,Log.Type.Error)}}function m(){try{h("detachValuelessAttrs","Called");if(!p){return}var v=p.attr("valuelessAttrs");if(!v){return}var s=v.match(/[a-zA-Z0-9#_]+/g);if(s==null){return}for(var t=0;t<s.length;t++){try{p.removeAttr(s[t])}catch(u){}}}catch(u){h("detachValuelessAttrs",u,Log.Type.Error)}}function j(t,s){this.Name=t;this.Body=s}this.Log=function(x,v,u,t){var y=(!l)?"":l.attr("EditorID");var w=x;w+=(!p)?"":"."+p.attr("id")||p.attr("name");w=(!y)?w:w+"."+y;Log.Add(w,v,u,t)};this.BaseLoad=function(s,u){try{h("BaseLoad","Called");l=$(s);if(u){p=$(u);p.unbind("change.clearerror").bind("change.clearerror",function(){try{var w=f.GetEditorComponent($(this).parent());w.HighlightAsError(false)}catch(v){}})}n()}catch(t){h("BaseLoad",t,Log.Type.Error)}};this.BaseLoad2=function(s){try{h("BaseLoad2","Called");l=$(s)}catch(t){h("BaseLoad2",t,Log.Type.Error)}};this.AttachFunctions=function(){try{if(b.Enabled){return}if(!l.attr("function")){return}h("AttachFunctions","Called");var y=l.attr("function").split("|");var v=l.attr("definition").split("|");var x,z,s;for(var t=0;t<y.length;t++){x=d.Trim(y[t]);z=d.Trim(v[t]);if(!z.beginsWith("#S")&&x!=""&&z!=""){s=x.toLowerCase()+".templatebase";try{var u=new Function(z);p.unbind(s).bind(s,u)}catch(w){h("BindScriptFunction",w+" on "+x+" in "+z,Log.Type.Error,true);throw w}}}}catch(w){h("AttachFunctions",w,Log.Type.Error)}};this.DetachFunctions=function(){try{h("DetachFunctions","Called");m();if(l.attr("function")){var v=l.attr("function").split("|");for(var t=0;t<v.length;t++){var s=v[t].toLowerCase()+".templatebase";p.unbind(s)}}}catch(u){h("DetachFunctions",u,Log.Type.Error)}};this.AddFunction=function(){try{h("AddFunction","Called");if((l.attr("function")==null)||(l.attr("function").length==0)){l.attr("function","");l.attr("definition","")}else{l.attr("function",l.attr("function")+"|");l.attr("definition",l.attr("definition")+"|")}}catch(s){h("AddFunction",s,Log.Type.Error)}};this.DeleteFunction=function(s){try{h("DeleteFunction","Called");if(!l.attr("function")){return}var v;if(!l.attr("function").match(/|/)){v=l.attr("function").split("|")}else{v=[$.trim(l.attr("function"))]}var t=l.attr("definition").split("|");v.splice(s,1);t.splice(s,1);l.attr("function",v.toPipeString());l.attr("definition",t.toPipeString());if(l.attr("function").length==0){l.removeAttr("function");l.removeAttr("definition")}}catch(u){h("DeleteFunction",u,Log.Type.Error)}};this.GetBaseProperties=function(){try{h("GetBaseProperties","Called");var v=new Array();var t=f.GetParentRef(l);if(t=="StaticContainer"){v[v.length]=new PropertyEd.Property(a.Left,this.GetLeft,this.SetLeft);v[v.length]=new PropertyEd.Property(a.Top,this.GetTop,this.SetTop)}v[v.length]=new PropertyEd.Property(a.SvrCondition,this.GetSvrCondition,this.SetSvrCondition);v[v.length]=new PropertyEd.Property(a.CliCondition,this.GetCliCondition,this.SetCliCondition);if(p){if(l.attr("ref")!="EditorLabel"){v[v.length]=new PropertyEd.Property(a.TabIndex,this.GetTabIndex,this.SetTabIndex)}else{p.attr("tabindex","-1")}v[v.length]=new PropertyEd.Property(a.Tooltip,this.GetTooltip,this.SetTooltip);v[v.length]=new PropertyEd.Property(a.HelpLink,this.GetHelpLink,this.SetHelpLink);v[v.length]=new PropertyEd.Property(a.ValueLessAttrs,this.GetValueLessAttrs,this.SetValueLessAttrs)}var s=new RulesMaker.ComplexArgs(this.GetBaseProperties,this.AddFunction,this.DeleteFunction);v[v.length]=new PropertyEd.Property(a.ScriptFunctions,this.GetFunctions,this.SetFunctions,s);return v}catch(u){h("GetBaseProperties",u,Log.Type.Error)}};this.GetFunctions=function(){try{h("GetFunctions","Called");var x=l.attr("function");var u=l.attr("definition");if((x==null)||(u==null)){return new Array()}var s=new Array();if(x.indexOf("|")>-1){x=l.attr("function").split("|");u=l.attr("definition").split("|");for(var t=0;t<x.length;t++){var w=new j(x[t],u[t]);s[s.length]=w}}else{s[0]=new j(x,u)}return s}catch(v){h("GetFunctions",v,Log.Type.Error)}};this.SetFunctions=function(s){try{h("SetFunctions","Called");var y="";var u="";var x=true;if(s.length==0){x=false}if(s.length==1){var w=d.ReplaceAll(s[0].Name," ","");if(w==""){x=false}}if(!x){l.removeAttr("function");l.removeAttr("definition");return}for(var t=0;t<s.length;t++){var w=d.ReplaceAll(s[t].Name," ","");if(w.length>0){y+=s[t].Name+"|";u+=s[t].Body+"|"}}if(s.length>0){y=y.removeLastChar();u=u.removeLastChar()}l.attr("function",y);l.attr("definition",u)}catch(v){h("SetFunctions",v,Log.Type.Error)}};this.GetSvrCondition=function(){try{var t=l.attr("condition");return t||""}catch(s){h("GetSvrCondition",s,Log.Type.Error)}};this.SetSvrCondition=function(t){try{l.attr("condition",t)}catch(s){h("SetSvrCondition",s,Log.Type.Error)}};this.GetCliCondition=function(){try{var t=l.attr("cli-cond");return t||""}catch(u){h("GetCliCondition",u,Log.Type.Error)}};this.SetCliCondition=function(t){try{l.attr("cli-cond",t)}catch(s){h("SetCliCondition",s,Log.Type.Error)}};this.GetTabIndex=function(){try{if(!p){return 0}return p.attr("tabindex")}catch(s){h("GetTabIndex",s,Log.Type.Error)}};this.SetTabIndex=function(u){try{if(!p){return}var s=parseInt(u,0);if(s<0){s=0}p.attr("tabindex",s)}catch(t){h("SetTabIndex",t,Log.Type.Error)}};this.GetValueLessAttrs=function(){try{if(!p){return""}var v=p.attr("valuelessAttrs");if(!v){return""}var t=v.match(/[a-zA-Z0-9#_]+/g);if(t==null){return""}var s=t.toString();return s.replace(/,/g," ")}catch(u){h("GetValueLessAttrs",u,Log.Type.Error)}};this.SetValueLessAttrs=function(u){try{if(!p){return}p.removeAttr("valuelessAttrs");if(u==null){return}var s=u.match(/[a-zA-Z0-9#_]+/g);if(s==null){return}s=s.toString();p.attr("valuelessAttrs",s.replace(/,/g," "))}catch(t){h("SetValueLessAttrs",t,Log.Type.Error)}};this.GetTooltip=function(){try{if(!p){return""}var s=p.attr("title");if(!s){return""}return s}catch(t){h("GetTooltip",t,Log.Type.Error)}};this.SetTooltip=function(t){try{if(p){p.attr("title",t)}}catch(s){h("SetTooltip",s,Log.Type.Error)}};this.GetHelpLink=function(){try{var s=l.attr("mp-help");if(!s){return""}return s}catch(t){h("GetHelpLink",t,Log.Type.Error)}};this.SetHelpLink=function(t){try{l.attr("mp-help",t)}catch(s){h("SetHelpLink",s,Log.Type.Error)}};this.GetLeft=function(){try{return d.ToNumber(l.css("left"))}catch(s){h("GetLeft",s,Log.Type.Error)}};this.SetLeft=function(t){try{l.css("left",d.ToNumber(t)+"px")}catch(s){h("SetLeft",s,Log.Type.Error)}};this.GetTop=function(){try{return d.ToNumber(l.css("top"))}catch(s){h("GetTop",s,Log.Type.Error)}};this.SetTop=function(t){try{l.css("top",d.ToNumber(t)+"px")}catch(s){h("SetTop",s,Log.Type.Error)}};this.HighlightAsError=function(v){try{var u=f.GetComponentRef(l),s="ui-validation";var w=p;if(!w||!w.length){w=l}if(u=="EditorRadio"){w=$("div[Ref='EditorRadio']").find("input[name='"+p.attr("name")+"']")}if(Browser.IsMSIE()){s="error";w=w.parent()}if(Browser.IsSafari()&&$.inArray(u,["EditorRadio","EditorCheckBox","EditorDropDown"])>-1){w=w.parent()}w.toggleClass(s,v)}catch(t){h("HighlightAsError",t,Log.Type.Error)}};this.HighlightAsSelected=function(s){l.find(".moving").toggleClass("ui-selected",s)};this.HighlightAsFound=function(t){var s=Browser.IsMSIE()?"ui-searchIE":"ui-search";var u=p||l;u.toggleClass(s,t)};this.BaseSearch=function(x,t){try{this.HighlightAsFound(false);if(!x){return}var u=(t)?new RegExp(x,""):new RegExp(x,"i");var w=false;if(!w&&this.GetID){w=this.GetID().search(u)>-1}if(!w&&this.GetName){w=this.GetName().search(u)>-1}if(!w&&this.GetTooltip){w=this.GetTooltip().search(u)>-1}if(!w&&this.GetSvrCondition){w=this.GetSvrCondition().search(u)>-1}if(!w&&this.GetCliCondition){w=this.GetCliCondition().search(u)>-1}if(!w&&this.GetValueLessAttrs){w=this.GetValueLessAttrs().search(u)>-1}if(!w&&this.GetCaption){w=this.GetCaption().search(u)>-1}if(!w&&this.GetFunctions){var s=$.grep(this.GetFunctions(),function(y){return y.Body.search(u)>-1});w=s.length>0}if(w){h("Search",this,Log.Type.Search);return}else{return u}}catch(v){h("BaseSearch",v,Log.Type.Error)}};this.DisableHighlighting=function(){Global.DisableHighlightingInChrome(true)};this.EnableHighlighting=function(){Global.DisableHighlightingInChrome(false)};this.onDragStart=function(){Global.DisableHighlightingInChrome(true);g=q.GetLeft();r=q.GetTop()};this.onDragStop=function(){Global.DisableHighlightingInChrome(false)};this.onDragProgress=function(){var t=q.GetLeft();var B=q.GetTop();var A=f.GetComponentID(l);if(!f.IsSelected(A)){f.ClearSelected();f.AddSelected(A)}if((g==t)&&(r==B)){return}var s=t-g;var z=B-r;var v=f.GetSelected();g=t;r=B;for(var u=0;u<v.length;u++){A=v[u];var w=f.GetStoredComponent(A);if(w){t=w.GetLeft();B=w.GetTop();w.SetLeft(t+s);w.SetTop(B+z)}else{h("Dragging","Cannot locate component ID: "+A,Log.Type.Warning)}}}}return e});define("Utilities",["Formatting"],function(b){Array.prototype.reset=function(){for(var c=0;c<this.length;c++){this[c]=null}};Array.prototype.toPipeString=function(){var d="";for(var c=0;c<this.length;c++){d+=this[c]+"|"}return d.substring(0,d.length-1)};String.prototype.beginsWith=function(e){var c=e.length;var d=this.substring(0,c);return(d==e)};String.prototype.endsWith=function(e){var c=e.length;var d=this.substring(this.length-c);return(d==e)};String.prototype.removeLastChar=function(){return this.substring(0,this.length-1)};String.prototype.removeFirstChar=function(){return this.substring(1)};String.prototype.insert=function(h,g){if(typeof h=="object"){var c="";var e=0;for(var d=0;d<h.length;d++){var f=h[d];c+=this.substring(e,f)+g;e=f}c+=this.substring(e);return c}return this.substring(0,h)+g+this.substring(h)};if(typeof String.prototype.trim!=="function"){String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}}var a=new function(){this.Ok="-Dialog-Returned-OK-";this.Cancel="-Dialog-Returned-Cancel-";this.Yes="-Dialog-Returned-Yes-";this.No="-Dialog-Returned-No-";this.Empty="-Dialog-Returned-Empty-String"};Utilities=new function(k){var e="Utils.";try{function g(o,n,m,l){Log.Add(e+o,n,m,l)}function j(){try{event.cancelBubble=true;event.returnValue=false;return false}catch(l){g("nocontextmenu",l,Log.Type.Error)}}function c(m){try{if(window.Event){if(m.which!=1){return false}}else{if(event.button!=1){event.cancelBubble=true;event.returnValue=false;return false}}}catch(l){g("norightclick",l,Log.Type.Error)}}function d(){try{if((event.altKey)||((event.ctrlKey)&&((event.keyCode==78)||(event.keyCode==82))||(event.keyCode==116)||(event.keyCode==122))){event.keyCode=0;event.returnValue=false}}catch(l){g("onKeyDown",l,Log.Type.Error)}}function f(){return(((1+Math.random())*65536)|0).toString(16).substring(1)}return{MakeGUID:function(){return(f()+f()+"-"+f()+"-"+f()+"-"+f()+"-"+f()+f()+f()).toUpperCase()},GetXmlString:function(l){if(typeof l.xml!=="undefined"){return l.xml}return(new XMLSerializer()).serializeToString(l)},GetFormattedTime:function(){try{var n=new Date();var l=this.PadNumber(n.getHours())+":"+this.PadNumber(n.getMinutes())+":"+this.PadNumber(n.getSeconds())+"."+this.PadNumber(n.getMilliseconds(),3);return l}catch(m){g("GetFormattedTime",m,Log.Type.Error)}},GetTimeDifference:function(m,l){var o=m.getTime();var n=l.getTime();return n-o},FilterScript:function(l){try{var n="";for(var m=0;m<l.length;m++){var q=l.substring(m,m+1);var p=q.charCodeAt(0);if(p!=10){n+=q}}return n}catch(o){g("FilterScript",o,Log.Type.Error)}},Format:function(o,n){try{for(var l=0;l<n.length;l++){o=o.replace("{"+l+"}",n[l])}return o}catch(m){g("Format",m,Log.Type.Error)}},PadNumber:function(s,r){try{if(r==null){r=2}var p="1000000000000000";var v="0000000000000000";var u=parseInt(p.substring(0,r),10);if(s>=u){return s}var q=s.toString().length;var o=v.substring(0,r-q);return o+s.toString()}catch(t){g("PadNumber",t,Log.Type.Error)}},ParseXML:function(l){if(window.ActiveXObject&&window.GetObject){var m=new ActiveXObject("Microsoft.XMLDOM");m.loadXML(l);return m}if(window.DOMParser){return new DOMParser().parseFromString(l,"text/xml")}throw new Error("No XML parser available")},PreventRefresh:function(){try{document.oncontextmenu=j;document.onmousedown=c;if(Browser.IsFirefox()){document.addEventListener("keydown",d,false)}else{document.attachEvent("onkeydown",d)}if(window.Event){document.captureEvents(Event.MOUSEUP)}}catch(l){g("PreventRefresh",l,Log.Type.Error)}},PromptForName:function(o,l){try{l=l||"Please enter the control name";var p=prompt(l,"");if(p==null){return Utilities.ModalResult.Cancel}p=this.Trim(p);if(p==""){return Utilities.ModalResult.Empty}if(o){if($("#"+p).length>0){g("PromptForName","The name '"+p+"' is already being used!",Log.Type.Warning);return false}}return p}catch(m){g("PromptForName",m,Log.Type.Error)}},ReplaceAll:function(p,n,o){try{if(!p){return""}var m=new RegExp(n,"g");return p.replace(m,o)}catch(l){g("ReplaceAll",l,Log.Type.Error)}},Serialize:function(p){try{var o=[];var m=$(p).find(":input").get();$.each(m,function(){if(this.name&&!this.disabled&&(this.checked||/select|textarea/i.test(this.nodeName)||/text|hidden|password/i.test(this.type))){var s=$(this),u=encodeURIComponent(this.name),r=s.data("submit-type");switch(r){case"MONEY":var q=Utilities.MoneyToNumber(s.val());o.push(u+"="+encodeURIComponent(q));break;case"MASK":o.push(u+"="+encodeURIComponent(s.val()));o.push(u+"-sMask="+encodeURIComponent(s.attr("sMask")));o.push(u+"-sValue="+encodeURIComponent(s.attr("sValue")));break;default:o.push(u+"="+encodeURIComponent(s.val()))}}});$(p).find("div[ref='EditorMemo']").each(function(){if($(this).attr("EditHTML")=="true"){var q=$(this).find("div.ckEditorDiv"),s=String.fromCharCode(183);if(q.length){var t=Global.GetCKEditorValue(q);var u=encodeURIComponent(q.attr("id"));t=encodeURIComponent(t);o.push(u+s+"="+t)}else{q=$(this).find("textarea");var t=Global.GetCKEditorValue(q);var u=encodeURIComponent(q.attr("id"));t=encodeURIComponent(t);for(var r=0;r<o.length;r++){if(o[r].beginsWith(u)){o[r]=u+s+"="+t;break}}}}});var l=o.join("&").replace(/%20/g,"+");l+=TransferListHelper.Serialize(p);return l}catch(n){g("Serialize",n,Log.Type.Error)}},SortSelect:function(r){try{r=$(r)[0];for(var p=0;p<r.options.length;p++){var n=r.options[p];var m=true;for(var o=0;o<r.options.length;o++){if(o!=p&&m==true){var l=r.options[o];if($(n).text()<$(l).text()){$(n).remove().insertBefore($(l));m=false}}}}}catch(q){g("SortSelect",q,Log.Type.Error)}},SnapTo:function(m,o){var l=m/o%1;if(l==0){return m}var n=m%o;if(l>0&&l<0.5){return m-n}else{return m-n+o}},ToNumber:function(n){try{var l=parseInt(n,10);if(isNaN(l)){return 0}else{return l}}catch(m){g("ToNumber",m,Log.Type.Error)}},ToMoney:function(m){try{if(Utilities.IsString(m)){return b.formatTextAsMoney(m)}if(Utilities.IsNumber(m)){return b.formatTextAsMoney(m.toString())}return b.formatFieldAsMoney(m)}catch(l){g("ToMoney",l,Log.Type.Error)}},MoneyToNumber:function(o){try{var l=b.stripNonNumericalCharacters(o);var n=parseFloat(l);if(isNaN(n)){return 0}else{return n}}catch(m){g("MoneyToNumber",m,Log.Type.Error)}},ToString:function(n,l,m){m=m||0;if(m>20){return"null"}m++;var o="";if(!l){o="{\n"}$.each(n,function(p,q){if(Utilities.IsObject(q)){o+='"'+p+'": '+Utilities.ToString(q,false,m)+","}else{switch(typeof q){case"boolean":o+='"'+p+'":'+q+",";break;case"string":o+='"'+p+'":"'+q+'",';break;case"number":o+='"'+p+'":'+q+",";break;default:o+='"'+p+'": "'+q+'",';break}o+="\n"}});if(!l){o+="\n}"}o=o.replace(/,\s{0,}\}/g,"\n}");return o},toProperCase:function(l){return l.toLowerCase().replace(/\b((m)(a?c))?(\w)/g,function(m,q,p,o,n){if(q){return p.toUpperCase()+o+n.toUpperCase()}else{return m.toUpperCase()}})},Trim:function(l){if(l){return l.trim()}else{return""}},RemoveWhiteSpaces:function(l){if(l){return l.replace(/\s+/g," ")}else{return""}},IsObject:function(l){return(l&&"object"==typeof l)||Utilities.IsFunction(l)},IsFunction:function(l){return"function"==typeof l},IsNumber:function(l){return"number"==typeof l},IsString:function(l){return"string"==typeof l},IsDate:function(l,m){try{if(m){var o=new Date.parseExact(l,m)}else{var o=new Date.parse(l)}return !isNaN(o.getTime())}catch(n){return false}},IdentifyChildren:function(o){var l=[];var p=$(o);try{var m=p.find("[id]");m.each(function(){l.push($(this).attr("id")||$(this).attr("name"))})}catch(q){}var r=p.attr("id")||p.attr("name");return r+"["+l.join()+"]"},ConvertToJSONObject:function(l,n){if(Utilities.IsObject(l)){return l}var o=function(p){try{return $.parseJSON(p)}catch(q){return null}};var m=/^\{(.*)\}$/;if(m.test(l.trim())){return o(l.trim())}l=l.replace(/"/g,'\\"');l='{"'+n+'" : "'+l+'"}';return o(l)},ConvertToOptions:function(p){var o=function(q){if(q instanceof $){return q}return $("<option/>").attr("value",q.value||"").attr("title",q.title||"").text(q.text||"")};var m=function(q){if(typeof q==="string"){return{text:q,value:q}}else{if(q instanceof $){return q}else{if(typeof q==="object"){return q}else{throw new TypeError("Option items must be strings, arrays, or jQuery elements")}}}};var l=$([]);if(p instanceof Array||p instanceof $){$.each(p,function(r,q){l=l.add(o(m(q)))})}else{if(typeof p==="object"){var n;for(n in p){if(!Object.prototype.hasOwnProperty.call(p,n)){continue}l=l.add(o($.extend(m(p[n]),{value:n})))}}else{throw new TypeError("Option container must be an array or object")}}return l}}}catch(h){g("Main",h,Log.Type.Error)}};Utilities.ModalResult=a;return Utilities});define("Formatting",[],function(){var c=function(g,h){if(h===""){return g}else{return g+"."+h}};var e=function(g){return g.replace(/[^-\d\.]/g,"")};var b=function(h){var k=h.split(".");var g=k[0].replace(/(\d{1,3})(?=(\d{3})+$)/g,"$1,");var j=k.slice(1).join("");if(k.length>1){return g+"."+j}else{return g}};var a=function(j){var h=e(j);h=b(h);var g=parseFloat(h);if(g<0){return h.insert(1,"$")}else{return"$"+h}};var f=function(l){l=$.trim(l);if(l){var m=l.slice(0,1);var k=l.slice(1);k=k.replace(/-/g,"");l=a(m+k)}else{l=""}var j=l.split(".");var g=j[0]||"";var h=j[1]||"";if(h.length!==0&&h.length!==2){h=h+"00";h=h.substr(0,2)}return c(g,h)};var d=function(g){var j=$.trim(g.val());var h="";if(j){h=f(j);if(j==h){return h}}g.val(h);return h};return{formatFieldAsMoney:d,formatTextAsMoney:f,stripNonNumericalCharacters:e}});define("ValidatorContainer",["Utilities","PageHelper","Formatting"],function(Utilities,PageHelper,Formatting){var Validator=new function(){var logClassName="Validator.";function iLog(Place,Message,Type,Silent){Log.Add(logClassName+Place,Message,Type,Silent)}function GetErrors(html){try{iLog("GetErrors","Called");var errors=new Array();var radios=new Array();$(html).find(".component").each(function(){var inp=$(this).find("> :input"),err="";if(inp.length==1&&!inp.attr("disabled")&&!inp.attr("readonly")&&inp.is(":visible")){var ctrl=PageHelper.GetEditorComponent(this);if(ctrl){if(ctrl.GetRequired&&ctrl.GetRequired()){var ref=PageHelper.GetComponentRef(this);var span=$(this).find(">span");switch(ref){case"EditorText":if(Utilities.Trim(inp.val()).length==0){err="Field '"+span.text()+"' must be entered. Click to fix."}break;case"EditorMemo":if(Utilities.Trim(inp.val()).length==0){err="Text field '"+span.text()+"' must be entered. Click to fix."}break;case"EditorDropDown":if(inp.val()=="-1"){err="An option '"+span.text()+"' must be selected. Click to fix."}break;case"EditorRadio":var name=inp.attr("name"),radSel="input:radio[name="+name+"]";if($.inArray(name,radios)==-1&&!$(radSel+":checked").length){radios.push(name);var s="";$(radSel).parent().find("span").each(function(){s+=$(this).text()+", "});err="At least one option ("+s.slice(0,s.length-2)+") must be selected. Click to fix."}break;case"EditorCheckBox":if(!inp[0].checked){err="Check box '"+span.text()+"' must be selected. Click to fix."}break}}if(!err&&ctrl.FilterInput){err=ctrl.FilterInput(true)}}if(err){ctrl.HighlightAsError(true);err=new ValidationError(err,ctrl);errors.push(err)}}});return errors}catch(err){iLog("GetErrors",err,Log.Type.Error)}}function ErrorTable(errors){try{iLog("ErrorTable","Called");var ol=$("<ol class='ValidationErrors'/>");for(var i=0;i<errors.length;i++){var li=$("<li/>");li.text(errors[i].Message);li.data("elementObj",errors[i].Control.GetControl());li.bind("click",function(){var el=$(this).data("elementObj");Global.ScrollToElement(el,null,function(){Global.ShakeElement(el);var obj=PageHelper.GetEditorComponent(el);if(obj.SetFocus){obj.SetFocus()}})});ol.append(li)}return ol}catch(err){iLog("ErrorTable",err,Log.Type.Error)}}function ShowErrors(table,html){try{iLog("ShowErrors","Called");var c=$(html).find(".ValidationContainer");if(!c.length){c=$(".ValidationContainer")}if(!c.length){iLog("ShowErrors","ValidationContainer could not be found",Log.Type.Warning);return}var ctrl=PageHelper.GetEditorComponent(c[c.length-1]);ctrl.Show(table);Global.ScrollToElement(ctrl.GetControl())}catch(err){iLog("ShowErrors",err,Log.Type.Error)}}function HideErrors(){try{iLog("HideErrors","Called");$(".ValidationContainer").each(function(){var ctrl=PageHelper.GetEditorComponent(this);ctrl.Hide()})}catch(err){iLog("HideErrors",err,Log.Type.Error)}}return{Validate:function(html,noDisplay){try{iLog("Validate","Called");var errors=GetErrors(html);if(!errors.length){HideErrors();return true}if(!noDisplay){var table=ErrorTable(errors);ShowErrors(table,html)}var eFn=CustomScript.onValidationErrors||MP.Events.onValidationErrors||$.noop;eFn(errors);return false}catch(err){iLog("Validate",err,Log.Type.Error)}}}};function ValidationError(message,control){this.Message=message;this.Control=control}Validator.Filters=(function(){function Convert(Value,dtype){dtype=dtype?dtype.toUpperCase():"STRING";switch(dtype){case"DATE":try{return new Date(Value).getTime()}catch(err){throw"Could not convert '"+Value+"' to a date"}break;case"FLOAT":try{var val=Value.replace(/[^0-9\.-]/g,"");return parseFloat(val)}catch(err){throw"Could not convert '"+Value+"' to a floating decimal point number"}break;case"INTEGER":try{var val=Value.replace(/[^0-9\.-]/g,"");return parseInt(val,10)}catch(err){throw"Could not convert '"+Value+"' to an integer"}break;case"STRING":return Value;break}}function Display(Value,dtype){dtype=dtype?dtype.toUpperCase():"STRING";switch(dtype){case"DATE":var d=new Date(Value);return d.toString("MM/dd/yyyy");break;case"FLOAT":var v=Value.toString();return isNaN(v)?"0":v;break;case"INTEGER":var v=Value.toString();return isNaN(v)?"0":v;break;case"STRING":return Value;break}}return{DATE:{name:"Date",filter:function(Value,dtype,param){var val=Value.replace(/[^0-9]/g,"/");val=Utilities.ReplaceAll(val,"//","/");param=param||"MM/dd/yyyy";if(val.indexOf("/")==-1){switch(val.length){case 1:var d=new Date().moveToFirstDayOfMonth().addDays(parseInt(val)-1);val=d.toString(param);break;case 2:var d=new Date(),i=parseInt(val)-1,t=d.getDate()-1;if(i<=t){d=d.moveToFirstDayOfMonth().addDays(i)}else{d.set({month:parseInt(val.charAt(0))-1,day:parseInt(val.charAt(1))})}val=d.toString(param);break;case 3:val=val.insert([2],"0");val=val.insert([1,2],"/");break;case 4:val=val.insert([1,2],"/");break;case 5:val=val.insert([1,3],"/");break;case 6:val=val.insert([2,4],"/");break;case 7:val=val.insert([1,3],"/");break;case 8:val=val.insert([2,4],"/");break;default:throw"The date could not be formatted"}}var p=param!="MM/dd/yyyy"?param:null;if(Utilities.IsDate(val,p)){var d=new Date.parse(val);return d.toString(param)}else{throw"The date must be a valid date in '"+param.toUpperCase()+"' format"}}},EMAIL:{name:"Email address",filter:function(Value,dtype,param){var e=/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/;if(e.test(Value)){return Value}else{throw"The email address is invalid"}}},EMAILS:{name:"Email address list",filter:function(Value,dtype,param){var v=Value.replace(/ /g,"").replace(/,/g,";");var e=/^(([A-Za-z0-9_\-\.])+\@([A-Za-z0-9_\-\.])+\.([A-Za-z]{2,4}))((;(([A-Za-z0-9_\-\.])+\@([A-Za-z0-9_\-\.])+\.([A-Za-z]{2,4})))*)(;{0,1})$/;if(e.test(v)){return v}else{throw"The email address list is invalid"}}},EQUAL:{name:"Equal-to",filter:function(Value,dtype,param){var v=Convert(Value,dtype);var p=Convert(param,dtype);if(v==p){return Value}else{throw"The values are not equal"}}},FLOAT:{name:"Floating-point number",filter:function(Value,dtype,param){var err="Only floating decimal point numbers are accepted";var v=Value.replace(/[^0-9\.-]/g,"");if(v.length==0){throw err}var fl=Convert(v,"FLOAT");if(isNaN(fl)){throw err}var pObj=Utilities.ConvertToJSONObject(param,"digits");var res=fl.toFixed(pObj.digits||2);if(!/(0|false)/i.test(pObj.trailingZeros)){return res}else{return parseFloat(res)}}},GREATERTHAN:{name:"Greater-than",filter:function(Value,dtype,param){var v=Convert(Value,dtype);var p=Convert(param,dtype);if(v>p){return Value}else{throw Display(v,dtype)+" must be greater than "+Display(p,dtype)}}},GREATERTHANEQUALS:{name:"Greater-than-or-equal-to",filter:function(Value,dtype,param){var v=Convert(Value,dtype);var p=Convert(param,dtype);if(v>=p){return Value}else{throw Display(v,dtype)+" must be greater than or equal to "+Display(p,dtype)}}},INTEGER:{name:"Integer",filter:function(Value,dtype,param){var err="Only integer values are accepted";var v=Value.replace(/[^0-9\.-]/g,"");if(v.length==0){throw err}var fl=Convert(v,"INTEGER");if(isNaN(fl)){throw err}return fl.toString()}},LESSTHAN:{name:"Less-than",filter:function(Value,dtype,param){var v=Convert(Value,dtype);var p=Convert(param,dtype);if(v<p){return Value}else{throw Display(v,dtype)+" must be less than "+Display(p,dtype)}}},LESSTHANEQUALS:{name:"Less-than-or-equal-to",filter:function(Value,dtype,param){var v=Convert(Value,dtype);var p=Convert(param,dtype);if(v<=p){return Value}else{throw Display(v,dtype)+" must be less than or equal to "+Display(p,dtype)}}},PHONE:{name:"Phone number",filter:function(Value,dtype,param){Value=Value.replace(/x/g,"|");Value=Value.replace(/[^0-9|]/g,"");var ext="";var i=Value.lastIndexOf("|");if(i>-1){ext=Value.substring(i+1);Value=Value.substring(0,i)}switch(Value.length){case 7:Value=Value.substring(0,3)+"-"+Value.substring(3);break;case 10:Value="("+Value.substring(0,3)+") "+Value.substring(3,6)+"-"+Value.substring(6);break;case 11:Value=Value.substring(0,1)+" ("+Value.substring(1,4)+") "+Value.substring(4,7)+"-"+Value.substring(7);break;default:throw"The phone number is invalid"}if(ext.length>0){Value+=" x "+ext}return Value}},SSN:{name:"Social security number",filter:function(Value,dtype,param){var val=Value.replace(/[^0-9]/g,"");if(val.length==9){val=val.substring(0,3)+"-"+val.substring(3,5)+"-"+val.substring(5)}var _exp=/^[0-9]{3}[\- ]?[0-9]{2}[\- ]?[0-9]{4}$/;if(_exp.test(val)){return val}else{throw"The social security number is invalid"}}},FEIN:{name:"Federal employer ID",filter:function(Value,dtype,param){var val=Value.replace(/[^0-9]/g,"");if(val.length==9){val=val.substring(0,2)+"-"+val.substring(2)}var _exp=/^[0-9]{2}[\- ]?[0-9]{7}$/;if(_exp.test(val)){return val}else{throw"The federal employer identification number is invalid"}}},STATE:{name:"State postal code",filter:function(Value,dtype,param){Value=Value.toUpperCase();if(Value=="INT"){return Value}var _exp=/[A-Z]{2}/g;if(!_exp.test(Value)){throw"The state code must be two letters"}var states="AL AK AZ AR CA CO CT DC DE FL GA HI ID IL IN IA KS KY LA ME MD MA MI MN MS MO MT NE NV NH NJ NM NY NC ND OH OK OR PA RI SC SD TN TX UT VT VA WA WV WI WY PR VI GU";_exp=new RegExp(Value,"g");if(states.search(_exp)>-1){return Value}else{throw"The state code is invalid"}}},TIME:{name:"Time",filter:function(Value,dtype,param){var val=Value.toUpperCase();val=val.replace(/[^0-9AM:PM]/g,"");var end=null;if(val.indexOf("AM")>-1){end="AM"}else{if(val.indexOf("PM")>-1){end="PM"}}if(end==null){throw"Times must include AM or PM"}val=val.replace(/\s/g,"");var _exp=/\d{1,2}:\d{2}/;var ma=val.match(_exp);if(ma==null){throw"Times must be formatted HH:MM AM/PM"}if(typeof ma=="object"){ma=ma[0]}var s=ma.split(":");var h=parseInt(s[0],10);var m=parseInt(s[1],10);if(h>12){throw"The hour must be less than or equal to 12"}if(h==0){throw"The hour must be greater than 0"}if(m>59){throw"The minute must be less than 60"}if(m<10){m="0"+m.toString()}return h+":"+m+" "+end}},ZIPCODE:{name:"ZIP code",filter:function(Value,dtype,param){var val=Value.replace(/[^0-9]/g,"");switch(val.length){case 5:return val;break;case 9:return val.substring(0,5)+"-"+val.substring(5);break;default:throw"The ZIP code must be 5 or 9 digits for zip + 4 codes"}}},PASSWORD:{name:"Password",filter:function(Value,dtype,param){return Value}},MONEY:{name:"Monetary value (money)",filter:{attach:function($element,dtype,param){var v1=Formatting.formatFieldAsMoney($element);var v2=Formatting.stripNonNumericalCharacters(v1);$element.data("submit-value",v2);$element.data("submit-type","MONEY");$element.bind("focus.money-filter",function(){var v1=$element.val();var v2=Formatting.stripNonNumericalCharacters(v1);if(v1!=v2){$element.val(v2)}$element.data("submit-value",v2)});$element.bind("blur.money-filter",function(){var v1=Formatting.formatFieldAsMoney($element);var v2=Formatting.stripNonNumericalCharacters(v1);$element.data("submit-value",v2)})},detach:function($element,dtype,param){$element.unbind(".money-filter")}}},CUSTOMEXPRESSION:{name:"Custom expression",filter:function(Value,dtype,param){var ptr=param,mdf="",msg="",obj=Utilities.ConvertToJSONObject(param,"pattern");if(obj){ptr=obj.pattern;mdf=obj.modifiers;msg=obj.message}if(!ptr){return Value}var exp=new RegExp(ptr,mdf);if(exp.test(Value)){return Value}else{throw msg||"The information is formatted incorrectly"}}},CUSTOMFUNCTION:{name:"Custom function",filter:function(Value,dtype,param){if(param.indexOf("()")==-1){throw'Call "'+param+'" with no parameters!'}var val=Value.replace(/"/g,'\\"');var fn=param.replace("()",'("'+val+'", "'+dtype+'")');return eval(fn)}}}}());return Validator});define("AjaxTab",[],function(){var a=new function(d){try{var p="AjaxTab.",s=null,f,b,r,k=null,q=null,v=0,t="",l="",g,n=this;function e(A,z,y,x){Log.Add(p+A,z,y,x)}function w(){try{v=0;k.find("div").remove();q.find("div").remove()}catch(x){e("Clear",x,Log.Type.Error)}}function m(z){try{e("SetBackground","Called");var y=$(z).attr("iID");k.find("div[iID='"+y+"']").css("background-color","#ddd");q.find("div[iID='"+y+"']").css("background-color","#ddd")}catch(x){e("SetBackground",x,Log.Type.Error)}}function h(){try{e("ResetBackgrounds","Called");k.find("div").css("background-color","#fff");q.find("div").css("background-color","#fff")}catch(x){e("ResetBackgrounds",x,Log.Type.Error)}}function j(){if(v>10&&(v%5)==0){k.find("div:lt(5)").remove();q.find("div:lt(5)").remove()}}function o(){g=MP.Tools.Config.Editor.tabs.ajax;if(!g.size){g.size={width:600,height:400}}}function u(){if(a.Enabled){s.dialog("option","title","Ajax viewer")}else{s.dialog("option","title","Ajax viewer - Disabled")}var y=$(".ui-dialog-buttonpane",s.parent());var x=function(z){return $("button:contains("+z+")",y)};if(a.Enabled){x("Enable").html("Disable")}else{x("Disable").html("Enable")}if(g.pinned){x("Pin").html("Unpin")}else{x("Unpin").html("Pin")}if(b==f){x("Tab View").html("View Here")}else{x("View Here").html("Tab View")}}return{Enabled:false,Initialized:false,AddCommand:function(y){try{t=y;if(!this.Enabled||!r.is(":visible")){return}j();v++;var z="<span class='time'>["+v+"] "+Utilities.GetFormattedTime()+"</span> <br/>";var A=$("<div/>");A.attr("iID",v);A.text(y);A.prepend(z);A.addClass("item");A.click(function(){h();m(this)});k.append(A)}catch(x){e("AddCommand",x,Log.Type.Error,true)}},AddResponse:function(z,B){try{l=z;if(!this.Enabled||!r.is(":visible")){return}var y=$(z).find("stingray>errorcode").text();if(y=="0101"){z="An empty response due empty callback"}else{z=Utilities.GetXmlString(z);if(B){z=B+"\n"+z}}var A="<span class='time'>["+v+"] "+Utilities.GetFormattedTime()+"</span> <br/>";var C=$("<div/>");C.attr("iID",v);C.text(z);C.prepend(A);C.addClass("item");C.click(function(){h();m(this)});q.append(C)}catch(x){e("AddResponse",x,Log.Type.Error,true)}},ClearTab:function(){if(!this.Initialized){return}e("ClearTab","Called");w()},Show:function(x){if(!this.Initialized){return}s.dialog("open");if(x&&!this.Enabled){this.Switch()}},Hide:function(){if(this.Initialized){s.dialog("close")}},Switch:function(){this.Enabled=!this.Enabled;u();if(v==0){this.AddCommand(t);this.AddResponse(l)}},Pin:function(x){if(x==d){g.pinned=!g.pinned}else{g.pinned=x}u();if(g.pinned){$(window).bind("scroll.pinAjaxDiv",function(){var y=s.parent();if(y.is(":visible")){y.css("top",(s.data("lastTop")+$(document).scrollTop())+"px")}})}else{$(window).unbind("scroll.pinAjaxDiv")}},MoveTo:function(x){if(!x){x=(b==s)?"tab":"float"}else{x=x.toLowerCase()}g.viewStyle=x;var z=r.detach();var y='This view is inactive. You can either <a class="activateViewLink">activate this view</a> or <a class="goToViewLink">go to the other view</a>.';if(x=="tab"){b=f;this.Hide();s.html(y);s.find(".activateViewLink").bind("click",function(){a.MoveTo("float")});s.find(".goToViewLink").bind("click",function(){a.Hide();Global.ScrollToElement($("#AjaxLink"))});f.html("");z.appendTo(f);if(this.Initialized){Global.ScrollToElement($("#AjaxLink"))}}else{b=s;f.html(y);f.find(".activateViewLink").bind("click",function(){a.MoveTo("tab")});f.find(".goToViewLink").bind("click",function(){a.Show();Global.ScrollToElement(s.parent())});s.html("");z.appendTo(s)}u()},Initialize:function(){try{if(!MP.Tools.Config.ajaxEnabled||this.Initialized){return}e("Initialize","Called");o();f=$("#AjaxTab");s=$("#AjaxDiv");if(!s.length){s=$('<div id="AjaxDiv" style="text-align: left;"><div class="toolWrapper"><div id="Commands"></div><div id="Responses"></div></div></div>')}k=s.find("#Commands");q=s.find("#Responses");r=s.find(".toolWrapper");b=s;var y={Clear:function(){a.ClearTab()},Enable:function(){a.Switch()},Pin:function(){a.Pin()},"Tab View":function(){a.MoveTo()}};s.dialog({width:g.size.width,height:g.size.height,position:[g.position.left,g.position.top],minWidth:300,minHeight:200,autoOpen:false,closeOnEscape:false,modal:false,buttons:y,dialogClass:"aboveSpinner",resizeStart:function(){Global.DisableHighlightingInChrome(true)},resizeStop:function(){Global.DisableHighlightingInChrome(false)},dragStart:function(){Global.DisableHighlightingInChrome(true)},dragStop:function(z,A){Global.DisableHighlightingInChrome(false);Global.UpdateLastPosition(s,A)},open:function(z){u();if(s.data("lastLeft")&&s.data("lastTop")){s.dialog("option",{position:[s.data("lastLeft"),s.data("lastTop")]})}else{Global.UpdateLastPosition(s)}}});this.MoveTo(g.viewStyle);this.Pin(g.pinned||false);this.Initialized=true}catch(x){e("Initialize",x,Log.Type.Error)}}}}catch(c){e("Main",c,Log.Type.Error)}};return a});define("ReqList",["Utilities"],function(b){var a=new function(e){try{var r="ReqList.",l=null,y,c,s,p=null,w=0,v="",n="",o,j;function f(C,B,A,z){Log.Add(r+C,B,A,z)}function k(z,A){this.Name=z;this.Value=A}function h(A){w++;var z=$("<tr/>");z.append("<td class='index'>"+w+"</td>");z.append("<td class='name'>"+A.Name+"</td>");if(A.Name=="VRM-PG"){z.append("<td class='wpValue'>"+A.Value+"</td>")}else{z.append("<td class='value'><code class='ReqList'/></td>");z.find("code").text(A.Value)}return z}function x(){w=0;if(p){p.empty().remove()}p=$('<table class="ReqList"><tr><th>ID</th><th>Name</th><th>Value</th></tr></table>');s.append(p)}function t(A){if(!j.filterVars){return true}var z=j.filter.split(" ");for(var B=0;B<z.length;B++){var C=new RegExp(z[B],"i");if(A.search(C)>-1){return true}}return false}function g(A,I,F){try{if(!A){return}if($.inArray(I,a.ExcludeVRMs)>-1){return}f("Display","Called");if(o){v=F;n=I}if(!a.Enabled||!s.is(":visible")){return}if(o){if(!j.showAll){x()}a.Add("VRM-PG",I)}else{a.Add("VRM-PG",I);if(!j.showAll){return}}var J=$(A).text();var G=J.split(/\|{2}/g);for(var E=0;E<G.length;E++){var C=G[E],H=C.indexOf("="),z=C.substring(0,H),B=C.substring(H+1);if(t(z)){a.Add(z,B)}}m();if(!j.filterVars){a.FilterBy()}}catch(D){f("Display",D,Log.Type.Error)}}function m(){var A=p.find("tr").length;if(A>1000){var z=A-1000;p.find("tr:gt(0):lt("+z.toString()+")").empty().remove()}}function q(){j=MP.Tools.Config.Editor.tabs.reqList}function u(){var B=$(".ui-dialog-buttonpane",l.parent());var z=function(C){return $("button:contains("+C+")",B)};if(a.Enabled){z("Enable").html("Disable")}else{z("Disable").html("Enable")}if(j.pinned){z("Pin").html("Unpin")}else{z("Unpin").html("Pin")}if(c==y){z("Tab View").html("View Here")}else{z("View Here").html("Tab View")}if(j.showAll){z("All VRMs").html("1st VRM").attr("title","Click here to display ReqList of the initial response only.")}else{z("1st VRM").html("All VRMs").attr("title","Click here to display ReqList of all responses.")}if(j.filterVars){z("Filter ON").html("Filter OFF").attr("title","Click here to hide filtered variables allowing their recovery within less ReqLists.")}else{z("Filter OFF").html("Filter ON").attr("title","Click here to permanently remove filtered variables allowing more ReqLists to be shown.")}var A="";if(a.Enabled){A=A+(j.filterVars?" - Filter ON":"");A=A+(j.showAll?"":" - 1st VRM Only")}else{A=" - Disabled"}l.dialog("option","title","ReqList viewer"+A)}return{Enabled:false,Initialized:false,ExcludeVRMs:["ICONTRAY"],GetList:function(){if(v){return b.GetXmlString(v)}else{return"No ReqList"}},Load:function(z){try{if(!this.Initialized||!z){return}f("Load","Called");var A=$(z).find("stingray");var C=A.find("errorcode").text();if(C=="0101"){return}var E=A.find("vrmname").text();var D=A.find("reqlist");o=Communication.InitialRequest;g(D,E,z)}catch(B){f("Load",B,Log.Type.Error,true)}},Add:function(A,C){try{if(!this.Initialized){return null}var D=new k(A,C);var z=h(D);p.append(z);return z}catch(B){f("Add",B,Log.Type.Error)}},ClearTab:function(){if(!this.Initialized){return}f("ClearTab","Called");x()},Show:function(z){if(!this.Initialized){return}l.dialog("open");if(z&&!this.Enabled){this.Switch()}},Hide:function(){if(!this.Initialized){return}l.dialog("close")},Switch:function(){this.Enabled=!this.Enabled;u();if(w==0){this.Load(v)}},Pin:function(z){if(z==e){j.pinned=!j.pinned}else{j.pinned=z}u();if(j.pinned){$(window).bind("scroll.pinReqListDiv",function(){var A=l.parent();if(A.is(":visible")){A.css("top",(l.data("lastTop")+$(document).scrollTop())+"px")}})}else{$(window).unbind("scroll.pinReqListDiv")}},MoveTo:function(z){if(!z){z=(c==l)?"tab":"float"}else{z=z.toLowerCase()}j.viewStyle=z;var B=s.detach();var A='This view is inactive. You can either <a class="activateViewLink">activate this view</a> or <a class="goToViewLink">go to the other view</a>.';if(z=="tab"){c=y;this.Hide();l.html(A);l.find(".activateViewLink").bind("click",function(){a.MoveTo("float")});l.find(".goToViewLink").bind("click",function(){a.Hide();Global.ScrollToElement($("#ReqListLink"))});y.html("");B.appendTo(y);if(this.Initialized){Global.ScrollToElement($("#ReqListLink"))}}else{c=l;y.html(A);y.find(".activateViewLink").bind("click",function(){a.MoveTo("tab")});y.find(".goToViewLink").bind("click",function(){a.Show();Global.ScrollToElement(l.parent())});l.html("");B.appendTo(l)}u()},ShowWhat:function(z){if(z==e){j.showAll=!j.showAll}else{j.showAll=z}u()},FilterVars:function(z){if(z==e){j.filterVars=!j.filterVars}else{j.filterVars=z}u()},Initialize:function(){try{if(!MP.Tools.Config.reqlistEnabled||this.Initialized){return}f("Initialize","Called");q();y=$("#ReqListTab");l=$("#ReqListDiv");if(!l.length){l=$('<div id="ReqListDiv"><div class="toolWrapper"></div></div>')}s=l.find(".toolWrapper");c=l;var A={Clear:function(){a.ClearTab()},Enable:function(){a.Switch()},Pin:function(){a.Pin()},"Tab View":function(){a.MoveTo()},"All VRMs":function(){a.ShowWhat()},"Filter OFF":function(){a.FilterVars()}};l.dialog({width:j.size.width,height:j.size.height,position:[j.position.left,j.position.top],minWidth:380,minHeight:200,autoOpen:false,closeOnEscape:false,modal:false,buttons:A,dialogClass:"aboveSpinner",resizeStart:function(){Global.DisableHighlightingInChrome(true)},resizeStop:function(){Global.DisableHighlightingInChrome(false)},dragStart:function(){Global.DisableHighlightingInChrome(true)},dragStop:function(B,C){Global.DisableHighlightingInChrome(false);Global.UpdateLastPosition(l,C)},open:function(B){u();if(l.data("lastLeft")&&l.data("lastTop")){l.dialog("option",{position:[l.data("lastLeft"),l.data("lastTop")]})}else{Global.UpdateLastPosition(l)}}});l.find("#edReqListFilter").val(j.filter).bind("keyup",function(B){a.UpdateFilter(B.target.value);a.FilterBy()});x();this.MoveTo(j.viewStyle);this.Pin(j.pinned||false);this.Initialized=true}catch(z){f("Initialize",z,MP.Types.Log.Error)}},UpdateFilter:function(A){var z=$.trim(A);z=b.RemoveWhiteSpaces(z);j.filter=z},FilterBy:function(){try{f("FilterBy","Called: "+j.filter);var G=p.find("tr td.name").parent();if(!j.filter){G.show()}else{var D=j.filter.split(" ");for(var z=0;z<G.length;z++){var E=$(G[z]);var A=E.find("td.name").text();var H=A=="VRM-PG";if(!H){for(var C=0;C<D.length;C++){var F=new RegExp(D[C],"i");if(A.search(F)>-1){H=true;break}}}if(H){E.show()}else{E.hide()}}}}catch(B){f("FilterBy",B,Log.Type.Error,true)}}}}catch(d){f("Main",d,Log.Type.Error)}};return a});define("WatchList",["Utilities"],function(b){var a=new function(e){try{var p="WatchList.",l=null,w,c,q,n=null,u=0,t="",m="",j;function f(A,z,y,x){Log.Add(p+A,z,y,x)}function k(x,y,z){this.NewBP=z;this.Name=x;this.Value=y}function h(y){var x=$("<tr/>");if(y.NewBP){u=0;x.append("<td class='wpIndex'></td>");x.append("<td class='wpName'></td>");x.append("<td class='wpValue'>"+y.Value+"</td>")}else{u++;x.append("<td class='index'>"+u+"</td>");x.append("<td class='name'>"+y.Name+"</td>");x.append("<td class='value'><code class='ReqList'/></td>");x.find("code").text(y.Value)}return x}function v(){u=0;if(n){n.empty().remove()}n=$('<table class="ReqList"><tr><th>ID</th><th>Name</th><th>Value</th></tr></table>');q.append(n)}function s(x,z,B){try{var A=new k(x,z,B);n.append(h(A))}catch(y){f("Add",y,Log.Type.Error)}}function g(E,G,B){try{if(!E){return false}f("Display","Called");var H=$(E).text();if(!H){return false}var C=jsonParse(H);if(C.length==0){return false}t=B;m=G;if(!a.Enabled||!q.is(":visible")){return false}v();for(var A=0;A<C.length;A++){var x=C[A];s("",x.n,true);for(var F=0;F<x.v.length;F++){var D=x.v[F];s(D.n,D.v,false)}}return true}catch(z){f("Display",z,Log.Type.Error)}}function o(){j=MP.Tools.Config.Editor.tabs.watchList;if(!j.size){j.size={width:600,height:400}}}function r(){if(a.Enabled){l.dialog("option","title","WatchList viewer")}else{l.dialog("option","title","WatchList viewer - Disabled")}var y=$(".ui-dialog-buttonpane",l.parent());var x=function(z){return $("button:contains("+z+")",y)};if(a.Enabled){x("Enable").html("Disable")}else{x("Disable").html("Enable")}if(j.pinned){x("Pin").html("Unpin")}else{x("Unpin").html("Pin")}if(c==w){x("Tab View").html("View Here")}else{x("View Here").html("Tab View")}}return{Enabled:false,Initialized:false,GetList:function(){if(t){return b.GetXmlString(t)}else{return"No WatchList"}},Load:function(x){try{if(!this.Initialized||!x){return}f("Load","Called");var y=$(x).find("stingray");var B=y.find("vrmname").text();var A=y.find("watchlist");if(g(A,B,x)){this.AutoFilter()}}catch(z){f("Load",z,Log.Type.Error,true)}},ClearTab:function(){if(!this.Initialized){return}f("ClearTab","Called");v()},Show:function(x){if(!this.Initialized){return}l.dialog("open");if(x&&!this.Enabled){this.Switch()}},Hide:function(){if(this.Initialized){l.dialog("close")}},Switch:function(){this.Enabled=!this.Enabled;r();if(u==0){this.Load(t)}},Pin:function(x){if(x==e){j.pinned=!j.pinned}else{j.pinned=x}r();if(j.pinned){$(window).bind("scroll.pinWatchListDiv",function(){var y=l.parent();if(y.is(":visible")){y.css("top",(l.data("lastTop")+$(document).scrollTop())+"px")}})}else{$(window).unbind("scroll.pinWatchListDiv")}},MoveTo:function(x){if(!x){x=(c==l)?"tab":"float"}else{x=x.toLowerCase()}j.viewStyle=x;var z=q.detach();var y='This view is inactive. You can either <a class="activateViewLink">activate this view</a> or <a class="goToViewLink">go to the other view</a>.';if(x=="tab"){c=w;this.Hide();l.html(y);l.find(".activateViewLink").bind("click",function(){a.MoveTo("float")});l.find(".goToViewLink").bind("click",function(){a.Hide();Global.ScrollToElement($("#WatchListLink"))});w.html("");z.appendTo(w);if(this.Initialized){Global.ScrollToElement($("#WatchListLink"))}}else{c=l;w.html(y);w.find(".activateViewLink").bind("click",function(){a.MoveTo("tab")});w.find(".goToViewLink").bind("click",function(){a.Show();Global.ScrollToElement(l.parent())});l.html("");z.appendTo(l)}r()},Initialize:function(){try{if(!MP.Tools.Config.watchlistEnabled||this.Initialized){return}f("Initialize","Called");o();w=$("#WatchListTab");l=$("#WatchListDiv");if(!l.length){l=$('<div id="WatchListDiv"><div class="toolWrapper"></div></div>')}q=l.find(".toolWrapper");c=l;var y={Clear:function(){a.ClearTab()},Enable:function(){a.Switch()},Pin:function(){a.Pin()},"Tab View":function(){a.MoveTo()}};l.dialog({width:j.size.width,height:j.size.height,position:[j.position.left,j.position.top],minWidth:300,minHeight:200,autoOpen:false,closeOnEscape:false,modal:false,buttons:y,dialogClass:"aboveSpinner",resizeStart:function(){Global.DisableHighlightingInChrome(true)},resizeStop:function(){Global.DisableHighlightingInChrome(false)},dragStart:function(){Global.DisableHighlightingInChrome(true)},dragStop:function(z,A){Global.DisableHighlightingInChrome(false);Global.UpdateLastPosition(l,A)},open:function(z){r();if(l.data("lastLeft")&&l.data("lastTop")){l.dialog("option",{position:[l.data("lastLeft"),l.data("lastTop")]})}else{Global.UpdateLastPosition(l)}}});l.find("#edWatchListFilter").val(j.filter).bind("keyup",function(A){var z=A.target.value;j.filter=z;a.FilterBy(z)});v();this.MoveTo(j.viewStyle);this.Pin(j.pinned||false);this.Initialized=true}catch(x){f("Initialize",x,Log.Type.Error)}},AutoFilter:function(){var x=$("#edWatchListFilter").val();if(x){this.FilterBy(x)}},FilterBy:function(E){try{E=$.trim(E);E=b.RemoveWhiteSpaces(E);f("FilterBy","Called: "+E);var D=n.find("tr td.name").parent();if(!E){D.show()}else{var x=E.split(" ");for(var A=0;A<D.length;A++){var C=$(D[A]);var y=C.find("td.name").text();var B=false;$.each(x,function(F,H){var G=new RegExp(H,"i");if(y.search(G)>-1){B=true;return}});if(B){C.show()}else{C.hide()}}}}catch(z){f("FilterBy",z,Log.Type.Error,true)}}}}catch(d){f("Main",d,Log.Type.Error)}};return a});define("Communication",["ValidatorContainer","Utilities","PageHelper","Editor","ReqList"],function(Validator,Utilities,PageHelper,Editor,ReqList){var Communication=new function(){try{var logClassName="Comm.",working=false,vrmEdit=null,_vrmSave=null,boolNotifiedTimeout=false,self=this,lastDebug="",sessValName="sccstmp",sessValID=0;function iLog(Place,Message,Type,Silent){Log.Add(logClassName+Place,Message,Type,Silent)}function Request(){this.template="";this.cache=false;this.method="POST";this.data=null;this.id="";this.host="../../";this.onSuccess=null;this.onError=null;this.timeout=180000;this.dataType="xml";this.url=null;this.requestType=""}function GetValueFromURL(url,name){return decodeURIComponent((new RegExp("[?|&]"+name+"=([^&;]+?)(&|#|;|$)","i").exec(url)||[,""])[1].replace(/\+/g,"%20"))||null}function EnsureFooterSeparator(div){if(!div.find("#FooterSeparator").length){div.append("<div id='FooterSeparator'></div>")}}function UpdateSessionFromURL(url){if(!url){return}var s;s=GetValueFromURL(url,"id");if(s){Communication.SessionID=s}s=GetValueFromURL(url,sessValName);if(s){sessValID=s}}function UpdateSessionFromXML(xml){if(!xml){return}var sr=$(xml).find("stingray"),s=sr.find("id").text();if(s){Communication.SessionID=s}s=sr.find(sessValName).text();if(s){sessValID=s}var vrm=sr.find("vrmname").text().toLowerCase();var dbg=sr.find("debug").text();if(dbg&&dbg!=lastDebug){lastDebug=dbg;var fn=jsonParse(dbg);MP.Tools.ConfigUpdate(fn)}if(!vrm||$.inArray(vrm,["na","ajax","titletop","icontray","mainfooter","topmenu","admintabs"])>-1){return}Communication.LastVrmName=vrm;MP.Tools.ShowVrmName(vrm)}function ReplaceSection(content,section){try{iLog("ReplaceSection","Called");var cdata=vrmEdit.createCDATASection(content);var newNode=vrmEdit.createElement(section);$(newNode).append(cdata);var replace=$(vrmEdit).find("vrm").find(section)[0];$(vrmEdit).find("vrm")[0].replaceChild(newNode,replace)}catch(err){iLog("ReplaceSection",err,Log.Type.Error)}}function IsValidVRM(xml){try{iLog("IsValidVRM","Called");var fn=$(xml).find("vrm>function>fn").text();if(fn){return true}else{return false}}catch(err){iLog("IsValidVRM",err,Log.Type.Error)}}function ExecuteCallback(xml){try{iLog("ExecuteCallback","Called");var cb=$(xml).find("stingray>callback").text();if(cb==1){var div=document.createElement("div");$(div).attr("VRMName","callback");Communication.SerialRequest(div,"CALLBACK");iLog("ExecuteCallback","Executed",Log.Type.Info)}}catch(err){iLog("ExecuteCallback",err,Log.Type.Error)}}function RemoveOldCKEditors(){try{for(var id in CKEDITOR.instances){var ed=CKEDITOR.instances[id];if(!$("#"+ed.name).length){ed.destroy()}}}catch(err){iLog("RemoveOldCKEditors",err,Log.Type.Error)}}return{SessionExpiration:3600,ShowNotification:120,EnableSessionTimer:true,LastPageTransition:null,LastVrmName:"",SessionID:"",InitialRequest:false,StartSessionTimer:function(SessExpireInSecs,SessWarningInSecs){iLog("StartSessionTimer","Called");if(SessExpireInSecs){Communication.SessionExpiration=SessExpireInSecs}if(SessWarningInSecs){Communication.ShowNotification=SessWarningInSecs}setTimeout("Communication.CheckTimeout()",1000)},ResetTimeout:function(){iLog("ResetTimeout","Called");boolNotifiedTimeout=false;Communication.LastPageTransition=new Date()},LogOff:function(){iLog("LogOff","Called");boolNotifiedTimeout=false;Communication.LinkRequest("logoff.max")},ShowTimeRemaining:function(){if(!boolNotifiedTimeout){return}iLog("ShowTimeRemaining","Called");var s=Communication.LastPageTransition.getTime();var n=new Date().getTime();var t=(n-s)/1000;var msg="";var tr=Communication.SessionExpiration-Math.round(t);if(tr<60){$("#ExpirationNoticeTimer").text(tr+" seconds")}else{var m=Math.floor(tr/60);s=tr%60;if(m>1){msg=m+" minutes and "+s+" seconds"}else{msg=m+" minute and "+s+" seconds"}$("#ExpirationNoticeTimer").text(msg)}setTimeout("Communication.ShowTimeRemaining()",1000);return msg},TimeoutDialogClosed:function(){if(!boolNotifiedTimeout){return}iLog("TimeoutDialogClosed","Called");Communication.ResetTimeout()},CheckTimeout:function(){if(!Communication.LastPageTransition||!Communication.EnableSessionTimer){return}var s=Communication.LastPageTransition.getTime();var n=new Date().getTime();var t=(n-s)/1000;var tr=Communication.SessionExpiration-Math.round(t);setTimeout("Communication.CheckTimeout()",1000);if((t>(Communication.SessionExpiration-Communication.ShowNotification))&&(!boolNotifiedTimeout)){var div=$("<div/>");div.append("<h3>Your session is about to expire</h3><p>Due to system inactivity your session is about to expire.</p> <p>You will be automatically logged off in <span id='ExpirationNoticeTimer'></span>.</p><p>&nbsp;</p>");div.append("<p><input type='button' onclick='Communication.ResetTimeout(); Global.HideMessage();' value='Continue Using System'> &nbsp; <input type='button' onclick='Communication.LogOff(); Global.HideMessage();' value='Log Off'></p>");$("#ModalWindow").bind("dialogclose",function(){Communication.TimeoutDialogClosed();$("#ModalWindow").unbind("dialogclose")});Global.ShowMessage(div);setTimeout("Communication.ShowTimeRemaining()",1000);boolNotifiedTimeout=true}if(tr<=0){Communication.LogOff();Global.HideMessage();Communication.ResetTimeout()}},EditorCreateNew:function(){try{if(Global.InProgress()){return}iLog("EditorCreateNew","Called");jPrompt("Please enter a new name","","New VRM page",function(VRMName){if(!VRMName){return}Global.ShowProgress();var request=new Request();request.requestType="Editor Create New Request";request.template="createtemplate.max";request.id=Communication.SessionID;request.data="templatename="+VRMName;request.onSuccess=function(xml){iLog("EditorCreateNew","Success",Log.Type.Info);Global.HideProgress();if($(xml).find("stingray>html")[0]==null){if(IsValidVRM(xml)){vrmEdit=xml;var vrm=$(vrmEdit).find("vrm");var html=vrm.find("html").text();var div=$("#middle");div.html(html);EnsureFooterSeparator(div);var name=vrm.find("function>fn").text();Editor.EnableEditor(name);RulesMaker.Load(vrmEdit);iLog("EditorCreateNew","New "+VRMName+".vrm & "+VRMName+".sql files created.",Log.Type.Debug)}ExecuteCallback(xml)}else{var html=$(xml).find("stingray>html").text();Global.ShowMessage(html)}};request.onError=function(msg,xml){iLog("EditorCreateNew","Failed! "+msg,Log.Type.Error,true);Global.HideProgress();Global.ShowErrorMessage("<h3>Creating New VRM Page Failed</h3><p>Please diagnose the problem using the information found in the 'Ajax' and 'Logging' tabs.</p>")};Communication.ProcessRequest(request)})}catch(err){Global.HideProgress();iLog("EditorCreateNew",err,Log.Type.Error)}},EditorRequest:function(VRMName){try{if(Global.InProgress()){return}iLog("EditorRequest","Called");Global.ShowProgress();VRMName=VRMName||Communication.LastVrmName;var request=new Request();request.requestType="Editor Request";var html=$("div[VRMName='"+VRMName+"']");request.template="edittemplate.max";request.id=Communication.SessionID;request.data="templatename="+VRMName;request.onSuccess=function(xml){iLog("EditorRequest","Success",Log.Type.Info);Global.HideProgress();Communication.LastVrmName=VRMName;if(IsValidVRM(xml)){vrmEdit=xml;var vrm=$(vrmEdit).find("vrm");var html=vrm.find("html").text();var div=$("#middle");div.html(html);EnsureFooterSeparator(div);var name=vrm.find("function>fn").text();var lockedBy=vrm.find("function>lockedBy").text();Editor.EnableEditor(name,lockedBy);RulesMaker.Load(vrmEdit)}else{var html=$(xml).find("stingray>html").text();Global.ShowMessage(html)}ExecuteCallback(xml)};request.onError=function(msg,xml){iLog("EditorRequest","Failed! "+msg,Log.Type.Error,true);Global.HideProgress();Global.ShowErrorMessage("<h3>Requesting VRM Page Failed</h3><p>Please diagnose the problem using the information found in the 'Ajax' and 'Logging' tabs.</p>")};Communication.ProcessRequest(request)}catch(err){Global.HideProgress();iLog("EditorRequest",err,Log.Type.Error)}},CloseEditor:function(){try{iLog("CloseEditor","Called");Global.ShowProgress();var request=new Request();request.requestType="Editor Close Request";request.template="closetemplate.max";request.id=Communication.SessionID;request.data="templatename="+Editor.VRMName;_vrmSave=vrmEdit;request.onSuccess=function(xml){Global.HideProgress();var status=$(xml).find("stingray>status").text();var _html=$(xml).find("stingray>html").text();if(status=="success"){iLog("CloseEditor",_html,Log.Type.Info);Communication.MakeAllCompsDefault($("#middle"),true,false)}else{iLog("CloseEditor","Failed!",Log.Type.Error,true);var message=_html;vrmEdit=_vrmSave;_html=$(vrmEdit).find("vrm>html").text();$("#middle").html(_html);Editor.EnableEditor();RulesMaker.Load(vrmEdit);var errComp=$(xml).find("stingray>errorcomponent").text();var errProc=$(xml).find("stingray>errorprocess").text();RulesMaker.HandleServerError(errProc,errComp,message)}};request.onError=function(msg,xml){iLog("CloseEditor","Failed! "+msg,Log.Type.Error,true);Global.HideProgress();vrmEdit=_vrmSave;var _html=$(vrmEdit).find("vrm>html").text();$("#middle").html(_html);Editor.EnableEditor();RulesMaker.Load(vrmEdit);Global.ShowErrorMessage("<h3>Closing VRM Page Failed</h3><p>Please diagnose the problem using the information found in the 'Ajax' and 'Logging' tabs.</p>")};Communication.ProcessRequest(request)}catch(err){Global.HideProgress();iLog("CloseEditor",err,Log.Type.Error)}},EditorUpdate:function(quickUpdate){try{iLog("EditorUpdate","Called");Global.ShowProgress();quickUpdate=quickUpdate||false;var VRMName=$("#middle").attr("VRMName");var html=$("div[VRMName='"+VRMName+"']");var template=$("#middle").formHTML();ReplaceSection(template,"html");var urlparts=window.location.href.split("/");var host_url=urlparts[0]+"/"+urlparts[1]+"/"+urlparts[2];var host_fix=new RegExp(host_url,"g");var toPost=PageHelper.CleanVRM(Utilities.GetXmlString(vrmEdit));toPost=toPost.replace(host_fix,"../..");var doQuick=(quickUpdate)?"1":"0";var request=new Request();request.requestType="Editor Update Request";request.template="savetemplate.max";request.id=Communication.SessionID;request.data="templatename="+VRMName+"&QuickSave="+doQuick+"&vrm="+toPost;_vrmSave=vrmEdit;request.onSuccess=function(xml){Global.HideProgress();var status=$(xml).find("stingray>status").text();var _html=$(xml).find("stingray>html").text();if(status=="success"){iLog("EditorUpdate",_html,Log.Type.Info);if(quickUpdate){Editor.EnableEditor();RulesMaker.Load(vrmEdit)}else{Communication.MakeAllCompsDefault($("#middle"),true,false)}}else{iLog("EditorUpdate","Failed!",Log.Type.Error,true);var message=_html;vrmEdit=_vrmSave;_html=$(vrmEdit).find("vrm>html").text();$("#middle").html(_html);Editor.EnableEditor();RulesMaker.Load(vrmEdit);var errComp=$(xml).find("stingray>errorcomponent").text();var errProc=$(xml).find("stingray>errorprocess").text();RulesMaker.HandleServerError(errProc,errComp,message)}};request.onError=function(msg,xml){iLog("EditorUpdate","Failed! "+msg,Log.Type.Error,true);Global.HideProgress();vrmEdit=_vrmSave;var _html=$(vrmEdit).find("vrm>html").text();$("#middle").html(_html);Editor.EnableEditor();RulesMaker.Load(vrmEdit);Global.ShowErrorMessage("<h3>Update of VRM Page Failed</h3><p>Please diagnose the problem using the information found in the 'Ajax' and 'Logging' tabs.</p>")};Communication.ProcessRequest(request)}catch(err){Global.HideProgress();iLog("EditorUpdate",err,Log.Type.Error)}},ProcessRequest:function(objRequest,isCallback){try{if(working){return}working=true;iLog("ProcessRequest","Called");Communication.InitialRequest=!isCallback;var url=objRequest.url;if(!url){url=objRequest.host+objRequest.template}if(url.indexOf("t=")==-1){var d=new Date(),t=d.getTime().toString(),s="t="+t;url+=(url.indexOf("?")==-1)?"?"+s:"&"+s}objRequest.url=url;if(url.indexOf("IconTray.max")==-1){Communication.ResetTimeout()}var sess="id="+objRequest.id+"&"+sessValName+"="+sessValID,data=objRequest.data||"";if(data&&!data.beginsWith("&")){data="&"+data}objRequest.data=sess+data;AjaxTab.AddCommand(Utilities.ToString(objRequest));var req=$.ajax({url:objRequest.url,data:objRequest.data,cache:objRequest.cache,timeout:objRequest.timeout,processData:true,dataType:objRequest.dataType,type:objRequest.method,success:function(data){working=false;ReqList.Load(data);WatchList.Load(data);AjaxTab.AddResponse(data);objRequest.onSuccess(data);data=null},error:function(XMLHttpRequest,textStatus,errorThrown){try{working=false;var s="";try{s=Utilities.ToString(XMLHttpRequest)}catch(err){s="XMLHttpRequest failed to serialize: "+err.message;iLog("ProcessRequest",s,Log.Type.Error,true)}var msg="Error: "+errorThrown+", Status: "+textStatus;AjaxTab.AddResponse(s,msg);objRequest.onError(msg,s)}catch(err){iLog("ProcessRequest",err,Log.Type.Error)}},complete:function(){working=false}});working=false}catch(err){iLog("ProcessRequest",err,Log.Type.Error)}},CorrectUI:function(target){try{iLog("CorrectUI","Called");var cnt=0,target=$(target),comps=target.find(".component");for(var i=0;i<comps.length;i++){var ctrl=PageHelper.GetEditorComponent(comps[i]);if(ctrl&&ctrl.CorrectUI&&!ctrl.Corrected){ctrl.CorrectUI();cnt++}if(cnt>99){setTimeout("Communication.CorrectUI('"+target.selector+"')",1000);break}}iLog("CorrectUI","Corrected "+cnt+" components")}catch(err){iLog("CorrectUI",err,Log.Type.Error)}},MakeAllCompsDefault:function(target,clearScripts,executeOnLoad){try{var newOnLoad=false,comps=target.find(".component");iLog("MakeAllCompsDefault","Loading "+comps.length+" components");comps.each(function(){var ctrl=PageHelper.GetEditorComponent(this);if(ctrl&&ctrl.DefaultMode(clearScripts)){newOnLoad=true}});this.CorrectUI(target.selector);RemoveOldCKEditors();if(Editor.Enabled){return}comps.each(function(){var ctrl=PageHelper.GetEditorComponent(this);if(ctrl){var par=ctrl.GetControl();if(par.css("display")=="none"&&$.inArray(ctrl.refClassName,["ScriptCont","ValidCont"])==-1){iLog("MakeAllCompsDefault","Incompatible element! To hide the element use 'Client Condition' property instead setting its visibility in style!\n"+Utilities.IdentifyChildren(par),Log.Type.Warning)}if(ctrl.GetCliCondition){var s=ctrl.GetCliCondition();if(s){try{if(!eval(s)){par.hide()}}catch(err){iLog("Client Condition",err,Log.Type.Error,true)}}}if(ctrl.GetHelpLink&&ctrl.GetHelpLink()){PageHelper.AddHelpLink(ctrl)}}});var eFn;if(executeOnLoad&&newOnLoad){iLog("GlobalScript.OnLoad","Called",Log.Type.Info);try{eFn=GlobalScript.OnLoad||$.noop;eFn()}catch(err){iLog("GlobalScript.OnLoad",err,Log.Type.Error,true)}iLog("CustomScript.OnLoad","Called",Log.Type.Info);try{eFn=CustomScript.OnLoad||$.noop;eFn()}catch(err){iLog("CustomScript.OnLoad",err,Log.Type.Error,true)}}}catch(err){iLog("MakeAllCompsDefault",err,Log.Type.Error)}},LinkRequest:function(url,replaceDiv,hideProgress){try{iLog("LinkRequest","Called");var request=null;hideProgress=hideProgress||false;if(typeof url=="string"){if(!url){return}if(!hideProgress){Global.ShowProgress()}UpdateSessionFromURL(url);request=new Request();request.requestType="Link Request";request.id=Communication.SessionID;if(request.id){request.data="preprocess=true"}request.template=url}else{request=url}request.onSuccess=function(xml){Global.HideProgress();UpdateSessionFromXML(xml);var stingray=$(xml).find("stingray");var status=stingray.find("status").text();var target=replaceDiv||stingray.find("target").text();var vrmName=stingray.find("vrmname").text();var html=stingray.find("html").text();if(status=="success"){if(target){var t=$("#"+target);t.html(html);t.attr("VRMName",vrmName);Communication.MakeAllCompsDefault(t,true,true);if(target=="middle"){EnsureFooterSeparator(t)}Global.Tooltips()}iLog("LinkRequest","Success",Log.Type.Info)}else{iLog("LinkRequest","Failed",Log.Type.Error,true);Global.ShowErrorMessage(html)}ExecuteCallback(xml)};request.onError=function(msg,xml){iLog("LinkRequest","Failed! "+msg,Log.Type.Error,true);Global.HideProgress()};Communication.ProcessRequest(request)}catch(err){Global.HideProgress();iLog("LinkRequest",err,Log.Type.Error)}},SerialRequest:function(html,callID,srcElement,hideProgress){try{iLog("SerialRequest","Called");var request=null;var id;hideProgress=hideProgress||false;if(html.requestType){request=html}else{var strParams="";if(typeof html=="string"){var temp="";id=html;if(html.indexOf("?")>-1){temp=html.split("?");id=temp[0];strParams=temp[1];if(!strParams.beginsWith("&")){strParams="&"+strParams}}if(id.substring(0,1)!="#"){id="#"+id}html=$(id)}var validate=false,SubmitAct=null;if(srcElement==null&&Communication.event!=null){srcElement=Communication.event.srcElement||Communication.event.target}if(srcElement!=null){var el=$(srcElement);SubmitAct=el.attr("name");validate=(el.attr("CauseValidation")=="true")}if(validate&&!Validator.Validate(html)){return false}if(!hideProgress){Global.ShowProgress(srcElement)}request=new Request();var n=$(html).attr("VRMName");if(n==null){n=$("#middle").attr("VRMName")}request.template=n+".max";request.requestType="Serial Request";request.id=Communication.SessionID;if(SubmitAct){request.data="SubmitAct="+SubmitAct+strParams}else{request.data=strParams}var d=Utilities.Serialize($(html));if(d.indexOf("=")>-1){request.data+=(request.data)?"&"+d:d}}request.onSuccess=function(xml){try{Global.HideProgress();UpdateSessionFromXML(xml);var stingray=$(xml).find("stingray");var status=stingray.find("status").text();var target=stingray.find("target").text();var vrmName=stingray.find("vrmname").text();var html=stingray.find("html").text();if(status=="success"){if(target){if(target=="AdminTabs"&&MP.Tools.Initialized){return}var t=$("#"+target);t.html(html);t.attr("VRMName",vrmName);Communication.MakeAllCompsDefault(t,true,true);if(target=="middle"){EnsureFooterSeparator(t)}if(target=="menu"){var main=$("#menu").find(">ul").find(">li");main.hover(function(){var ul=$("<ul><li><a href='#'>test</a></li><li><a href='#'>test</a></li></ul>");$("menu").append(ul);ul.css("position","absolute");ul.css("display","block");ul.css("top",$(this).offset().top);ul.css("left",$(this).offset().left)})}Global.Tooltips();Global.RemoveAllSpellchecks()}iLog("SerialRequest","Success",Log.Type.Info)}else{var code=stingray.find("errorcode").text();if(code!="0101"){iLog("SerialRequest","Failed: "+code,Log.Type.Error,true);Global.ShowErrorMessage(html)}}ExecuteCallback(xml)}catch(err){iLog("SerialRequest",err,Log.Type.Error)}};request.onError=function(msg,xml){iLog("SerialRequest","Failed! "+msg,Log.Type.Error,true);Global.HideProgress()};Communication.ProcessRequest(request,callID=="CALLBACK");return true}catch(err){Global.HideProgress();iLog("SerialRequest",err,Log.Type.Error)}},OpenWindow:function(url){iLog("OpenWindow",url);this.ResetTimeout();var loc="../../window.htm?id="+this.SessionID+"&"+sessValName+"="+sessValID+"&template="+url.replace("?","&");window.open(loc)},ModalWindow:function(url,title,width){try{iLog("ModalWindow","Called");UpdateSessionFromURL(url);var request=new Request();request.requestType="Modal Window Request";request.id=Communication.SessionID;request.data="preprocess=true";request.template=url;request.onSuccess=function(xml){var status=$(xml).find("stingray").find("status").text();var html=$(xml).find("stingray").find("html").text();if(status=="success"){Global.ShowMessage(html,width,title);Communication.MakeAllCompsDefault($("#ModalWindow"),false,true);Global.Tooltips();iLog("ModalWindow","Success",Log.Type.Info)}else{iLog("ModalWindow","Failed",Log.Type.Error,true);Global.ShowErrorMessage(html)}};request.onError=function(msg,xml){iLog("ModalWindow","Failed! "+msg,Log.Type.Error,true)};Communication.ProcessRequest(request)}catch(err){iLog("ModalWindow",err,Log.Type.Error)}},CustomRequest:function(url,replaceID,srcElement,data){try{iLog("CustomRequest","Called");if(srcElement){var s=$(srcElement).val();if(s){url+=(url.indexOf("?")==-1?"?":"&");url+="value="+encodeURIComponent(s)}}UpdateSessionFromURL(url);var request=new Request();request.requestType="Custom Request";request.id=Communication.SessionID;request.data=data;request.template=url;request.onSuccess=function(xml){UpdateSessionFromXML(xml);var status=$(xml).find("stingray").find("status").text();var html=$(xml).find("stingray").find("html").text();if(status=="success"){if(replaceID){if(Utilities.IsFunction(replaceID)){replaceID(html)}else{var div=$("#"+replaceID);div.html(html);div.change()}}iLog("CustomRequest","Success",Log.Type.Info)}else{iLog("CustomRequest","Failed",Log.Type.Error,true);Global.ShowErrorMessage(html)}ExecuteCallback(xml)};request.onError=function(msg,xml){iLog("CustomRequest","Failed! "+msg,Log.Type.Error,true)};Communication.ProcessRequest(request)}catch(err){iLog("CustomRequest",err,Log.Type.Error)}}}}catch(err){iLog("Main",err,Log.Type.Error)}};return Communication});define("Browser",[],function(){var a=new function(){try{var b="Browser.";function c(h,g,f,e){Log.Add(b+h,g,f,e)}return{IsMSIE:function(){return $.browser.msie||false},IsSafari:function(){return($.browser.safari&&!/chrome/.test(navigator.userAgent.toLowerCase()))||false},IsChrome:function(){return($.browser.safari&&/chrome/.test(navigator.userAgent.toLowerCase()))||false},IsFirefox:function(){return $.browser.mozilla||false},IsValidBrowser:function(){return true},DetectExplorer:function(){return navigator.userAgent}}}catch(d){c("Main",d,Log.Type.Error)}};window.IsMSIE=a.IsMSIE;window.IsSafari=a.IsSafari;window.IsChrome=a.IsChrome;window.IsFirefox=a.IsFirefox;window.IsValidBrowser=a.IsValidBrowser;window.DetectExplorer=a.DetectExplorer;return a});define("PropertyFieldData",["PropertyFields"],function(a){var b=function(c,d){if(typeof c==="string"){c=a[c]}this.propertyField=c;this.options=d};b.prototype.get=function(){return(this.options.getter||$.noop)()};b.prototype.set=function(c){(this.options.setter||$.noop)(c)};b.prototype.isDisabled=function(){return !this.options.setter};b.prototype.language=function(){return this.propertyField.language};b.prototype.allowsLiveEditing=function(){if(typeof this.propertyField.live!=="undefined"){return this.propertyField.live}else{return false}};return b});define("TokenTooltip",[],function(){if(!window.ace){return}var e=ace.require("ace/lib/dom");var c=ace.require("ace/lib/event");var d=ace.require("ace/range").Range;var b;var a=function(f){if(f.tokenTooltip){return}f.tokenTooltip=this;this.editor=f;f.tooltip=b||this.$init();this.update=this.update.bind(this);this.onMouseMove=this.onMouseMove.bind(this);this.onMouseOut=this.onMouseOut.bind(this);c.addListener(f.renderer.scroller,"mousemove",this.onMouseMove);c.addListener(f.renderer.content,"mouseout",this.onMouseOut)};(function(){this.token={};this.range=new d();this.update=function(){this.$timer=null;var f=this.editor.renderer;if(this.lastT-(f.timeStamp||0)>1000){f.rect=null;f.timeStamp=this.lastT;this.maxHeight=innerHeight;this.maxWidth=innerWidth}var m=f.rect||(f.rect=f.scroller.getBoundingClientRect());var l=(this.x+f.scrollLeft-m.left-f.$padding)/f.characterWidth;var o=Math.floor((this.y+f.scrollTop-m.top)/f.lineHeight);var j=Math.round(l);var h={row:o,column:j,side:l-j>0?1:-1};var n=this.editor.session;var p=n.screenToDocumentPosition(h.row,h.column);var k=n.getTokenAt(p.row,p.column);if(!k&&!n.getLine(p.row)){k={type:"",value:"",state:n.bgTokenizer.getState(0)}}if(!k){n.removeMarker(this.marker);b.style.display="none";this.isOpen=false;return}if(!this.isOpen){b.style.display="";this.isOpen=true}var g=k.type;if(k.state){g+="|"+k.state}if(k.merge){g+="\n  merge"}if(k.stateTransitions){g+="\n  "+k.stateTransitions.join("\n  ")}if(this.tokenText!=g){b.textContent=g;this.tooltipWidth=b.offsetWidth;this.tooltipHeight=b.offsetHeight;this.tokenText=g}this.updateTooltipPosition(this.x,this.y);this.token=k;n.removeMarker(this.marker);this.range=new d(p.row,k.start,p.row,k.start+k.value.length);this.marker=n.addMarker(this.range,"ace_bracket","text")};this.onMouseMove=function(f){this.x=f.clientX;this.y=f.clientY;if(this.isOpen){this.lastT=f.timeStamp;this.updateTooltipPosition(this.x,this.y)}if(!this.$timer){this.$timer=setTimeout(this.update,100)}};this.onMouseOut=function(h){var g=h&&h.relatedTarget;var f=h&&h.currentTarget;while(g&&(g=g.parentNode)){if(g==f){return}}b.style.display="none";this.editor.session.removeMarker(this.marker);this.$timer=clearTimeout(this.$timer);this.isOpen=false};this.updateTooltipPosition=function(f,h){var g=b.style;if(f+10+this.tooltipWidth>this.maxWidth){f=innerWidth-this.tooltipWidth-10}if(h>innerHeight*0.75||h+20+this.tooltipHeight>this.maxHeight){h=h-this.tooltipHeight-30}g.left=f+10+"px";g.top=h+20+"px"};this.$init=function(){b=document.documentElement.appendChild(e.createElement("div"));var f=b.style;f.position="fixed";f.display="none";f.background="lightyellow";f.borderRadius="";f.border="1px solid gray";f.padding="1px";f.zIndex=2001;f.fontFamily="monospace";f.whiteSpace="pre-line";return b};this.destroy=function(){this.onMouseOut();c.removeListener(this.editor.renderer.scroller,"mousemove",this.onMouseMove);c.removeListener(this.editor.renderer.content,"mouseout",this.onMouseOut);delete this.editor.tokenTooltip}}).call(a.prototype);return a});define("PropertyEditorFactory",["PropertyFieldData","TokenTooltip"],function(e,b){var d=[];var a={small:{width:100},medium:{width:250,height:"1.3em"},wide:{width:"96%",height:"1.3em"},large:{width:"96%",height:"15em"}};var c={DestroyAceEditors:function(){$.each(d,function(g,f){f.destroy();f=null});d=[]},ResizeAceEditors:function(){var j=0,m=-1;$.each(d,function(p,o){var q=$(o.container);if(q.position().top>j){j=q.position().top;m=p}});if(m==-1){return}$.each(d,function(p,o){var q=$(o.container);q.height(200)});var h=d[m],n=$(h.container),l=n.parents("#PropertyDlg"),k=n.parents(".PropertyEditorTable"),g=l.height(),f=k.height();if(g>f){n.height(g-f+200)}$.each(d,function(p,o){o.resize()})},create:function(j){var h=j.propertyField.type;var f=c[h];if(h==="create"||typeof f!=="function"){throw new Error("Bad property type: "+h)}var g=f(j);g.refresh();return g},text:function(h){var l=h.propertyField.sizeHint;if(!Object.prototype.hasOwnProperty.call(a,l)){l="medium"}var f=$('<div class="noWrap"/>');var g=null;var k=null;if(l==="large"&&MP.Tools.AceIsEnabled()){g=$("<div/>").appendTo(f);k=Global.ConvertToAceEditor(g,h.language(),false);d.push(k)}else{var j=l!=="small";if(j){g=$('<textarea class="ace_textarea"/>')}else{g=$('<input type="text"/>')}g.attr("title",h.propertyField.description||"").attr("disabled",h.isDisabled()?"disabled":"").css(a[l]).appendTo(f);if(j&&MP.Tools.AceIsEnabled()){$("<div/>").attr("title","Switch to advanced editor").addClass("ace_resize").appendTo(f).bind("click",function(){$(this).hide();k=Global.ConvertToAceEditor(g,h.language(),true);d.push(k);c.ResizeAceEditors()})}}refresh=function(){var m=h.get();if(k){k.setValue(m,-1)}else{g.val(m)}};save=function(){var m;if(k){m=k.getValue()}else{m=g.val()}h.set(m)};if(h.allowsLiveEditing()){g.bind("keyup change",save)}return{$element:f,refresh:refresh,save:save}},multi:function(h){var w=h.propertyField.data;if(!w){throw new Error("Property is missing spec: "+(h.propertyField.name||h.propertyField.label))}var v=$("<table/>");var f=$("<thead/>").appendTo(v);var l=$("<tbody/>").appendTo(v);var m=$("<tfoot/>").appendTo(v);var o=$("<tr/>").appendTo(f);$.each(w,function(y,x){$("<th/>").text(x.label).appendTo(o)});var t=[];var k=[];var u=function(x,z){var A=new e(x,{getter:function(){return z[x.name]},setter:function(B){z[x.name]=B}});var y=c.create(A);k.push({item:z,editor:y});return $("<td/>").append(y.$element)};var g=function(y){var x=$("<tr/>");$.each(w,function(A,z){u(z,y).appendTo(x)});x.find("td:last").css("width","100%");$('<td><img src="../../images/deleteparam.png" title="Delete"/></td>').css("cursor","pointer").one("click",function(){var z=$.inArray(y,t);t.splice(z,1);$.each(k,function(B,C){if(C&&C.item===y){k[B]=null}});k=$.grep(k,function(B){return B!=null});var A=h.options.args.DeleteParam||$.noop;A(z);x.remove()}).appendTo(x);return x};var n=function(x){var z=x||{};t.push(z);var y=h.options.args.AddParam||$.noop;y();g(z).appendTo(l)};var q=$("<tr/>").appendTo(m);var j=$("<td/>").attr("colspan",w.length+1).appendTo(q);$('<img src="../../images/param-add.png" title="Add new" class="paramActions"/>').click(n).appendTo(j);if(h.propertyField.description=="Set Query Parameters"&&MP.Tools.AceIsEnabled()){$('<img src="../../images/param-link.png" title="Generate query parameters" class="paramActions"/>').click(function(){var y=d[0].getValue(),A=y.match(/:(\w+)/g),x=p(),z=0;$.each(A,function(E,B){var C=B.replace(":",""),G=C.toUpperCase(),F=false;for(var E=0;E<x.length;E++){if(x[E].Name.toUpperCase()==G){F=true;break}}if(!F){var D={Name:C,Type:"STRING",Value:"#S"+C+"#"};n(D);z++}});if(z){y=z==1?" parameter was":" parameters were";jAlert(z+y+" added. Please verify their Types and Values are correct.")}}).appendTo(j);$('<img src="../../images/query-validate.png" title="Validate query" class="paramActions"/>').click(function(){var y=p();var C="";for(var A=0;A<y.length;A++){C=C+","+y[A].Name+"="+y[A].Type}C="&params="+encodeURIComponent(C.substr(1));var B="&query="+encodeURIComponent(d[0].getValue());var z="admintabs.max?action=ValidateQuery";var x=function(D){var E={Close:function(){$(this).dialog("close")}};Global.ShowMessage(D,600,"Query Validator",null,E)};Communication.CustomRequest(z,x,null,B+C)}).appendTo(j)}var s=function(){t=$.extend(true,[],h.get());k=[];l.empty();$.each(t,function(x,y){g(y).appendTo(l)})};var p=function(){$.each(k,function(y,z){if(z&&z.editor){z.editor.save()}});var x=$.grep(t,function(y){return y!==null});return x};var r=function(){var x=p();h.set(x)};return{$element:v,refresh:s,save:r}},checkbox:function(j){var h=$("<input/>").attr("title",j.propertyField.description||"").attr("type","checkbox");var f=function(){setTimeout(function(){h.attr("checked",j.get()?"checked":"")},0)};var g=function(){j.set(h.is(":checked"))};if(j.allowsLiveEditing()){h.bind("change",function(){g()})}return{$element:h,refresh:f,save:g}},select:function(j){var f=$("<select/>").attr("title",j.propertyField.description||"").append(Utilities.ConvertToOptions(j.propertyField.data||[]));var g=function(){f.val(j.get())};var h=function(){j.set(f.val())};if(j.allowsLiveEditing()){f.bind("keydown keyup keypress change",function(){h()})}return{$element:f,refresh:g,save:h}},csf:function(h){var v=MP.Tools.Config.ScriptFunctions;var u=$("<div/>");var t=[];var w=[];var s=[];var g=0;var p=function(x){if(w instanceof Array){var y=$.grep(w,function(z){return z.Name==x});if(y.length>0){return y[0].Value}else{return""}}else{return""}};var o=function(x){if($.inArray(x.cat,["record","object","array"])>-1){return"large"}else{return"wide"}};var f=function(z,D){var y=$("<p/>").appendTo(u);z.value=p(z.name);y.append("<label>"+D+"</label></br>");g++;var B={ID:"csf-"+z.name+"-"+g.toString(),Name:z.name,Value:z.value,Input:null,Language:""};t.push(B);if(z.cat=="procedure"){return}var A=o(z);var C=A=="large";if(C){var x=$('<textarea class="ace_textarea"/>')}else{var x=$('<input type="text" class="ace_input"/>')}x.attr("id",B.ID).attr("title",z.label||"").val(z.value).css(a[A]).appendTo(y);B.Input=x;if(MP.Tools.AceIsEnabled()){$("<div/>").attr("title","Switch to advanced editor").addClass("ace_resize").appendTo(y).bind("click",function(){$(this).hide();var E=Global.ConvertToAceEditor(x,B.Language,true);d.push(E);B.Input=E;c.ResizeAceEditors()})}};var n=function(){u.find("p").remove();t=[];g=0};var m=function(){$.each(t,function(x,y){if(y.Input&&y.Input.getValue){y.Value=y.Input.getValue()}else{y.Value=$("#"+y.ID).val()}})};var l=function(A){try{A=A||w[0].Name;var y=null;$.each(v,function(B,C){if(C.name==A){y=C;return}});if(!y){throw"Unknown function "+A+"!"}n();k.val(A);var x=y.type?"<br><br>return: "+y.type+";":"";f(y,y.def+"<br><br>"+y.label+x);w.splice(0,1);$.each(y.params,function(B,C){f(C,C.pass+" "+C.name+": "+C.type+";")})}catch(z){iLog("makePropertis",z,Log.Type.Error)}};var j=function(){var y=function(z){return $("<option/>").attr("value",z.name).attr("title",z.def+"\n\n"+z.label).text(z.name)};var x=$([]);$.each(v,function(z,A){x=x.add(y(A))});return x};var k=$("<select/>").attr("title",h.propertyField.description||"").append(j()).appendTo(u).change(function(){w=$.extend(true,[],s);l($(this).val())});var r=function(){w=$.extend(true,[],h.get());s=$.extend(true,[],w);l()};var q=function(){m();h.set(t)};if(h.allowsLiveEditing()){k.bind("keydown keyup keypress change",function(){q()})}return{$element:u,refresh:r,save:q}}};return c});define("RuleXML",["RuleStorage"],function(b){var a=new function(){var c="RuleXML.";var d=null;function e(j,h,g,f){Log.Add(c+j,h,g,f)}return{CurrentProcess:"",AddComponent:function(f){try{e("AddComponent","Called");$(d).find("vrm>"+this.CurrentProcess).append(f)}catch(g){e("AddComponent",g,Log.Type.Error)}},AppendXML:function(h){try{var f=$(d).find("vrm>"+this.CurrentProcess);f.append(h)}catch(g){e("AppendXML",g,Log.Type.Error)}},GetComponent:function(f){try{if(typeof f!="number"){f=parseInt(f,10)}var g="";$(d).find("vrm>"+this.CurrentProcess+">c").each(function(){if(parseInt($(this).find(">n").text(),10)==f){g=Utilities.GetXmlString(this)}});return g}catch(h){e("GetComponent",h,Log.Type.Error)}},DeleteComponent:function(f){try{e("DeleteComponent","Called");var g=null;$(d).find("vrm>"+this.CurrentProcess+">c").each(function(){if($(this).find(">n").text()==f){g=this}$(this).find("j").each(function(){if($(this).text()==f){$(this).text("")}})});if(g!=null){g.parentNode.removeChild(g)}}catch(h){e("DeleteComponent",h,Log.Type.Error)}},Load:function(f){try{e("Load","Called");d=f}catch(g){e("Load",g,Log.Type.Error)}},GetFromComponent:function(f){try{if(typeof f!="number"){f=parseInt(f,10)}var h=null;$(d).find("vrm>"+this.CurrentProcess+">c").each(function(){var j=parseInt($(this).find("n").text(),10);$(this).find("j").each(function(){var k=$(this).text();if(k==f.toString()){h=b.GetComponent(j)}})});return h}catch(g){e("GetFromComponent",g,Log.Type.Error)}},GetNewElement:function(g){try{return d.createElement(g)}catch(f){e("GetNewElement",f,Log.Type.Error)}},GetNewCDATA:function(g){try{g=g||"";return d.createCDATASection(g)}catch(f){e("GetNewCDATA",f,Log.Type.Error)}},ReplaceCDATA:function(j,l){try{var f=$(j)[0].parentNode;var m=$(j)[0].nodeName;var k=a.GetNewCDATA(l);var g=a.GetNewElement(m);$(g).append(k);f.replaceChild(g,$(j)[0])}catch(h){e("ReplaceCDATA",h,Log.Type.Error)}},GetNextComponentNumber:function(){try{var f=-1;var g=false;$(d).find("vrm>"+this.CurrentProcess+">c").each(function(){var j=$(this).find(">n").text();if(j=="0"){g=true}if(parseInt(j,10)>f){f=parseInt(j,10)}});if(!g){return 0}return f+1}catch(h){e("GetNextComponentNumber",h,Log.Type.Error)}},GetVRM:function(){return d},GetFunctionXML:function(){try{return $(d).find("vrm>function")}catch(f){e("GetFunctionXML",f,Log.Type.Error)}},GetPostProcessXML:function(){try{return $(d).find("vrm>postproc")}catch(f){e("GetPostProcessXML",f,Log.Type.Error)}},GetPreProcessXML:function(){try{return $(d).find("vrm>preproc")}catch(f){e("GetPreProcessXML",f,Log.Type.Error)}},SetPostProcessXML:function(f){try{$(d).find("vrm>postproc").text($(f).text())}catch(g){e("SetPostProcessXML",g,Log.Type.Error)}},SetPreProcessXML:function(f){try{$(d).find("vrm>preproc").text($(f).text())}catch(g){e("SetPreProcessXML",g,Log.Type.Error)}}}};return a});define("ContextMenuItems",[],function(){function a(){var c=$("<ul/>");function b(d){var e=d.find(">ul");if(e.length==0){e=$("<ul/>")}d.append(e);return e}this.Add=function(e,h,g){var d=$("<li/>");d.text(e);if(h){d.click(function(){h()})}if(g){var f=b(g);f.append(d)}else{c.append(d)}return d};this.GetHTML=function(){return c}}return a});define("ContextMenu",["Storage"],function(a){var b=new function(){var f="ContMenu.";var j=new a();var c=$("<div class='contextMenu'></div>");var e=false;var d=this;function g(n,m,l,k){Log.Add(f+n,m,l,k)}function h(l,o,p){var n=p;var m=l;var k=o;this.Name=function(){return n};this.Attach=function(){$(m).each(function(){this.oncontextmenu=function(q){b.Show(k,q||window.event);return false}})};this.Detach=function(){$(m).each(function(){this.oncontextmenu=null})}}return{Initialized:false,Enabled:true,EventComponent:null,OffsetX:0,OffsetY:0,ScrollX:0,ScrollY:0,ClientX:0,ClientY:0,Initialize:function(){try{if(this.Initialized){return}g("Initialize","Called");$("body").append(c);$("body").bind("click.contextMenu",function(){b.Hide()});this.Initialized=true}catch(k){g("Initialize",k,Log.Type.Error)}},Add:function(l,k,n){try{g("Add","Called");n=n||l;var o=new h(l,k,n);j.AddComponent(o,n);o.Attach()}catch(m){g("Add",m,Log.Type.Error)}},Refresh:function(){try{g("Refresh","Called");var m=j.GetItemArray();for(var k=0;k<m.length;k++){var n=m[k];n.Attach()}}catch(l){g("Refresh",l,Log.Type.Error)}},Remove:function(l){try{g("Remove","Called");var m=j.GetComponent(l);if(m){m.Detach();j.Remove(l)}}catch(k){g("Remove",k,Log.Type.Error)}},RemoveAll:function(){try{g("RemoveAll","Called");var m=j.GetItemArray();for(var k=0;k<m.length;k++){var n=m[k];n.Detach()}j.Reset()}catch(l){g("RemoveAll",l,Log.Type.Error)}},Detach:function(l){try{g("Detach","Called");var m=j.GetComponent(l);if(m){m.Detach()}}catch(k){g("Remove",k,Log.Type.Error)}},DetachAll:function(){try{g("DetachAll","Called");var m=j.GetItemArray();for(var k=0;k<m.length;k++){var n=m[k];n.Detach()}}catch(l){g("DetachAll",l,Log.Type.Error)}},Attach:function(l){try{g("Attach","Called");var m=j.GetComponent(l);if(m){m.Attach()}}catch(k){g("Remove",k,Log.Type.Error)}},AttachAll:function(){try{g("AttachAll","Called");var m=j.GetItemArray();for(var k=0;k<m.length;k++){var n=m[k];n.Attach()}}catch(l){g("AttachAll",l,Log.Type.Error)}},Hide:function(){if(!e){return}g("Hide","Called");c.css("display","none");e=false},Show:function(m,k){try{this.Hide();g("Show","Called");var l=m();if(l==null){return false}k=k||window.event;this.ScrollX=document.body.scrollLeft?document.body.scrollLeft:document.documentElement.scrollLeft;this.ScrollY=document.body.scrollTop?document.body.scrollTop:document.documentElement.scrollTop;this.ClientX=k.clientX;this.ClientY=k.clientY;this.EventComponent=k.target!=null?k.target:k.srcElement;if(k.offsetX&&k.offsetY){this.OffsetX=k.offsetX;this.OffsetY=k.offsetY}else{var o=$(this.EventComponent).offset();this.OffsetX=Utilities.ToNumber(k.pageX-o.left);this.OffsetY=Utilities.ToNumber(k.pageY-o.top)}if(!this.Enabled){return false}c.css("left",this.ClientX+this.ScrollX+"px");c.css("top",this.ClientY+this.ScrollY+"px");c.html(l);c.css("display","block");e=true;return true}catch(n){g("Show",n,Log.Type.Error)}}}};return b});define("PropertyEd",["PropertyEditorFactory","PropertyFields","PropertyFieldData","Communication","Editor","RuleXML","ContextMenu","PageHelper","RuleHelper"],function(d,c,b,k,f,g,j,e,a){var h=function(p){this.reset();this._div=$('<div id="PropertyDlg"/>');this._table=$("<table/>").appendTo(this._div).addClass("PropertyEditorTable");var l=this,n;var o=function(){if(n){return}n=MP.Tools.Config.Editor.property};var r=function(s){if(s==p){n.pinned=!n.pinned}else{n.pinned=s}q();if(n.pinned){$(window).bind("scroll.pinPropertyDiv",function(){var t=l._div.parent();if(t.is(":visible")){t.css("top",(l._div.data("lastTop")+$(document).scrollTop())+"px")}})}else{$(window).unbind("scroll.pinPropertyDiv")}};var q=function(){var t=$(".ui-dialog-buttonpane",l._div.parent());var s=function(u){return $("button:contains("+u+")",t)};if(n.pinned){s("Pin").html("Unpin")}else{s("Unpin").html("Pin")}};var m={Cancel:function(){l.revertAndClose()},Delete:function(){l.saveAndClose();if(l.deleteCallback){l.deleteCallback.call(null)}},Pin:function(){r()}};this._div.dialog({minWidth:470,minHeight:250,width:650,autoOpen:false,closeOnEscape:true,modal:false,buttons:m,resizeStart:function(){Global.DisableHighlightingInChrome(true)},resizeStop:function(){Global.DisableHighlightingInChrome(false);d.ResizeAceEditors()},dragStart:function(){Global.DisableHighlightingInChrome(true)},dragStop:function(s,t){Global.DisableHighlightingInChrome(false);Global.UpdateLastPosition(l._div,t)},open:function(s,t){q();if(l._div.data("lastLeft")&&l._div.data("lastTop")){l._div.dialog("option",{position:[l._div.data("lastLeft"),l._div.data("lastTop")]})}else{Global.UpdateLastPosition(l._div,t)}},close:function(){l.save();l.reset()}});o();r(n.pinned||false)};h.prototype.iLog=function(o,n,m,l){Log.Add("PropEditor.P."+o,n,m,l)};h.prototype.reset=function(){this.iLog("Reset","Called");this.editors=[];this.properties=[];this.originalValues=[];d.DestroyAceEditors()};h.prototype.show=function(q,y,s){this.iLog("Show","Called");this.reset();this.properties=q.slice(0);this.deleteCallback=y;var x=this;var v=this._table.empty();var m=$("<tbody/>").appendTo(v);var p=this.editors=$.map(this.properties,function(w){return d.create(w)});this.originalValues=(function(z){var w=[];$.each(z,function(A,B){w.push(B.get())});return w}(q));$.each(this.properties,function(B,D){var z=D.propertyField;var w=$("<th/>").text(z.label).addClass("PropertyEditorName");var C=$("<td/>").append(p[B].$element).addClass("PropertyEditorValue");if(p[B].$element.attr("title").match(/The name of the component/g)){var A=p[B].$element;$(A).bind("focus",function(){$(this).attr("oldname",$(this).val())});$(A).bind("change",function(){var F=$(this);if(!F.val()){F.val(F.attr("oldname"));jAlert("Component name cannot be blank!","Name Warning",function(){F.focus();F.select()});return false}var E=[];$('input[type!="radio"]').each(function(){if($(this).attr("id")){E.push($(this).attr("id"))}});$("select").each(function(){if($(this).attr("id")){E.push($(this).attr("id"))}});if($.inArray(F.val(),E)>-1){var G=F.val();F.val(F.attr("oldname"));jAlert("Component of name <b>"+G+"</b> already exists!<br>Please eneter another name.","Name Warning",function(){F.focus();F.select()});return false}})}C.find("textarea").removeAttr("disabled");$("<tr/>").append(w,C).appendTo(m)});var o=x._div;o.dialog("option","title",s||"Editor");o.dialog("open");var t=$(window);var r=t.scrollTop();var l=r+t.height();var n=o.offset().top;var u=n+o.height();if((n<r)||(u>l)){o.dialog("option","position",["center","center"])}d.ResizeAceEditors()};h.prototype.save=function(){if(this.editors.length==0){return}this.iLog("Save","Called");$(this.editors).each(function(m,n){n.save()});var l=RulesMaker.GetCurrentComponent();if(l){l.Icon.UpdateHint();l.UpdateWatchpoint()}};h.prototype.revertAndClose=function(){this.iLog("RevertAndClose","Called");this.revertChanges();this.saveAndClose()};h.prototype.saveAndClose=function(){this.iLog("SaveAndClose","Called");this._div.dialog("close")};h.prototype.revertChanges=function(){this.iLog("RevertChanges","Called");var l=this.originalValues;$(this.properties).each(function(m,n){n.set(l[m])});$(this.editors).each(function(m,n){n.refresh()})};h.prototype.exit=function(){this.iLog("Exit","Called");var l=this;var m=function(){l.revertAndClose();f.DisableEditor();RulesMaker.Disable();j.RemoveAll();k.CloseEditor()};if(f.LockedBy){m()}else{jConfirm("Are you sure you want to exit without saving?","Confirm Exit",function(n){if(n){m()}})}};h.prototype.savePageQuick=function(){this.iLog("SavePageQuick","Called");this.saveAndClose();f.DisableEditor();k.EditorUpdate(true)};h.prototype.savePage=function(){this.iLog("SavePage","Called");var l=this,m=e.ValidatePage()+a.ValidatePage();function n(){l.saveAndClose();f.DisableEditor();RulesMaker.Disable();j.RemoveAll();k.EditorUpdate(false)}if(!m){n();return}jConfirm("There are some warnings on this page. Please view details in the logging pane.<p>"+m+"</p><p>Click cancel to make changes. Click OK to save, but ignoring warnings may result in QA rejection.</p>","Page validation",function(o){if(o){n()}})};h.iLog=function(o,n,m,l){Log.Add("PropEditor."+o,n,m,l)};h.Property=function(m,l,o,n){return new b(m,{getter:l,setter:o,args:n})};h.GetInstance=function(){if(this.editor){var l=this.editor;l.save()}else{var l=new h()}this.editor=l;return l};h.Show=function(){this.iLog("Show","Called");var l=this.GetInstance();l.show.apply(l,arguments);return l};h.Hide=function(){var l=this.GetInstance();l.saveAndClose();return l};h.Disable=function(){this.iLog("Disable","Called");this.GetInstance().exit()};h.Save=function(){if(!f.Enabled||f.LockedBy||Global.InProgress()){return}this.iLog("Save","Called");this.GetInstance().savePage()};h.QuickSave=function(){if(!f.Enabled||f.LockedBy||Global.InProgress()){return}this.iLog("QuickSave","Called");this.GetInstance().savePageQuick()};return h});define("Global",["Editor","ReqList","Log","PageHelper"],function(c,b,a,e){var d=new function(){try{var h="Global.";var f=null;function j(o,n,m,l){a.Add(h+o,n,m,l)}function g(n,m){if(!n||!n.selectorText){return}if(Utilities.IsObject(m)){var o=m}else{var o=jsonParse(m)}var l=n.selectorText.toLowerCase().replace(/'/g,'"');var p=n.style;switch(l){case"body":p.backgroundColor=o.BodyBackground;break;case"h1, h2, h3":case"h1":case"h2":case"h3":p.color=o.HTagColor;break;case"a":case"a:visited":case"a, a:visited":case".validationerrors li":p.color=o.Anchor;break;case"a:hover":case".validationerrors li:hover":p.color=o.AnchorHover;break;case".sdata":case".sheader":case"#shell":p.backgroundColor=o.Shell;break;case"#bottom":p.backgroundColor=o.FootColor;break;case".required":p.color=o.Required;break;case".notrequired":p.color=o.NotRequired;break;case"input, select, textarea":case".editortext span":case".editormemospan":case".memospelldiv":p.backgroundColor=o.InputBackground;break;case'input[type="button"]':p.backgroundColor=o.ButtonBackground;break;case".staticcontainer h3, .dynamiccontainer h3, .validationcontainer h3, .scriptingcontainer h3":case".staticcontainer h3":case".dynamiccontainer h3":case".validationcontainer h3":case".scriptingcontainer h3":p.color=o.ContainerHeadTextColor;p.backgroundColor=o.ContainerHeadBackgroundColor;break;case".editorlabel label.pagetitle":p.color=o.PageTitle;break;case".tablemaster tr":case".tablemastersm tr":case".ac_odd":p.backgroundColor=o.TableRowColor;break;case".tablemaster tr.even":case".tablemastersm tr.even":case".ac_results":p.backgroundColor=o.TableAlternateRowColor;break;case".tablemaster thead tr":case".tablemastersm thead tr":p.backgroundColor=o.TableHeadColor;break;case"#menu":case"#menu ul ul ul a":p.backgroundColor=o.MenuBackgroundColor;break;case"#menu a":p.backgroundColor=o.MenuBackgroundColor;p.color=o.MenuTextColor;p.borderColor=o.MenuBorderColorTop+" "+o.MenuBorderColorRight+" "+o.MenuBorderColorBottom+" "+o.MenuBorderColorLeft;break;case"#menu a:hover":p.color=o.MenuHoverColor;break;case"#menu ul ul a":p.backgroundColor=o.MenuBackgroundColor;p.borderColor=o.MenuDropdownBorderColor;break}}return{DisableTooltips:false,WorkflowTimerInitialized:false,FadingHelpLinks:false,Version:function(){return MP.StingrayJsVersion},ShowBarcodeDlg:function(){jPrompt("Scan a barcode while the cursor is in this edit box\nWARNING: Any unsaved changes on current page will be lost!","","Barcode Scanner",function(l){if(l){Communication.LinkRequest("BarCode.max?"+$.param({BC:l}))}})},SetRequiredForAllElements:function(p,o){try{var l=o.split(",");for(var m=0;m<l.length;m++){d.GetControl($.trim(l[m])).SetRequired(p)}}catch(n){j("SetRequiredForAllElements",n,a.Type.Error)}},RemoveAllSpellchecks:function(){try{if(!window.livespell){return}livespell.spellingProviders=[]}catch(l){j("RemoveAllSpellchecks",l,a.Type.Error)}},AddSpellcheck:function(m){try{if(!window.$Spelling){jAlert("Spellcheck module not loaded!");return}var n=$(m).parent();n.children("span").hide();$Spelling.SpellCheckAsYouType(n.children("textarea"));n.removeClass("EditorMemo").addClass("MemoSpellDiv");n.children(".livespell_textarea").css({width:"100%",height:"100%"})}catch(l){j("AddSpellcheck",l,a.Type.Error)}},ConvertToInlineCKEditor:function(n){try{var p=$(n),r=p.attr("id"),o=p.attr("title"),m=CKEDITOR.instances[r];if(m){m.destroy()}p.attr("contenteditable",true);p.addClass("ckEditor");var l={removeButtons:"Anchor",title:o,toolbarGroups:[{name:"document",groups:["mode","document","doctools"]},{name:"clipboard",groups:["clipboard","undo"]},{name:"paragraph",groups:["list","indent","blocks","align","bidi"]},{name:"links"},{name:"insert"},{name:"editing",groups:["find","selection","spellchecker"]},"/",{name:"basicstyles",groups:["basicstyles","cleanup"]},{name:"styles"},{name:"colors"}]};return CKEDITOR.inline(r,l)}catch(q){j("ConvertToInlineCKEditor",q,a.Type.Error)}},GetCKEditorValue:function(m){try{var o=$(m).attr("id"),l=CKEDITOR.instances[o];if(l){return l.getData()}else{return""}}catch(n){j("GetCKEditorValue",n,a.Type.Error)}},ConvertToAceEditor:function(r,q,u){var n=function(x){if(x=="server script"){x="pascal"}return"ace/mode/"+x};var s=MP.Tools.Config.Editor.ace;var v,w,l;if((r.is("textarea")||r.is("input"))&&r.is(":visible")){r.hide();v=r.parent();l=$("<div/>").appendTo(v);l=l.get(0);w=ace.edit(l);w.session.setValue(r.val())}else{v=r.parent();l=r.get(0);w=ace.edit(l)}var t=["chrome","clouds","crimson_editor","dawn","dreamweaver","eclipse","github","solarized_light","textmate","tomorrow","xcode","clouds_midnight","cobalt","idle_fingers","kr_theme","merbivore","merbivore_soft","mono_industrial","monokai","pastel_on_dark","solarized_dark","tomorrow_night","tomorrow_night_blue","tomorrow_night_bright","tomorrow_night_eighties","twilight","vibrant_ink","ambiance","chaos"];var m=["text","sql","javascript","server script","xml","json","html","css"];var o="F1  -  Context help\nF11  -  Toggle full screen\nAlt-W  -  Toggle word wrap\nTab  -  Indent selection\nShift-Tab  -  Outdent selection\nAlt-S  -  Remove doubled single quotes\nAlt-D  -  Double single quotes\nCtrl-/  -  Toggle comment\nCtrl-L  -  Go to line number\nAlt-L  -  Toggle fold\nAlt-0  -  Fold all\nAlt-Shift-0  -  Unfold all\nCtrl-F  -  Find\nCtrl-H  -  Replace\nCtrl-K  -  Find next\nCtrl-Shift-K  -  Find previous\nCtrl-P  -  Jump to matching end\nCtrl-Shift-P  -  Select to matching end\nCtrl-U  -  To uppercase\nCtrl-Shift-U  -  To lowercase\nCtrl-D  -  Remove line\nCtrl-Shift-D  -  Duplicate selection\nCtrl-Alt-S  -  Sort selected lines\nAlt-Shift-Up  -  Copy lines up\nAlt-Up  -  Move lines up\nAlt-Shift-Down  -  Copy lines down\nAlt-Down  -  Move lines down\nCtrl-[  -  Outdent line\nCtrl-]  -  Indent line\nCtrl-Up  -  Scroll up\nCtrl-Down  -  Scroll down\nCtrl-A  -  Select all\nAlt-mouse  -  Select rectangle\nCtrl-Alt-E  -  Toggle recording\nCtrl-Shift-E  -  Replay macro";q=q||m[0];w.session.setMode(n(q));w.session.setUseWrapMode(s.wordWrap);w.setFontSize(14);var p=$("<div/>").addClass("noWrap").appendTo(v);$("<select/>").attr("title","Change editor theme").addClass("ace_selector").append(Utilities.ConvertToOptions(t)).appendTo(p).change(function(){var x=$(this).val();s.theme=x;w.setTheme("ace/theme/"+x)}).val(s.theme||t[0]).change();$("<select/>").attr("title","Change editor language").addClass("ace_selector").append(Utilities.ConvertToOptions(m)).appendTo(p).change(function(){var x=$(this).val().toLowerCase();w.session.setMode(n(x))}).val(q);$("<div/>").attr("title",o).addClass("ace_help").appendTo(p);if(s.codeTips){w.tokenTooltip=new TokenTooltip(w)}if(u){setTimeout(function(){w.focus()},50)}return w},GetCookie:function(n){try{var o,m,r,l,q;m=document.cookie.split("; ");for(o=0;o<m.length;o++){r=m[o];l=r.substr(0,r.indexOf("="));l=l.trim();if(l==n){q=r.substr(r.indexOf("=")+1);q=unescape(q);return q}}}catch(p){j("GetCookie",p,a.Type.Error,true)}return""},SetCookie:function(l,n){try{var o=new Date();o.setDate(o.getDate()+1);document.cookie=l+"="+escape(n)+"; expires="+o.toUTCString()}catch(m){j("SetCookie",m,a.Type.Error)}},SetClipboard:function(m){try{window.clipboardData.setData("text",m)}catch(l){j("SetClipboard",l,a.Type.Error)}},GetClipboard:function(){try{return window.clipboardData.getData("text")}catch(l){j("GetClipboard",l,a.Type.Error)}return""},CheckWorkflow:function(l){if(l==null&&d.WorkflowTimerInitialized==true){return}Communication.CustomRequest("IconTray.max?action=workflow",function(m){if(m!="none"){$("#WorkflowIcon").attr("src","../../images/32px-Crystal_Clear_app_access_"+m+".png")}else{$("#WorkflowIcon").css("display","none");return}},null);setTimeout("Global.CheckWorkflow(true)",300000);d.WorkflowTimerInitialized=true},Tooltips:function(m){try{if(m==undefined){m=d.DisableTooltips}else{d.DisableTooltips=m}if(m){$("*[oldtitle]").each(function(){$(this).attr("title",$(this).attr("oldtitle"));$(this).removeAttr("oldtitle")})}else{$("*[title]").each(function(){$(this).attr("oldtitle",$(this).attr("title"));$(this).removeAttr("title")})}}catch(l){j("Tooltips",l,a.Type.Error)}},GetControl:function(n){try{var m=$("*[name='"+n+"']"),l=new Array();m.each(function(){var p=$(this).parent(".component");if(p.length){l.push(e.GetEditorComponent(p[0]))}});if(l.length==1){return l[0]}else{return l}}catch(o){j("GetControl",o,a.Type.Error)}},MakeReadOnly:function(n){try{var m=null;if((typeof n==null)||(typeof n=="undefined")||n==""){m=$("#middle")}else{m=$(n)}inp=m.find(":checkbox, :radio, select").attr("disabled",true);inp=m.find(":text, textarea").attr("readonly",true)}catch(l){j("MakeReadOnly",l,a.Type.Error)}},InProgress:function(){return f&&f.is(":visible")},ShowProgress:function(m){try{if(m){$(m).blur()}if(!f){f=$('<div id="spinnerOverlay"></div>').appendTo("body")}f.show()}catch(l){j("ShowProgress",l,a.Type.Error)}},HideProgress:function(){try{if(f){f.hide()}}catch(l){j("HideProgress",l,a.Type.Error)}},HideMessage:function(){try{$("#ModalWindow").dialog("close")}catch(l){j("HideMessage",l,a.Type.Error)}},ShowErrorMessage:function(l,o,n,m){this.ShowMessage(l,m||800,o||"Error",null,n)},ShowMessage:function(m,o,s,l,q){try{var r=$("#ModalWindow");var n=function(u){var t=u.data("message-queue").shift();if(!t){return}u.dialog("option","width",t.width);u.dialog("option","title",t.title);u.dialog("option","overlay",{opacity:t.opacity,background:t.color});u.dialog("option","buttons",t.buttons);u.dialog("close");u.html($("<div/>").html(t.html));u.dialog("open");u.data("current-message",t)};if(!r.attr("dialoginit")){r.css("display","block");r.dialog({modal:true,autoOpen:false});r.attr("dialoginit","true");r.data("message-queue",[]);r.bind("dialogclose",function(){n(r)})}r.data("message-queue").push({html:m,width:o||960,title:s||"",opacity:l||0.5,color:"#000",buttons:q||{}});n(r)}catch(p){j("ShowMessage",p,a.Type.Error)}},ReloadStyles:function(t,u){if(!t){return}u=u||"global.css,custom.css,tablewalker.css";var o=u.split(",");var m=jsonParse(t);var v=Browser.IsFirefox()||Browser.IsChrome()||Browser.IsSafari();var s=document.styleSheets.length;for(var r=0;r<s;r++){for(var p=0;p<o.length;p++){var x=new RegExp(o[p]+"$","i");try{var l=document.styleSheets[r].href;if(l&&l.match(x)){if(v){var w=document.styleSheets[r].cssRules}else{var w=document.styleSheets[r].rules}if(w){for(var q=0;q<w.length;q++){g(w[q],m)}}break}}catch(n){a.Add("ReloadStyles",n,a.Type.Error)}}}},ShakeElement:function(l,o){o=o||10;var m=Utilities.ToNumber(l.css("left"));var n=function(){o--;if(o){var q=(o%2==0)?o:-o,p=m+q;l.css("left",p+"px");setTimeout(n,50)}else{l.css("left",m+"px")}};n()},ScrollToElement:function(l,n,o){var m=(Browser.IsChrome()||Browser.IsSafari())?"body":"html";$(m).animate({scrollTop:l.offset().top},n||500,o)},DisableHighlightingInChrome:function(l){if(!Browser.IsChrome()){return}if(l){$(document).disableSelection()}else{$(document).enableSelection()}},UpdateLastPosition:function(o,l){var m=$(document);var n=(l&&l.position)?l.position:o.parent().offset();o.data("lastTop",Utilities.ToNumber(n.top-m.scrollTop()));o.data("lastLeft",Utilities.ToNumber(n.left-m.scrollLeft()))}}}catch(k){j("Main",k,a.Type.Error)}};return d});function ReloadStyles(a,b){setTimeout(function(){if(MP.Tools.Enabled){jAlert("Please update this system to use new improved\nGlobal.ReloadStyles(jsonColorStr, cssFilesCSV);\n For details see JS release notes or contact R&D.")}},5000);Global.ReloadStyles(a,b)}define("RuleStorage",["Storage"],function(a){var b=new function(){try{var e="RuleStorage.";var d=new a();var h=new a();var c=null;function f(m,l,k,j){Log.Add(e+m,l,k,j)}this.AddComponent=function(k,j){try{c.AddComponent(k,j)}catch(l){f("AddComponent",l,Log.Type.Error)}};this.GetComponent=function(j){try{return c.GetComponent(j)}catch(k){f("GetComponent",k,Log.Type.Error)}};this.GetCount=function(){try{return c.GetCount()}catch(j){f("GetCount",j,Log.Type.Error)}};this.GetCurrentStorage=function(){try{return c}catch(j){f("GetCount",j,Log.Type.Error)}};this.GetItemArray=function(){try{return c.GetItemArray()}catch(j){f("GetItemArray",j,Log.Type.Error)}};this.Remove=function(j){try{c.Remove(j)}catch(k){f("Remove",k,Log.Type.Error)}};this.Reset=function(){try{d.Reset();h.Reset()}catch(j){f("Reset",j,Log.Type.Error)}};this.SetCurrentProcess=function(j){if(j=="preproc"){c=d}else{c=h}};this.GetStorage=function(j){if(j=="preproc"){return d}else{return h}}}catch(g){f("Main",g,Log.Type.Error)}};return b});define("IconMover",["RuleXML","RuleStorage"],function(a,c){var b=new function(){var d="IconMover.";function e(j,h,g,f){Log.Add(d+j,h,g,f)}return{Load:function(h){try{this.Ctrl=c.GetComponent(h);this.Ctrl.OldEntry=this.Ctrl.GetIcon().GetEntryPoint();this.Ctrl.OldExit=this.Ctrl.GetIcon().GetExitPoint();var f=a.GetFromComponent(h);if(f!=null){this.FromJ1=(f.GetJ1()==this.Ctrl.GetID());this.From=f.GetIcon().GetExitPoint()}if(this.Ctrl.GetJ1()!=""){f=c.GetComponent(this.Ctrl.GetJ1());this.J1=f.GetIcon().GetEntryPoint()}if((this.Ctrl.GetJ2!=null)&&(this.Ctrl.GetJ2()!="")){f=c.GetComponent(this.Ctrl.GetJ2());this.J2=f.GetIcon().GetEntryPoint()}}catch(g){e("Load",g,Log.Type.Error)}},MoveSelected:function(f,k){var h=RulesMaker.GetSelected();for(var g=0;g<h.length;g++){var j=c.GetComponent(h[g]);j.Icon.MoveBy(f,k)}},Reset:function(){this.Ctrl=null;this.From=null;this.FromJ1=null;this.J1=null;this.J2=null;this.Enabled=false},Enable:function(){this.Enabled=true},Refresh:function(){try{if(!this.Enabled){return}this.Ctrl.Icon.UpdateComment();RuleGraphics.ReDraw()}catch(f){e("Refresh",f,Log.Type.Error)}},Enabled:false,Ctrl:null,J1:null,J2:null,From:null,FromJ1:null}};return b});define("IconConnector",["ContextMenu","RuleStorage"],function(b,c){var a=new function(h){var m="IconConn.",l,e,n,k,j,f,g;function d(r,q,p,o){Log.Add(m+r,q,p,o)}return{Connecting:function(){return e},Reset:function(){l=false;e=false;n=0;k=null;j=null;if(f){b.Enabled=true;f.HighlightAsConnecting(false);f=null}g=null},CanvasClicked:function(o){try{d("CanvasClicked","Btn="+o);if(!e){return}switch(o){case 1:j=f.GetJ1();if(!j){return}g=c.GetComponent(j);this.DisConnect(f,g,f.SetJ1);break;case 3:if(!f.SetJ2){return}j=f.GetJ2();if(!j){return}g=c.GetComponent(j);this.DisConnect(f,g,f.SetJ2);break}}catch(p){d("CanvasClicked",p,Log.Type.Error)}},IconClicked:function(o,p){try{d("IconClicked","ID="+o+", Btn="+p);if(!e&&!l){return}if(!e&&l&&o){k=o;e=true;f=c.GetComponent(k);f.HighlightAsConnecting(true);b.Enabled=false;return}if(k==o){return}j=o;g=c.GetComponent(j);switch(p){case 1:if(f.SetJ1){this.Connect(f,g,f.SetJ1)}break;case 3:if(f.SetJ2){this.Connect(f,g,f.SetJ2)}break}}catch(q){d("IconClicked",q,Log.Type.Error)}},Connect:function(s,p,r){d("Connect","From: "+s.GetID()+" To: "+p.GetID());var o=p.GetID();if(s.GetJ2){var t,q;if(r==s.SetJ2){t=s.GetJ1();q=s.SetJ1}else{t=s.GetJ2();q=s.SetJ2}if(o==t){this.DisConnect(s,p,q)}}r(o);RuleGraphics.Refresh()},DisConnect:function(q,o,p){d("Disconnect","From: "+q.GetID()+" To: "+o.GetID());p("");RuleGraphics.Refresh()},KeyDown:function(p){try{l=p.which==16}catch(o){d("KeyDown",o,Log.Type.Error)}},KeyUp:function(){l=false;if(e){n++;if(n>1){a.Reset()}}}}};a.Reset();$(document).bind("keydown",a.KeyDown).bind("keyup",a.KeyUp);return a});define("RuleIcon",["IconMover","RuleStorage"],function(a,c){function b(){try{var p="RuleIcon.";var e;var q;var m=null;var h=null;var g=null;var l=null;var n=null;function d(w,u,t,r){var v="";if(m){v=m.attr("id")}if(v!=""){v=v+"."}Log.Add(v+p+w,u,t,r)}function k(){try{d("AddFeatures","Called");m.draggable({containment:"parent",grid:[32,26],start:function(){Global.DisableHighlightingInChrome(true);e=null;q=null},stop:function(){Global.DisableHighlightingInChrome(false);var t=RulesMaker.GetSelected();for(var s=0;s<t.length;s++){var x=t[s];var v=c.GetComponent(x);if(v){try{var w=v.Icon.GetImage().position();v.SetX(w.left);v.SetY(w.top);v.Icon.UpdateComment()}catch(u){d("StopDragging","Failed to update position of ID: "+x+". Reason: "+u.message,Log.Type.Error,true)}}else{d("StopDragging","Cannot locate component ID: "+x,Log.Type.Warning)}}RuleGraphics.Refresh()},drag:function(){var u=$(this);var s=u.css("left");var z=u.css("top");if((e==s)&&(q==z)){return}if(e&&q){var v=parseInt(s,10)-parseInt(e,10);var t=parseInt(z,10)-parseInt(q,10)}else{var v=null;var t=null}e=s;q=z;var w=m.attr("id");if(!RulesMaker.IsSelected(w)){RulesMaker.ClearSelected();RulesMaker.AddSelected(w)}a.MoveSelected(v,t)}})}catch(r){d("AddFeatures",r,Log.Type.Error)}}function f(){try{var v=Utilities.ToNumber(m.css("top"));var u=Utilities.ToNumber(m.css("left"));var s=Utilities.ToNumber(m.width());var r=u+parseInt(s/2,10);var A=v;return new RuleGraphics.Point(r,A)}catch(z){d("getEntryPoint",z,Log.Type.Error)}}function o(){try{var v=Utilities.ToNumber(m.css("top"));var u=Utilities.ToNumber(m.css("left"));var s=Utilities.ToNumber(m.width());var z=Utilities.ToNumber(m.height());var r=u+parseInt(s/2,10);var B=v+z;return new RuleGraphics.Point(r,B)}catch(A){d("getExitPoint",A,Log.Type.Error)}}this.Load=function(r){try{d("Load","Called");n=r;var t=n.GetID();h=$("<div class='RuleIconComment' commentid='"+t+"'>");m=$("<img/>");m.attr("src",n.Src);m.attr("id",t);m.addClass("icon");m.css("top",n.GetY());m.css("left",n.GetX());m.css("position","absolute");m.appendTo("<div/>");k()}catch(s){d("Load",s,Log.Type.Error)}};this.AppendTo=function(r){try{g=r;g.append(m);g.append(h);this.UpdateComment();this.UpdateHint()}catch(s){d("AppendTo",s,Log.Type.Error)}};this.Delete=function(){d("Delete","Called");g.find("div[commentid='"+m.attr("id")+"']").remove();m.remove()};this.GetContainer=function(){try{return g}catch(r){d("GetContainer",r,Log.Type.Error)}};this.GetEntryPoint=function(){try{return f()}catch(r){d("GetEntryPoint",r,Log.Type.Error)}};this.GetExitPoint=function(){try{return o()}catch(r){d("GetExitPoint",r,Log.Type.Error)}};this.GetImage=function(){return m};this.MoveBy=function(r,u){var t=Utilities.ToNumber(m.css("left"))+r;var s=Utilities.ToNumber(m.css("top"))+u;this.MoveTo(t,s)};this.MoveTo=function(r,s){m.css("left",r).css("top",s)};this.SetIconMover=function(r){l=r};this.UpdateComment=function(){try{h.text(n.GetID()+": "+n.GetComment());h.css("top",m.css("top")).css("left",m.css("left"))}catch(r){d("UpdateComment",r,Log.Type.Error)}};this.UpdateHint=function(){try{m.attr("title",n.GetFormatedData())}catch(r){d("UpdateHint",r,Log.Type.Error)}}}catch(j){d("Main",j,Log.Type.Error)}}return b});define("RuleHelper",["RuleIcon","RuleStorage"],function(h,g){var a={CSF:"rules/component/CompiledScriptFunction",SCRIPT:"rules/component/Script",SQLTRN:"rules/component/SqlTrn",ERROR:"rules/component/Error",EXTERNAL:"rules/component/External",IF:"rules/component/If",INSERTUPDATEQUERY:"rules/component/InsertUpdateQuery",MATH:"rules/component/Math",SELECTQUERY:"rules/component/SelectQuery",SET:"rules/component/Set",TEMPLATE:"rules/component/Template"};var e=[];var d=[];var c;for(c in a){if(Object.prototype.hasOwnProperty.call(a,c)){e.push(a[c]);d.push(c)}}var b={};require(e,function(){for(var j=0;j<d.length;++j){b[d[j]]=arguments[j]}});var f=new function(){var j="RuleHelper.";try{function l(q,p,o,n){Log.Add(j+q,p,o,n)}function k(o){try{var n=$(o).find(">t").text();n.toUpperCase();var p=b[n];var r=new p();r.Load(o);return r}catch(q){l("LoadRulesMakerComponent",q,Log.Type.Error)}}return{Search:function(t,q){var o=["preproc","postproc"];for(var s=0;s<o.length;s++){var r=g.GetStorage(o[s]);if(t){l("Search","Searching "+r.GetCount()+" "+o[s].toUpperCase()+" components for '"+t+"'",Log.Type.Debug)}else{l("Search","Clearing",Log.Type.Info)}var n=r.GetItemArray();$.each(n,function(){var p=this;try{p.Search(t,q);p.HighlightAsError(false)}catch(u){l("BadComponent",p,Log.Type.Search);p.HighlightAsError(true)}})}},LoadComponents:function(o,n){try{l("LoadComponents","Called");div=$(n);div.html("");$(o).find(">c").each(function(){var r=k(this),q=new h();r.SetX(Utilities.SnapTo(r.GetX(),32));r.SetY(Utilities.SnapTo(r.GetY(),26));q.Load(r);r.SetIcon(q);q.AppendTo(div);g.AddComponent(r,r.GetID());r.UpdateWatchpoint()})}catch(p){l("LoadComponents",p,Log.Type.Error)}},GetComponent:function(n){var o=GetStoredObject(n)},CreateComponent:function(q){try{l("CreateComponent","Called");var p=null;var n=b[q];p=new n();if(p==null){throw"The component of type '"+q+"' could not be created!"}p.Create();return p}catch(o){l("CreateComponent",o,Log.Type.Error)}},ValidatePage:function(){try{f.Search();var x=["preproc","postproc"],t=0,z=0,u=0,y=0,w=0,o=0,A="";for(var n=0;n<x.length;n++){var r=g.GetStorage(x[n]),v=r.GetItemArray();l("ValidatePage","Validating "+v.length+" "+x[n].toUpperCase()+" components",Log.Type.Debug);$.each(v,function(H,I){var B=false;if($.inArray(I.Type,["SELECTQUERY","INSERTUPDATEQUERY"])>-1){var p=I.GetQuery();if(/#S/.test(p)&&!/#SCONST_QUERY#/i.test(p)){t++;B=true;l(I.GetID()+".NoParam",I,Log.Type.Search)}if(!/\bDELETE\b/i.test(p)){var F=p.match(/\bFROM\b/ig)||[],E=p.match(/\bJOIN\b/ig)||[],C=p.match(/\bNOLOCK\b/ig)||[];if(C.length!=(F.length+E.length)){z++;B=true;l(I.GetID()+".NoLock",I,Log.Type.Search)}}}if(I.Type=="IF"){if(!I.GetJ1()||!I.GetJ2()){y++;B=true;l(I.GetID()+".BadConnection",I,Log.Type.Search)}}if($.inArray(I.Type,["ERROR","TEMPLATE"])>-1){if(I.GetJ1()){y++;B=true;l(I.GetID()+".BadConnection",I,Log.Type.Search)}}if(I.GetWatchpoint()){o++;l(I.GetID()+".WatchpointSet",I,Log.Type.Search)}var G=false,s=I.GetID();for(var D=0;D<v.length;D++){if(v[D]==I){continue}if(v[D].GetJ1()==s||v[D].GetJ2&&v[D].GetJ2()==s){G=true;break}}if(!G){w++;B=true;l(I.GetID()+".NotConnected",I,Log.Type.Search)}I.HighlightAsError(B)})}if(t){A+="Missing parameters: "+t+"<br>"}if(z){A+="Missing NOLOCK in queries: "+z+"<br>"}if(y){A+="Wrong connections: "+y+"<br>"}if(w>2){A+="Not connected: "+parseInt(w-2)+"<br>"}if(o){A+="Watch points set: "+o+"<br>"}if(A){l("ValidatePage","Discovered "+parseInt(t+z+y+w+o)+" possible problems!",Log.Type.Debug)}}catch(q){l("ValidatePage",q,Log.Type.Error)}return A},ComponentTypes:b}}catch(m){l("Main",m,Log.Type.Error)}};return f});define("Undo",[],function(){var a=new function(){var c="Undo.";var e=new Array();var b=new Array();function d(j,h,g,f){Log.Add(c+j,h,g,f)}return{Add:function(f){e.push(f)},CanRedo:function(){return b.length>0},CanUndo:function(){return e.length>0},Redo:function(){try{var g=b.pop();if(g==null){return}e.push(g);g.Redo()}catch(f){d("Redo",f,Log.Type.Error)}},Reset:function(){e.reset();b.reset()},Undo:function(){try{var g=e.pop();if(g==null){return}b.push(g);g.Undo()}catch(f){d("Undo",f,Log.Type.Error)}}}};return a});define("UndoObject",[],function(){function a(){var c="UndoObj.";var f=null;var d=null;var g=null;var b=null;function e(l,k,j,h){Log.Add(c+l,k,j,h)}this.AddRedo=function(h,j){g=h;b=j};this.AddUndo=function(j,h){f=j;d=h};this.Redo=function(){try{g(b)}catch(h){e("Redo",h,Log.Type.Error)}};this.Undo=function(){try{f(d)}catch(h){e("Undo",h,Log.Type.Error)}}}return a});define("RulesMaker",["RuleHelper","RuleStorage","RuleXML","ContextMenu","ContextMenuItems","Undo","UndoObject","Editor","RuleIcon"],function(b,f,h,k,j,c,e,g,d){var a=new function(){try{var A="RulesMaker.";var p=null;var o=null;var z=null;var w=new Array();var n="";var v=null;var s=null;function m(E,D,C,B){Log.Add(A+E,D,C,B)}function y(C){try{m("AddFeatures","Called")}catch(B){m("AddFeatures",B,Log.Type.Error)}}function x(C){try{m("RemoveFeatures","Called");C=$(C)}catch(B){m("RemoveFeatures",B,Log.Type.Error)}}function u(B){return b.CreateComponent(B)}function l(){try{m("InitRuleToolbar","Called");v=$("#RuleToolbar");v.draggable({cancel:"img",start:function(E,F){Global.DisableHighlightingInChrome(true)},stop:function(E,F){Global.DisableHighlightingInChrome(false);Global.UpdateLastPosition(v,F)}}).resizable({start:function(E,F){Global.DisableHighlightingInChrome(true)},stop:function(E,F){Global.DisableHighlightingInChrome(false)}}).disableSelection().hide();var B=MP.Tools.Config.Editor.toolBars.process;v.css("left",B.position.left+"px").css("top",B.position.top+"px").data("lastLeft",B.position.left).data("lastTop",B.position.top);if(B.width){v.css("width",B.width+"px")}var C=[];v.find("img[ref]").each(function(){var F=$(this).attr("ref");var E=b.ComponentTypes[F];var G=new E();$(this).attr("title",G.Title+"\n\n"+G.ToolTip).attr("draggable",false).draggable({helper:"clone",start:function(){Global.DisableHighlightingInChrome(true)},stop:function(){Global.DisableHighlightingInChrome(false)}});C.push(F)});$("#preproc, #postproc").droppable({accept:g.GetAcceptedComponents(C),greedy:true,activeClass:"droppable-active",hoverClass:"droppable-hover",drop:function(E,F){var G={left:F.offset.left-$(this).offset().left,top:F.offset.top-$(this).offset().top};a.AddComponent($(F.draggable),G)}});$(window).bind("scroll.RuleToolBar",function(){if(v.is(":visible")){v.css("top",(v.data("lastTop")+$(document).scrollTop())+"px")}})}catch(D){m("InitRuleToolbar",D,Log.Type.Error)}}function r(){try{m("InitCompToolbar","Called");s=$("#ComponentToolbar");s.draggable({cancel:"img",start:function(D,E){Global.DisableHighlightingInChrome(true)},stop:function(D,E){Global.DisableHighlightingInChrome(false);Global.UpdateLastPosition(s,E)}}).resizable({start:function(D,E){Global.DisableHighlightingInChrome(true)},stop:function(D,E){Global.DisableHighlightingInChrome(false)}}).disableSelection().hide();var B=MP.Tools.Config.Editor.toolBars.page;s.css("left",B.position.left+"px").css("top",B.position.top+"px").data("lastLeft",B.position.left).data("lastTop",B.position.top);if(B.width){s.css("width",B.width+"px")}s.find("img[ref]").each(function(){$(this).attr("draggable",false).draggable({helper:"clone",start:function(){Global.DisableHighlightingInChrome(true)},stop:function(){Global.DisableHighlightingInChrome(false)}})});$(window).bind("scroll.CompToolBar",function(){if(s.is(":visible")){s.css("top",(s.data("lastTop")+$(document).scrollTop())+"px")}})}catch(C){m("InitCompToolbar",C,Log.Type.Error)}}function q(){try{var B=new j();var C;C=B.Add("Copy >");B.Add("Quick",function(){a.CopyToBrowser(false)},C);if(Browser.IsMSIE()){B.Add("Clipboard",function(){a.CopyToClipboard(false)},C)}B.Add("Export",function(){a.CopyToTextarea(false)},C);C=B.Add("Cut >");B.Add("Quick",function(){a.CopyToBrowser(true)},C);if(Browser.IsMSIE()){B.Add("Clipboard",function(){a.CopyToClipboard(true)},C)}B.Add("Export",function(){a.CopyToTextarea(true)},C);C=B.Add("Paste >");B.Add("Quick",function(){a.PasteFromBrowser()},C);if(Browser.IsMSIE()){B.Add("Clipboard",function(){a.PasteFromClipboard()},C)}B.Add("Import",function(){a.PasteFromTextarea()},C);C=B.Add("Select >");B.Add("All",function(){a.Select("all")},C);B.Add("Below",function(){a.Select("below")},C);B.Add("Right",function(){a.Select("right")},C);B.Add("Above",function(){a.Select("above")},C);B.Add("Left",function(){a.Select("left")},C);C=B.Add("Component >");B.Add("Delete",function(){a.DeleteSelected()},C);B.Add("Disconnect",function(){a.DisconnectSelected()},C);B.Add("Snap to Grid",function(){a.SnapToGrid()},C);C=B.Add("Search >");B.Add("Search...",function(){g.Search()},C);B.Add("Clear",function(){g.ClearSearch()},C);C=B.Add("Watch Points >");B.Add("Set",function(){a.SetWatchpoints(true)},C);B.Add("Clear",function(){a.SetWatchpoints(false)},C);B.Add("Clear All",function(){a.ClearWatchpoints()},C);C=B.Add("File >");if(g.Enabled&&!g.LockedBy){B.Add("Quick Save",function(){PropertyEd.QuickSave()},C);B.Add("Save & Exit",function(){PropertyEd.Save()},C)}B.Add("Exit...",function(){PropertyEd.Disable()},C);return B.GetHTML()}catch(D){m("MakeContextMenu",D,Log.Type.Error)}}return{Initialized:false,CurrentProcess:"",DeleteComponent:function(){m("DeleteComponent","Called");if(z==null){return}var B=f.GetComponent(z);B.Delete();B=null;h.DeleteComponent(z);f.Remove(z);z=null;RuleGraphics.Refresh()},AddComponent:function(D,B){try{m("AddComponent","Called");var C=$(D).attr("ref");var G=u(C);G.SetX(Utilities.SnapTo(B.left,32));G.SetY(Utilities.SnapTo(B.top,26));h.AddComponent(G.GetNode());var E=new d();E.Load(G);E.AppendTo($("#"+h.CurrentProcess));G.SetIcon(E);f.AddComponent(G,G.GetID())}catch(F){m("AddComponent",F,Log.Type.Error)}},Enable:function(){try{m("Enable","Called");y(p);y(o);if(g.Enabled&&!g.LockedBy){this.ToggleToolbar(v,true);this.ToggleToolbar(s,true)}}catch(B){m("Enable",B,Log.Type.Error)}},Disable:function(){try{m("Disable","Called");this.ToggleToolbar(v,false);this.ToggleToolbar(s,false);x(p);x(o);f.Reset();p.html("");o.html("");RuleGraphics.ClearGraphics()}catch(B){m("Disable",B,Log.Type.Error)}},ToggleToolbar:function(C,B){try{m("ToggleToolbar","Called");if(B){C.show()}else{C.hide()}}catch(D){m("ToggleToolbar",D,Log.Type.Error)}},GetCurrentComponent:function(){return f.GetComponent(z)},HandleServerError:function(H,B,F){try{if(H&&B){m("HandleServerError","Could not compile "+B,Log.Type.Error,true);var C=H.toLowerCase();C=C.replace(/process/,"proc");a.ShowProcessTab(C);var E=null;var I=B.split("_").pop();var G=f.GetComponent(I);if(G){G.HighlightAsError(true);E={Close:function(){$(this).dialog("close")},"Jump To The Component":function(){$(this).dialog("close");if(G){var J=G.Icon.GetImage();Global.ScrollToElement(J,null,function(){Global.ShakeElement(J)})}}}}}else{m("HandleServerError",F,Log.Type.Error,true)}Global.ShowErrorMessage(F,"Compile Error",E)}catch(D){m("HandleServerError",D,Log.Type.Error)}},Initialize:function(E,F){try{if(this.Initialized){return}m("Initialize","Called");p=$(E);o=$(F);var C=p.attr("id");var B=o.attr("id");RuleGraphics.Initialize(C,B);this.ShowProcessTab(C);l();r();this.Initialized=true}catch(D){m("Initialize",D,Log.Type.Error)}},EnsureSelection:function(B){if(!w.length){this.AddSelected(B)}},SelectThisOnlyIfNotSelected:function(B){if(!this.IsSelected(B)){this.ClearSelected();this.AddSelected(B)}},IsSelected:function(B){return(B&&$.inArray(B,w)>-1)},AddSelected:function(C){if(!C){return}if(Utilities.IsNumber(C)){C=C.toString()}if(this.IsSelected(C)){return}var B=f.GetComponent(C);if(!B){return}B.HighlightAsFound(false);B.HighlightAsError(false);B.HighlightAsWatchpoint(false);B.HighlightAsSelected(true);w.push(C)},Select:function(C){try{m("SelectPart","Called");a.ClearSelected();var B=f.GetItemArray();for(var D=0;D<B.length;D++){var F=B[D],G=false;switch(C){case"all":G=true;break;case"below":G=F.GetY()>k.OffsetY;break;case"right":G=F.GetX()>k.OffsetX;break;case"above":G=F.GetY()<k.OffsetY;break;case"left":G=F.GetX()<k.OffsetX;break}if(G){a.AddSelected(F.GetID())}}}catch(E){m("SelectPart",E,Log.Type.Error)}},ClearSelected:function(){try{m("ClearSelected","Called");var B=f.GetItemArray();for(var C=0;C<B.length;C++){var E=B[C];E.HighlightAsSelected(false)}w=null;w=[]}catch(D){m("ClearSelected",D,Log.Type.Error)}},GetSelectedComponentsXmlString:function(){try{m("GetSelectedComponentsXmlString","Called");if(w.length==0){w.push($(k.EventComponent).attr("id"))}var C="";for(var B=0;B<w.length;B++){var E=w[B];C+=h.GetComponent(E)}return C}catch(D){m("GetSelectedComponentsXmlString",D,Log.Type.Error)}},AddComponentsFromXmlString:function(I){try{m("AddComponentsFromXmlString","Called");I=Utilities.Trim(I);if(!((I)&&(I.substring(0,3)=="<c>")&&(I.substring(I.length-4)=="</c>"))){return}n=I;I=$(Utilities.ParseXML("<str>"+I+"</str>"));var C=I.find("str>c>n");var K=10000000;C.each(function(){var M=parseInt($(this).text(),10);K=M<K?M:K});var L=h.GetNextComponentNumber()-K;var J=k.OffsetX;var H=k.OffsetY;var E=0,D=10000000;var B=[];C.each(function(){var M=parseInt($(this).text(),10)+L;$(this).text(M);B.push(M);var N=$(this).parent();var R=N.find(">x");var P=N.find(">y");var Q=parseInt(R.text());var O=parseInt(P.text());if(O<D){E=Q;D=O}});C.each(function(){var N=$(this).parent();var S=N.find(">x");var P=N.find(">y");var R=parseInt(S.text());var O=parseInt(P.text());var M=R-E+J;var Q=O-D+H;M=Utilities.SnapTo(M,32);Q=Utilities.SnapTo(Q,26);S.text(M);P.text(Q)});I.find("str>c>j").each(function(){var M;var N=parseInt($(this).text(),10);if(isNaN(N)){M=0}else{M=N+L}if($.inArray(M,B)>-1){$(this).text(M)}else{$(this).text("")}});h.AppendXML(I.find("str>c"));a.Load(h.GetVRM());a.ClearSelected();for(var G=0;G<B.length;G++){a.AddSelected(B[G])}}catch(F){m("AddComponentsFromXmlString",F,Log.Type.Error)}},CopyToBrowser:function(C){try{m("CopyToBrowser","Called");n=a.GetSelectedComponentsXmlString();if(n&&C){a.DeleteSelected()}}catch(B){m("CopyToBrowser",B,Log.Type.Error)}},PasteFromBrowser:function(){try{m("PasteFromBrowser","Called");a.AddComponentsFromXmlString(n)}catch(B){m("PasteFromBrowser",B,Log.Type.Error)}},CopyToClipboard:function(C){try{m("CopyToClipboard","Called");n=a.GetSelectedComponentsXmlString();Global.SetClipboard(n);if(n&&C){a.DeleteSelected()}}catch(B){m("CopyToClipboard",B,Log.Type.Error)}},PasteFromClipboard:function(){try{m("PasteFromClipboard","Called");var B=Global.GetClipboard();a.AddComponentsFromXmlString(B)}catch(C){m("PasteFromClipboard",C,Log.Type.Error)}},CopyToTextarea:function(C){try{m("CopyToTextarea","Called");n=a.GetSelectedComponentsXmlString();if(n&&C){a.DeleteSelected()}g.ShowTextareaForm(n)}catch(B){m("CopyToTextarea",B,Log.Type.Error)}},PasteFromTextarea:function(){try{m("PasteFromTextarea","Called");g.ShowTextareaForm("",function(C){a.AddComponentsFromXmlString(C)})}catch(B){m("PasteFromTextarea",B,Log.Type.Error)}},DeleteSelected:function(){try{m("DeleteSelected","Called");if(!w.length){w.push($(k.EventComponent).attr("id"))}for(var B=0;B<w.length;B++){var E=w[B];var D=f.GetComponent(E);if(D){D.Delete();D=null;h.DeleteComponent(E);f.Remove(E)}}a.ClearSelected();RuleGraphics.Refresh()}catch(C){m("DeleteSelected",C,Log.Type.Error)}},DisconnectSelected:function(){try{m("DisconnectSelected","Called");if(!w.length){w.push($(k.EventComponent).attr("id"))}for(var B=0;B<w.length;B++){var E=w[B];var D=f.GetComponent(E);if(D){if(D.SetJ1){D.SetJ1("")}if(D.SetJ2){D.SetJ2("")}}}RuleGraphics.Refresh()}catch(C){m("DisconnectSelected",C,Log.Type.Error)}},SnapToGrid:function(){try{m("SnapToGrid","Called");if(w.length==0){w.push($(k.EventComponent).attr("id"))}for(var E=0;E<w.length;E++){var I=w[E];var H=f.GetComponent(I);if(!H){continue}var F,D,C,B;F=H.GetX();D=Utilities.SnapTo(F,32);H.SetX(D);C=D-F;F=H.GetY();D=Utilities.SnapTo(F,26);H.SetY(D);B=D-F;H.Icon.MoveBy(C,B)}RuleGraphics.Refresh()}catch(G){m("SnapToGrid",G,Log.Type.Error)}},SetWatchpoints:function(E){try{m("SetWatchpoints","Called");if(w.length==0){w.push($(k.EventComponent).attr("id"))}for(var B=0;B<w.length;B++){var F=w[B];var D=f.GetComponent(F);if(D){D.SetWatchpoint(E)}}}catch(C){m("SetWatchpoints",C,Log.Type.Error)}},ClearWatchpoints:function(){try{m("ClearWatchpoints","Called");var B=f.GetItemArray();for(var C=0;C<B.length;C++){var E=B[C];E.SetWatchpoint(false);E.UpdateWatchpoint()}}catch(D){m("ClearWatchpoints",D,Log.Type.Error)}},AdjustCanvasHeight:function(){try{m("AdjustCanvasHeight","Called");var F=0;var B=f.GetItemArray();for(var C=0;C<B.length;C++){var E=B[C];var G=E.GetY();F=G>F?G:F}F=Utilities.SnapTo(F,100)+500;a.SetCanvasHeight(F)}catch(D){m("AdjustCanvasHeight",D,Log.Type.Error)}},GetSelected:function(){return w},Load:function(C){try{m("Load","Called");if(typeof C=="string"){C=Utilities.ParseXML(C)}h.Load(C);f.Reset();var B=a.CurrentProcess||"preproc";var E;a.SetCurrentProcess("preproc");E=a.CurrentProcess;b.LoadComponents(h.GetPreProcessXML(),p);k.Add("#"+E,q,E+"canvas");a.AdjustCanvasHeight();a.SetCurrentProcess("postproc");E=a.CurrentProcess;b.LoadComponents(h.GetPostProcessXML(),o);k.Add("#"+E,q,E+"canvas");a.AdjustCanvasHeight();a.SetCurrentProcess(B);a.Enable()}catch(D){m("Load",D,Log.Type.Error)}},Save:function(){try{m("Save","Called");Communication.EditorUpdate(false)}catch(B){m("Save",B,Log.Type.Error)}},GetCanvasHeight:function(){try{m("GetCanvasHeight","Called");if(a.CurrentProcess=="preproc"){return Utilities.ToNumber(p.css("height"))}else{return Utilities.ToNumber(o.css("height"))}}catch(B){m("GetCanvasHeight",B,Log.Type.Error)}},SetCanvasHeight:function(D){try{m("SetCanvasHeight","Called");var C=a.CurrentProcess=="preproc"?p:o;var B=D||Utilities.ToNumber(C.css("height"))+MP.Tools.Config.Editor.tabs.process.extendBy;C.css("height",B);$("#"+a.CurrentProcess+"canvas").css("height",B);RuleGraphics.Refresh()}catch(E){m("SetCanvasHeight",E,Log.Type.Error)}},ShowProcessTab:function(C){var B=C.replace(/proc/,"link");$("#"+B).click()},SetCurrentProcess:function(C){try{a.CurrentProcess=C;h.CurrentProcess=C;RuleGraphics.SetCurrentProcess(C);f.SetCurrentProcess(C)}catch(B){m("SetCurrentProcess",B,Log.Type.Error)}},ShowProperties:function(B){try{m("ShowProperties","Called");var E=f.GetComponent(B);if(E==null){return}var C=E.GetProperties();PropertyEd.Show(C,this.DeleteComponent,E.Title);z=B}catch(D){m("ShowProperties",D,Log.Type.Error)}},RefreshProperties:function(){try{this.ShowProperties(z)}catch(B){m("RefreshProperties",B,Log.Type.Error)}},ComplexArgs:function(C,D,B){this.GetProperties=C;this.AddParam=D;this.DeleteParam=B}}}catch(t){m("Main",t,Log.Type.Error)}};return a});define("RuleGraphics",["IconMover","RuleStorage","RulesMaker","RuleXML"],function(d,e,c,a){var b=new function(){var t="Graphics.";var m=null;var n=null;var o=null;var s="#61AEF1";var r="#9B9B9B";var k=false;function f(x,w,v,u){Log.Add(t+x,w,v,u)}function p(G,u){try{k=false;if(u!=null){o.setColor(u)}o.setStroke(2);var C=10;var A=C;var B=4;for(var z=0;z<G.length;z++){var w=G[z];if(w.Color!=null){o.setColor(w.Color)}o.drawLine(w.Start.X,w.Start.Y,w.Start.X,w.Start.Y+C);var D=(w.Stop.X-w.Start.X)/2;if((D==0)&&(w.Stop.Y<=w.Start.Y)){D=-20}o.drawLine(w.Start.X,w.Start.Y+C,w.Start.X+D,w.Start.Y+C);o.drawLine(w.Start.X+D,w.Start.Y+C,w.Start.X+D,w.Stop.Y-C);o.drawLine(w.Start.X+D,w.Stop.Y-C,w.Stop.X,w.Stop.Y-C);o.drawLine(w.Stop.X,w.Stop.Y-C,w.Stop.X,w.Stop.Y);var F=[w.Stop.X,w.Stop.X-B,w.Stop.X+B,w.Stop.X];var E=[w.Stop.Y,w.Stop.Y-B,w.Stop.Y-B,w.Stop.Y];o.fillPolygon(F,E)}}catch(v){f("DrawLines",v,Log.Type.Error)}}function q(E,u){try{if(u!=null){o.setColor(u)}o.setStroke(2);var C=10;var A=C;var B=4;for(var z=0;z<E.length;z++){var w=E[z];if(w.Color!=null){o.setColor(w.Color)}o.drawLine(w.Start.X,w.Start.Y,w.Start.X,w.Start.Y+C);o.drawLine(w.Start.X,w.Start.Y+C,w.Stop.X,w.Stop.Y-C);o.drawLine(w.Stop.X,w.Stop.Y-C,w.Stop.X,w.Stop.Y-B);var F=[w.Stop.X,w.Stop.X-B,w.Stop.X+B,w.Stop.X];var D=[w.Stop.Y,w.Stop.Y-B,w.Stop.Y-B,w.Stop.Y];o.fillPolygon(F,D)}}catch(v){f("DiagonalDrawLines",v,Log.Type.Error)}}function l(u){try{var w=new jsGraphics(u+"canvas");w.clear();return w}catch(v){f("PrepareCanvas",v,Log.Type.Error)}}function h(v){try{if(v==null||v==""){return}var u=$("#"+v);var w=$("#"+v+"canvas");if(w.height()==null){return}u.css("margin-top",(Utilities.ToNumber(w.height())*-1))}catch(x){f("AlignCanvas",x,Log.Type.Error)}}function g(w,A){try{if(!w.GetJ1){return}var v=new Array();v[0]=w.GetJ1();if(w.GetJ2!=null){v[1]=w.GetJ2()}for(i=0;i<2;i++){if(v[i]!=""){var z=e.GetComponent(parseInt(v[i],10));if(z!=null){var B=w.GetIcon().GetExitPoint();var x=z.GetIcon().GetEntryPoint();var u=(i==0?s:r);A[A.length]=new j(B,x,u)}}}}catch(y){f("GetLines",y,Log.Type.Error)}}function j(v,u,w){this.Start=v;this.Stop=u;this.Color=w}return{ClearGraphics:function(){try{m.clear();n.clear();k=true}catch(u){f("ClearGraphics",u,Log.Type.Error)}},Initialize:function(v,u){try{f("Initialize","Called");m=l(v);n=l(u)}catch(w){f("Initialize",w,Log.Type.Error)}},Point:function(v,u){this.X=v;this.Y=u},ReDraw:function(){try{if(c.GetSelected().length>0){if(!k){b.ClearGraphics()}return}var x=d.Ctrl;var w=new Array();var u=0;var y;if(d.From!=null){y=(d.FromJ1?s:r);w[u]=new j(d.From,x.OldEntry);u++}if(d.J1!=null){w[u]=new j(x.OldExit,d.J1);u++}if(d.J2!=null){w[u]=new j(x.OldExit,d.J2);u++}p(w,"white");x.OldEntry=x.GetIcon().GetEntryPoint();x.OldExit=x.GetIcon().GetExitPoint();w.length=0;u=0;if(d.From!=null){y=(d.FromJ1?s:r);w[u]=new j(d.From,x.OldEntry,y);u++}if(d.J1!=null){w[u]=new j(x.OldExit,d.J1,s);u++}if(d.J2!=null){w[u]=new j(x.OldExit,d.J2,r);u++}p(w);o.paint()}catch(v){f("ReDraw",v,Log.Type.Error)}},Refresh:function(){try{if(o==null){f("Refresh","Attempting to refresh a null canvas",Log.Type.Warning);return}if(a.CurrentProcess==null||a.CurrentProcess==""){return}h(a.CurrentProcess);o.clear();var v=new Array();$("#"+a.CurrentProcess).find(".icon").each(function(){var x=$(this).attr("id");var w=e.GetComponent(x);g(w,v)});p(v);o.paint()}catch(u){f("Refresh",u,Log.Type.Error)}},SetCurrentProcess:function(v){try{if(v=="preproc"){o=m}else{o=n}setTimeout("RuleGraphics.Refresh()",100)}catch(u){f("SetCurrentProcess",u,Log.Type.Error)}}}};return b});define("AddressStandardization",["Communication"],function(g){$("head").append("<style>.address-suggestion-dialog {    text-align: left;}.address-suggestion-dialog .suggestions {    margin: 1em 0;}.address-suggestion-dialog .suggestions .suggestion {    border: 1px solid #4444FF;    margin: .5em;    padding: .75em;    float: left;    cursor: pointer;}.address-suggestion-dialog .suggestions .suggestion:hover {    background-color: #E2E2FF;}.address-suggestion-dialog .manual-entry {    margin: 1em .5em 0 .5em;}</style>");var e=function(j){if(j instanceof $){return j}else{return $("*[name="+j+"]")}};var d=function(k){var j={};$.each(k,function(l,m){j[l]=e(m)});return j};var c=function(j){j=d(j);var k={};$.each(j,function(m,l){if($.trim(l.val()).length>0){k[m]=l.val()}});return k};var h=function(j,k){j=d(j);$.each(j,function(m,l){if(k[m]){l.val(k[m])}})};var b=function(j,l){j=d(j);var k=c(j);a(k,function(m,n){var o=function(){if(j.Address1){j.Address1.focus()}};if(m){o();return l(m)}if(n){h(j,n);return l(null,true)}else{o();return l(null,false)}})};var a=function(j,k){g.CustomRequest("ZP4Sugestion.max?"+$.param({AJAX_ACTION:"GetZP4",Address_IN:j.Address1,City_IN:j.City,State_IN:j.State,Zip_IN:j.Zip}),function(t){var m=jsonParse(t);if(m.Valid=="1"){return k(null,{Address1:m.Address_OUT,City:m.City_OUT,State:m.State_OUT,Zip:m.Zip_OUT})}if(m.SugCnt=="0"){return k("Invalid address")}var r=[];var p;for(p=0;p<m.SugCnt;++p){r.push({Address1:m["A_"+p],City:m["C_"+p],State:m["S_"+p],Zip:m["Z_"+p]})}var s=function(v,y){var x=["Address1","City","State","Zip"];var w;for(w=0;w<x.length;++w){if(v[x[w]]!==y[x[w]]){return false}}return true};var p;for(p=0;p<r.length;++p){if(s(r[p],j)){return k(null,r[p])}}var q="";q+="<p>Please select one of the following addresses or change your entered address manually:</p>";q+='<div class="suggestions"></div>';q+='<p><button class="manual-entry">Change Address Manually</button></p>';var l=$("<div/>").addClass("address-suggestion-dialog").html(q);var o=l.find(".suggestions");var u=l.find(".manual-entry");var n=function(v){return $("<span/>").text(v).html()};$.each(r,function(x,w){var v=$("<address/>").addClass("suggestion").data("suggestion-data",w).html("");v.append(n(w.Address1)).append("<br/>").append(n(w.City)).append(", ").append(n(w.State)).append(" ").append(n(w.Zip));o.append(v)});$(".suggestion",o).click(function(){l.dialog("destroy");var v=$(this).data("suggestion-data");k(null,v)});u.click(function(){l.dialog("destroy");k(null,null)});l.dialog({title:"Address Suggestions",autoOpen:true,width:420})},null)};var f=function(j,l){if(j.length===0){return l(null,true)}var k=j[0];b(k,function(n,m){if(n){return l(n)}if(!m){return l(null,false)}f(j.slice(1),l)})};return{checkFullAddress:b,checkFullAddresses:f,checkAddress:a,getAddressValues:c,setAddressValues:h,getAddressElements:d}});define("main",[],function(){require(["MP","Log","Browser","PropertyEd","Communication","Utilities","Helper","Global","RulesMaker","RuleGraphics","AddressStandardization","ValidatorContainer","ReqList","WatchList","AjaxTab","../ckeditor/ckeditor"],function(){var a=[{n:"MP",f:false},{n:"Log",f:true},{n:"Browser",f:true},{n:"PropertyEd",f:false},{n:"Communication",f:true},{n:"Utilities",f:true},{n:"Helper",f:true},{n:"Global",f:true},{n:"RulesMaker",f:true},{n:"RuleGraphics",f:false},{n:"AddressStandardization",f:false},{n:"Validator",f:true},{n:"ReqList",f:true},{n:"WatchList",f:true},{n:"AjaxTab",f:true},{n:"ckeditor",f:false}];$.each(arguments,function(b,e){var d=a[b];if(d){window[d.n]=e;try{if(d.f){Object.preventExtensions(e)}}catch(c){}}});$(document).ready(function(f){try{Log.Add("main.ready","Adding plugins into jQuery "+f().jquery);f.fn.outerHTML=function(){try{if(this[0].outerHTML){return this[0].outerHTML}return f("<div>").append(this.eq(0).clone(true)).html()}catch(j){Log.Add("jQuery.fn.outerHTML",j,Log.Type.Error)}};var c=f.fn.outerHTML;f.fn.formOuterHTML=function(){if(arguments.length){return c.apply(this,arguments)}f("input,button",this).each(function(){this.setAttribute("value",this.value)});f("textarea",this).each(function(){f(this).text(this.value)});return c.apply(this)};var b=f.fn.html;f.fn.formHTML=function(){if(arguments.length){return b.apply(this,arguments)}f("input,button",this).each(function(){this.setAttribute("value",this.value)});f("textarea",this).each(function(){f(this).text(this.value)});return b.apply(this)};f.expr[":"].focus=function(j){return j===document.activeElement&&(j.type||j.href)};var e=location.href;if(e.indexOf("sessionexpired=true")>-1){Global.ShowErrorMessage(f("<h3>Your session has expired</h3><p>Due to inactivity on the system your session has expired. Please login to start a new session.</p>"))}var g=function(){var j=f(this).attr("status")=="0"?"1":"0";Communication.CustomRequest("IconTray.max?status="+j+"&action=tooltips",function(l){var m=f(l);var k=f("#TooltipIcon");k.attr("alt",m.attr("alt"));k.attr("status",m.attr("status"));k.attr("src",m.attr("src"));Global.Tooltips(k.attr("status")=="1")},null)};f(document).delegate("#TooltipIcon","click",function(){f(document).undelegate("#TooltipIcon");var j=f(this);j.bind("click",g);j.click()});if(window.$Spelling){window.$Spelling.ServerModel="php"}if(!window.GlobalScript){window.GlobalScript={Origin:"Internal",OnLoad:function(){}}}var h=MP.Events.onMpCoreLoaded||f.noop;h()}catch(d){Log.Add("main.ready",d,Log.Type.Error)}})})});define("TransferList",["TemplateBase","Utilities","PageHelper","Editor"],function(d,c,e,b){function a(){try{this.inheritFrom=d;this.inheritFrom();this.NameRequired=true;this.refClassName="TrfList";var s=this;var l=$("<div ref='TransferList' />");var g=null;var q=null;var o=null;var n=null;var t=null;var p=null;var r=null;var m=false;function f(x,w,v,u){s.Log(s.refClassName+"."+x,w,v,u)}function k(){try{if(m){return}f("AddFeatures","Called");m=true}catch(u){f("AddFeatures",u,Log.Type.Error)}}function j(){try{if(!m){return}f("RemoveFeatures","Called");m=false}catch(u){f("RemoveFeatures",u,Log.Type.Error)}}this.SetFeatures=function(u){m=u};this.AppendTo=function(u){try{f("AppendTo","Called");g.AppendTo(u);g.SetHeight("270");var z=g.GetControl();var w=$(z).parent().css("width");if(w){z.css("width",(parseInt(w)-10)+"px")}else{z.css("width","840px")}z.attr("transferlist","");q.AppendTo(z);o.AppendTo(z);var v=[q,o];for(var x=0;x<v.length;x++){switch(x){case 0:v[x].SetLeft("5");break;case 1:v[x].SetLeft("490");break}v[x].SetTop("5");v[x].SetWidth("336");v[x].SetMultiSelect(true);v[x].SetSize("12");v[x].SetCaption("List "+(x+1))}t.AppendTo(z);t.SetLeft("347");t.SetTop("15");t.SetWidth("126");t.SetCaption("Move Selected -->");var A=new Object();A.Name="click";A.Body="TransferListHelper.MoveSelectedRight(this)";t.SetFunctions([A]);n.AppendTo(z);n.SetLeft("347");n.SetTop("43");n.SetWidth("126");n.SetCaption("<-- Move Selected");A.Body="TransferListHelper.MoveSelectedLeft(this)";n.SetFunctions([A]);p.AppendTo(z);p.SetLeft("347");p.SetTop("81");p.SetWidth("126");p.SetCaption("<-- Move All");A.Body="TransferListHelper.MoveAllLeft(this)";p.SetFunctions([A]);r.AppendTo(z);r.SetLeft("347");r.SetTop("109");r.SetWidth("126");r.SetCaption("Move All -->");A.Body="TransferListHelper.MoveAllRight(this)";r.SetFunctions([A]);this.BaseLoad2(z);if(b.Enabled){this.EditMode()}}catch(y){f("AppendTo",y,Log.Type.Error)}};this.Create=function(u){try{f("Create","Called");g=e.CreateEditorComponent("StaticContainer");q=e.CreateEditorComponent("EditorDropDown",u+"_ListLeft");o=e.CreateEditorComponent("EditorDropDown",u+"_ListRight");n=e.CreateEditorComponent("EditorSubmitButton",u+"_MoveSelectedLeft");t=e.CreateEditorComponent("EditorSubmitButton",u+"_MoveSelectedRight");p=e.CreateEditorComponent("EditorSubmitButton",u+"_MoveAllLeft");r=e.CreateEditorComponent("EditorSubmitButton",u+"_MoveAllRight")}catch(v){f("Create",v,Log.Type.Error)}};this.Refresh=function(){try{f("Refresh","Called")}catch(u){f("Refresh",u,Log.Type.Error)}};this.DefaultMode=function(){try{f("DefaultMode","Called");j();e.RemoveComponentID(l)}catch(u){f("DefaultMode",u,Log.Type.Error)}};this.EditMode=function(){try{f("EditMode","Called");k()}catch(u){f("EditMode",u,Log.Type.Error)}};this.GetControl=function(){try{return l}catch(u){f("GetControl",u,Log.Type.Error)}}}catch(h){f("Main",h,Log.Type.Error)}}return a});define("EditorSubmitButton",["TemplateBase","PropertyFields","Utilities","PageHelper","Editor"],function(e,a,d,f,b){function c(){try{this.inheritFrom=e;this.inheritFrom();this.NameRequired=true;this.refClassName="EdSubmitBtn";var p=this;var j=null;var n=false;var o=null;function g(t,s,r,q){p.Log(p.refClassName+"."+t,s,r,q)}function m(){try{g("ResizeControl","Called");var r=o.outerWidth();var q=o.outerHeight();r=r+d.ToNumber(j.css("padding-left"))+d.ToNumber(j.css("padding-right"))+d.ToNumber(j.css("border-left-width"))+d.ToNumber(j.css("border-right-width"));q=q+d.ToNumber(j.css("padding-top"))+d.ToNumber(j.css("padding-bottom"))+d.ToNumber(j.css("border-top-width"))+d.ToNumber(j.css("border-bottom-width"));j.css("width",r);j.css("height",q)}catch(s){g("ResizeControl",s,Log.Type.Error)}}function l(){try{if(n){return}g("AddFeatures","Called");var q=f.GetParentRef(j);if(q=="StaticContainer"){o.addClass("moving");j.draggable({containment:"parent",cancel:"",grid:MP.Tools.Config.Editor.html.snap,start:p.onDragStart,stop:p.onDragStop,drag:p.onDragProgress});j.resizable({autoHide:true,resize:function(t,s){o.width(s.size.width);o.height(s.size.height);m()}})}j.addClass("editing");n=true}catch(r){g("AddFeatures",r,Log.Type.Error)}}function k(){try{if(!n){return}g("RemoveFeatures","Called");j.draggable("destroy").resizable("destroy").removeClass("editing");o.removeClass("moving");n=false}catch(q){g("RemoveFeatures",q,Log.Type.Error)}}this.SetFeatures=function(q){n=q};this.AppendTo=function(q){try{g("AppendTo","Called");$(q).append(j);this.BaseLoad(j,o);if(b.Enabled){this.EditMode()}this.Refresh()}catch(r){g("AppendTo",r,Log.Type.Error)}};this.Create=function(q){try{g("Create","Called");j=$("<div condition='' function='CLICK' definition='Communication.SerialRequest($(\"#rightColumn\"),false,this)' />");j.html("<input type='button' value='"+q+"' id='"+q+"' name='"+q+"'></input>");j.addClass("component EditorSubmitButton");j.attr("ref","EditorSubmitButton");o=$($(j).find("input"))}catch(r){g("Create",r,Log.Type.Error)}};this.DefaultMode=function(){try{g("DefaultMode","Called");k();this.AttachFunctions();f.RemoveComponentID(j)}catch(q){g("DefaultMode",q,Log.Type.Error)}};this.EditMode=function(){try{g("EditMode","Called");l();this.DetachFunctions()}catch(q){g("EditMode",q,Log.Type.Error)}};this.Load=function(r){try{g("Load","Called");j=$(r);o=$(j.find("input"));this.BaseLoad(j,o);var q=o.attr("onclick");if(d.IsFunction(q)){q=q.toString();if(q.indexOf("Communication.")>-1){o.removeAttr("onclick")}}}catch(s){g("Load",s,Log.Type.Error)}};this.Refresh=function(){try{g("Refresh","Called");m()}catch(q){g("Refresh",q,Log.Type.Error)}};this.Search=function(t,q){try{g("Search","Called",Log.Type.Info);var r=this.BaseSearch(t,q);if(r){}}catch(s){g("Search",s,Log.Type.Error)}};this.GetProperties=function(){try{g("GetProperties","Called");var r=this.GetBaseProperties();r[r.length]=new PropertyEd.Property(a.Name,this.GetName,this.SetName);r[r.length]=new PropertyEd.Property(a.Caption,this.GetCaption,this.SetCaption);r[r.length]=new PropertyEd.Property(a.Validate,this.GetCauseValidation,this.SetCauseValidation);var q=f.GetParentRef(j);if(q=="StaticContainer"){r[r.length]=new PropertyEd.Property(a.Width,this.GetWidth,this.SetWidth);r[r.length]=new PropertyEd.Property(a.Height,this.GetHeight,this.SetHeight);r[r.length]=new PropertyEd.Property(a.DefaultButton,this.GetDefaultButton,this.SetDefaultButton)}return r}catch(s){g("GetProperties",s,Log.Type.Error)}};this.GetCauseValidation=function(){try{var q=o.attr("CauseValidation");return(q!=null)}catch(r){g("GetCauseValidation",r,Log.Type.Error)}};this.GetDefaultButton=function(){try{return o.attr("DefaultButton")=="true"}catch(q){g("GetDefaultButton",q,Log.Type.Error)}};this.GetControl=function(){try{return j}catch(q){g("GetControl",q,Log.Type.Error)}};this.GetCaption=function(){try{return o.val()}catch(q){g("GetCaption",q,Log.Type.Error)}};this.GetHeight=function(){try{return d.ToNumber(o.outerHeight())}catch(q){g("GetHeight",q,Log.Type.Error)}};this.SetHeight=function(q){try{o.height(d.ToNumber(q));m()}catch(r){g("SetHeight",r,Log.Type.Error)}};this.GetWidth=function(){try{return d.ToNumber(o.outerWidth())}catch(q){g("GetWidth",q,Log.Type.Error)}};this.SetWidth=function(r){try{o.width(d.ToNumber(r));m()}catch(q){g("SetWidth",q,Log.Type.Error)}};this.GetName=function(){try{return o.attr("name")}catch(q){g("GetName",q,Log.Type.Error)}};this.SetName=function(q){try{if(q!=o.attr("id")){o.attr("id",q)}if(q!=o.attr("name")){o.attr("name",q)}}catch(r){g("SetName",r,Log.Type.Error)}};this.SetCaption=function(r){try{o.val(r)}catch(q){g("SetCaption",q,Log.Type.Error)}};this.SetDefaultButton=function(r){try{o.attr("DefaultButton",r)}catch(q){g("SetDefaultButton",q,Log.Type.Error)}};this.SetCauseValidation=function(r){try{if(r){o.attr("CauseValidation","true")}else{o.removeAttr("CauseValidation")}}catch(q){g("SetCauseValidation",q,Log.Type.Error)}}}catch(h){g("Main",h,Log.Type.Error)}}return c});define("EditorDropDown",["TemplateBase","PropertyFields","Utilities","PageHelper","Editor"],function(d,a,c,f,b){function e(){try{this.TemplateBase=d;this.TemplateBase();this.NameRequired=true;this.refClassName="EdDropdown";var q=this;var k=null;var n=false;var o=null;var p=null;function g(u,t,s,r){q.Log(q.refClassName+"."+u,t,s,r)}function m(){try{g("ResizeControl","Called");var s=o.outerWidth();var r=o.outerHeight();s=s+c.ToNumber(k.css("padding-left"))+c.ToNumber(k.css("padding-right"))+c.ToNumber(k.css("border-left-width"))+c.ToNumber(k.css("border-right-width"));r=r+c.ToNumber(k.css("padding-top"))+c.ToNumber(k.css("padding-bottom"))+c.ToNumber(k.css("border-top-width"))+c.ToNumber(k.css("border-bottom-width"));k.css("width",s);k.css("height",r+10)}catch(t){g("ResizeControl",t,Log.Type.Error)}}function l(){try{if(n){return}g("AddFeatures","Called");var r=f.GetParentRef(k);if(r=="StaticContainer"){o.addClass("moving");p.addClass("moving");k.draggable({containment:"parent",cancel:"",grid:MP.Tools.Config.Editor.html.snap,start:q.onDragStart,stop:q.onDragStop,drag:q.onDragProgress});k.resizable({autoHide:true,maxHeight:k.height(),minHeight:k.height(),resize:function(u,t){o.width(t.size.width);m()}})}k.addClass("editing");n=true}catch(s){g("AddFeatures",s,Log.Type.Error)}}function j(){try{if(!n){return}g("RemoveFeatures","Called");k.draggable("destroy").resizable("destroy").removeClass("editing");o.removeClass("moving");p.removeClass("moving");n=false}catch(r){g("RemoveFeatures",r,Log.Type.Error)}}this.SetFeatures=function(r){n=r};this.AppendTo=function(r){try{g("AppendTo","Called");$(r).append(k);this.BaseLoad(k,o);if(b.Enabled){this.EditMode()}this.Refresh()}catch(s){g("AppendTo",s,Log.Type.Error)}};this.Create=function(r){try{g("Create","Called");k=$("<div condition='' />");k.html("<span>"+r+"</span><br/><select id='"+r+"' name='"+r+"' size='1'>");k.addClass("component EditorDropDown");k.attr("ref","EditorDropDown");o=$($(k).find("select"));p=$($(k).find("span"));p.addClass("notRequired");p.click(function(){o.focus()})}catch(s){g("Create",s,Log.Type.Error)}};this.DefaultMode=function(){try{g("DefaultMode","Called");j();this.AttachFunctions();f.RemoveComponentID(k)}catch(r){g("DefaultMode",r,Log.Type.Error)}};this.EditMode=function(){try{g("EditMode","Called");l();this.DetachFunctions()}catch(r){g("EditMode",r,Log.Type.Error)}};this.Load=function(r){try{g("Load","Called");k=$(r);p=$(k.find("span"));p.css("cursor","default");o=$(k).find("select");p.click(function(){o.focus()});this.BaseLoad(k,o)}catch(s){g("Load",s,Log.Type.Error)}};this.Refresh=function(){try{g("Refresh","Called");m()}catch(r){g("Refresh",r,Log.Type.Error)}};this.Search=function(u,r){try{g("Search","Called",Log.Type.Info);var s=this.BaseSearch(u,r);if(s){if(this.GetOptions().search(s)>-1){g("Search",this,Log.Type.Search)}}}catch(t){g("Search",t,Log.Type.Error)}};this.GetErrorMessage=function(){try{if(this.GetRequired()){if(o.val()=="-1"){return"You must select from the dropdown '"+p.text()+"'"}return null}}catch(r){g("GetErrorMessage",r,Log.Type.Error)}};this.SetFocus=function(){try{o.focus()}catch(r){g("SetFocus",r,Log.Type.Error)}};this.GetControl=function(){try{return k}catch(r){g("GetControl",r,Log.Type.Error)}};this.GetProperties=function(){try{g("GetProperties","Called");var s=this.GetBaseProperties();s[s.length]=new PropertyEd.Property(a.Name,this.GetName,this.SetName);s[s.length]=new PropertyEd.Property(a.Caption,this.GetCaption,this.SetCaption);s[s.length]=new PropertyEd.Property(a.MultiSelect,this.GetMultiSelect,this.SetMultiSelect);s[s.length]=new PropertyEd.Property(a.Options,this.GetOptions,this.SetOptions);s[s.length]=new PropertyEd.Property(a.Required,this.GetRequired,this.SetRequired);s[s.length]=new PropertyEd.Property(a.Size,this.GetSize,this.SetSize);var r=f.GetParentRef(k);if(r=="StaticContainer"){s[s.length]=new PropertyEd.Property(a.Width,this.GetWidth,this.SetWidth)}return s}catch(t){g("GetProperties",t,Log.Type.Error)}};this.GetCaption=function(){try{return p.text()}catch(r){g("GetCaption",r,Log.Type.Error)}};this.GetName=function(){try{return o.attr("name")}catch(r){g("GetName",r,Log.Type.Error)}};this.GetOptions=function(){try{return o.html()}catch(r){g("GetOptions",r,Log.Type.Error)}};this.GetMultiSelect=function(){try{return o.attr("multiple")}catch(r){g("GetMultiSelect",r,Log.Type.Error)}};this.GetRequired=function(){try{return p.hasClass("required")}catch(r){g("GetRequired",r,Log.Type.Error)}};this.GetSize=function(){try{return o.attr("size")}catch(r){g("GetSize",r,Log.Type.Error)}};this.GetWidth=function(){try{return c.ToNumber(o.outerWidth())}catch(r){g("GetWidth",r,Log.Type.Error)}};this.SetWidth=function(s){try{o.width(c.ToNumber(s));m()}catch(r){g("SetWidth",r,Log.Type.Error)}};this.SetCaption=function(s){try{p.text(s)}catch(r){g("SetCaption",r,Log.Type.Error)}};this.SetName=function(r){try{if(r!=o.attr("id")){o.attr("id",r)}if(r!=o.attr("name")){o.attr("name",r)}}catch(s){g("SetName",s,Log.Type.Error)}};this.SetMultiSelect=function(s){try{if(s==true||s=="true"){o.attr("multiple","multiple")}else{o.attr("multiple","")}}catch(r){g("SetMultiSelect",r,Log.Type.Error)}};this.SetOptions=function(s){try{o.html(s)}catch(r){g("SetOptions",r,Log.Type.Error)}};this.SetRequired=function(s){try{if(s==true||s=="true"){p.removeClass("notRequired").addClass("required")}else{p.removeClass("required").addClass("notRequired")}}catch(r){g("SetRequired",r,Log.Type.Error)}};this.SetSize=function(s){try{o.attr("size",s);m()}catch(r){g("SetSize",r,Log.Type.Error)}}}catch(h){g("Main",h,Log.Type.Error)}}return e});define("EditorLabel",["TemplateBase","PropertyFields","PageHelper","Editor"],function(d,b,e,c){function a(){try{this.inheritFrom=d;this.inheritFrom();this.NameRequired=false;this.refClassName="EdLabel";var f=this;var n=null;var l=false;var g=null;function h(r,q,p,o){f.Log(f.refClassName+"."+r,q,p,o)}function k(){try{if(l){return}h("AddFeatures","Called");var o=e.GetParentRef(n);if(o=="StaticContainer"){n.draggable({containment:"parent",cancel:"",grid:MP.Tools.Config.Editor.html.snap,start:f.onDragStart,stop:f.onDragStop,drag:f.onDragProgress});n.resizable({autoHide:true,maxHeight:n.height(),minHeight:n.height(),grid:MP.Tools.Config.Editor.html.snap})}g.addClass("moving");n.addClass("editing").addClass("moving");l=true}catch(p){h("AddFeatures",p,Log.Type.Error)}}function m(){try{if(!l){return}h("RemoveFeatures","Called");g.removeClass("moving");n.draggable("destroy").resizable("destroy").removeClass("editing").removeClass("moving");l=false}catch(o){h("RemoveFeatures",o,Log.Type.Error)}}this.SetFeatures=function(o){l=o};this.AppendTo=function(o){try{h("AppendTo","Called");$(o).append(n);this.BaseLoad(n,g);if(c.Enabled){this.EditMode()}this.Refresh()}catch(p){h("AppendTo",p,Log.Type.Error)}};this.Create=function(){try{h("Create","Called");n=$("<div condition='' />");n.html("<label class='handle Default'>LABEL</label>");n.addClass("component EditorLabel");n.attr("ref","EditorLabel");g=$($(n).find("label"))}catch(o){h("Create",o,Log.Type.Error)}};this.DefaultMode=function(){try{h("DefaultMode","Called");m();this.AttachFunctions();e.RemoveComponentID(n)}catch(o){h("DefaultMode",o,Log.Type.Error)}};this.EditMode=function(){try{h("EditMode","Called");k();this.DetachFunctions()}catch(o){h("EditMode",o,Log.Type.Error)}};this.Load=function(o){try{h("Load","Called");n=$(o);g=$(n.find("label"));this.BaseLoad(n,g)}catch(p){h("Load",p,Log.Type.Error)}};this.Refresh=function(){try{h("Refresh","Called")}catch(o){h("Refresh",o,Log.Type.Error)}};this.Search=function(r,o){try{h("Search","Called",Log.Type.Info);var p=this.BaseSearch(r,o);if(p){if(this.GetStyle().search(p)>-1){h("Search",this,Log.Type.Search)}}}catch(q){h("Search",q,Log.Type.Error)}};this.GetControl=function(){try{return n}catch(o){h("GetControl",o,Log.Type.Error)}};this.GetProperties=function(){try{h("GetProperties","Called");var o=this.GetBaseProperties();o[o.length]=new PropertyEd.Property(b.ID,this.GetID,this.SetID);o[o.length]=new PropertyEd.Property(b.Caption,this.GetCaption,this.SetCaption);o[o.length]=new PropertyEd.Property(b.Class,this.GetClass,this.SetClass);o[o.length]=new PropertyEd.Property(b.Style,this.GetStyle,this.SetStyle);return o}catch(p){h("GetProperties",p,Log.Type.Error)}};this.GetID=function(){try{return g.attr("id")}catch(o){h("GetID",o,Log.Type.Error)}};this.SetID=function(o){try{if(o!=g.attr("id")){g.attr("id",o)}}catch(p){h("SetID",p,Log.Type.Error)}};this.GetCaption=function(){try{return g.html()}catch(o){h("GetCaption",o,Log.Type.Error)}};this.SetCaption=function(p){try{g.html(p)}catch(o){h("SetCaption",o,Log.Type.Error)}};this.GetClass=function(){try{g.removeClass("moving");return g.attr("class")}catch(o){h("GetClass",o,Log.Type.Error)}};this.SetClass=function(p){try{g.attr("class",p);g.addClass("moving")}catch(o){h("SetClass",o,Log.Type.Error)}};this.GetStyle=function(){try{return g.attr("style")||""}catch(o){h("GetStyle",o,Log.Type.Error)}};this.SetStyle=function(p){try{if(!p){p=" "}g.attr("style",p)}catch(o){h("SetStyle",o,Log.Type.Error)}}}catch(j){h("Main",j,Log.Type.Error)}}return a});define("EditorLink",["TemplateBase","PropertyFields","PageHelper","Editor"],function(c,a,e,b){function d(){try{this.inheritFrom=c;this.inheritFrom();this.NameRequired=false;this.refClassName="EdLink";var f=this;var n=null;var l=false;var k=null;function g(r,q,p,o){f.Log(f.refClassName+"."+r,q,p,o)}function j(){try{if(l){return}g("AddFeatures","Called");var p=k.attr("onclick");var r="";if(Utilities.IsFunction(p)){r=String(p);var u=r.indexOf("{")+1;var q=r.lastIndexOf("}");r=r.substring(u,q);r=Utilities.Trim(r);k.removeAttr("onclick")}else{r=f.GetTarget()}f.SetTarget(r);n.addClass("editing");var o=e.GetParentRef(n);if(o=="StaticContainer"){n.draggable({containment:"parent",cancel:"",grid:MP.Tools.Config.Editor.html.snap,start:f.onDragStart,stop:f.onDragStop,drag:f.onDragProgress})}k.addClass("moving");n.addClass("moving");l=true}catch(t){g("AddFeatures",t,Log.Type.Error)}}function m(){try{if(!l){return}g("RemoveFeatures","Called");k.removeClass("moving");n.draggable("destroy").removeClass("editing").removeClass("moving");l=false}catch(o){g("RemoveFeatures",o,Log.Type.Error)}}this.SetFeatures=function(o){l=o};this.AppendTo=function(o){try{g("AppendTo","Called");$(o).append(n);this.BaseLoad(n,k);if(b.Enabled){this.EditMode()}this.Refresh()}catch(p){g("AppendTo",p,Log.Type.Error)}};this.Create=function(){try{g("Create","Called");n=$("<div condition='' />");n.html("<a class='handle Default' style='cursor: pointer;' onclick='Communication.LinkRequest();'>LINK</a>");n.addClass("component EditorLink");n.attr("ref","EditorLink");k=$(n.find("a"))}catch(o){g("Create",o,Log.Type.Error)}};this.DefaultMode=function(){try{g("DefaultMode","Called");m();this.AttachFunctions();e.RemoveComponentID(n)}catch(o){g("DefaultMode",o,Log.Type.Error)}};this.EditMode=function(){try{g("EditMode","Called");j();this.DetachFunctions()}catch(o){g("EditMode",o,Log.Type.Error)}};this.Load=function(o){try{g("Load","Called");n=$(o);k=$(n.find("a"));this.BaseLoad(n,k)}catch(p){g("Load",p,Log.Type.Error)}};this.Refresh=function(){try{g("Refresh","Called")}catch(o){g("Refresh",o,Log.Type.Error)}};this.Search=function(r,o){try{g("Search","Called",Log.Type.Info);var p=this.BaseSearch(r,o);if(p){if(this.GetStyle().search(p)>-1||this.GetTarget().search(p)>-1){g("Search",this,Log.Type.Search)}}}catch(q){g("Search",q,Log.Type.Error)}};this.GetControl=function(){try{return n}catch(o){g("GetControl",o,Log.Type.Error)}};this.GetProperties=function(){try{g("GetProperties","Called");var o=this.GetBaseProperties();o[o.length]=new PropertyEd.Property(a.ID,this.GetID,this.SetID);o[o.length]=new PropertyEd.Property(a.Caption,this.GetCaption,this.SetCaption);o[o.length]=new PropertyEd.Property(a.Class,this.GetClass,this.SetClass);o[o.length]=new PropertyEd.Property(a.Style,this.GetStyle,this.SetStyle);o[o.length]=new PropertyEd.Property(a.Target,this.GetTarget,this.SetTarget);return o}catch(p){g("GetProperties",p,Log.Type.Error)}};this.GetID=function(){try{return k.attr("id")}catch(o){g("GetID",o,Log.Type.Error)}};this.SetID=function(o){try{if(o!=k.attr("id")){k.attr("id",o)}}catch(p){g("SetID",p,Log.Type.Error)}};this.GetCaption=function(){try{return k.text()}catch(o){g("GetCaption",o,Log.Type.Error)}};this.SetCaption=function(p){try{k.text(p)}catch(o){g("SetCaption",o,Log.Type.Error)}};this.GetClass=function(){try{k.removeClass("moving");return k.attr("class")}catch(o){g("GetClass",o,Log.Type.Error)}};this.SetClass=function(p){try{k.attr("class",p);k.addClass("moving")}catch(o){g("SetClass",o,Log.Type.Error)}};this.GetStyle=function(){try{return k.attr("style")||""}catch(o){g("GetStyle",o,Log.Type.Error)}};this.SetStyle=function(p){try{k.attr("style",p)}catch(o){g("SetStyle",o,Log.Type.Error)}};this.GetTarget=function(){try{return String(k.attr("targetlink2onclick"))}catch(o){g("GetTarget",o,Log.Type.Error)}};this.SetTarget=function(p){try{k.attr("targetlink2onclick",String(p))}catch(o){g("SetTarget",o,Log.Type.Error)}}}catch(h){g("Main",h,Log.Type.Error)}}return d});define("EditorDiv",["TemplateBase","PropertyFields","PageHelper","Editor"],function(d,b,e,c){function a(){try{this.inheritFrom=d;this.inheritFrom();this.NameRequired=false;this.refClassName="EdDiv";var f=this;var m=null;var k=false;var n=null;function g(r,q,p,o){f.Log(f.refClassName+"."+r,q,p,o)}function j(){try{if(k){return}g("AddFeatures","Called");var o=e.GetParentRef(m);if(o=="StaticContainer"){m.draggable({containment:"parent",cancel:"",grid:MP.Tools.Config.Editor.html.snap,start:f.onDragStart,stop:f.onDragStop,drag:f.onDragProgress});m.resizable({autoHide:true,grid:MP.Tools.Config.Editor.html.snap})}m.addClass("editing").addClass("moving");k=true}catch(p){g("AddFeatures",p,Log.Type.Error)}}function l(){try{if(!k){return}g("RemoveFeatures","Called");m.draggable("destroy").resizable("destroy").removeClass("editing").removeClass("moving");k=false}catch(o){g("RemoveFeatures",o,Log.Type.Error)}}this.SetFeatures=function(o){k=o};this.AppendTo=function(o){try{g("AppendTo","Called");$(o).append(m);this.BaseLoad(m,n);if(c.Enabled){this.EditMode()}this.Refresh()}catch(p){g("AppendTo",p,Log.Type.Error)}};this.Create=function(){try{g("Create","Called");m=$("<div condition='' />");m.html("<div>DIV</div>");m.addClass("component EditorDiv");m.attr("ref","EditorDiv");n=m.find("div")}catch(o){g("Create",o,Log.Type.Error)}};this.DefaultMode=function(){try{g("DefaultMode","Called");l();this.AttachFunctions();e.RemoveComponentID(m)}catch(o){g("DefaultMode",o,Log.Type.Error)}};this.EditMode=function(){try{g("EditMode","Called");j();this.DetachFunctions()}catch(o){g("EditMode",o,Log.Type.Error)}};this.Load=function(o){try{g("Load","Called");m=$(o);n=m.find("div");this.BaseLoad(m,n)}catch(p){g("Load",p,Log.Type.Error)}};this.Refresh=function(){try{g("Refresh","Called")}catch(o){g("Refresh",o,Log.Type.Error)}};this.Search=function(r,o){try{g("Search","Called",Log.Type.Info);var p=this.BaseSearch(r,o);if(p){if(this.GetHTML().search(p)>-1||this.GetStyle().search(p)>-1){g("Search",this,Log.Type.Search)}}}catch(q){g("Search",q,Log.Type.Error)}};this.GetControl=function(){try{return m}catch(o){g("GetControl",o,Log.Type.Error)}};this.GetProperties=function(){try{g("GetProperties","Called");var o=this.GetBaseProperties();o[o.length]=new PropertyEd.Property(b.ID,this.GetID,this.SetID);o[o.length]=new PropertyEd.Property(b.HtmlBody,this.GetHTML,this.SetHTML);o[o.length]=new PropertyEd.Property(b.ClassText,this.GetClass,this.SetClass);o[o.length]=new PropertyEd.Property(b.Style,this.GetStyle,this.SetStyle);return o}catch(p){g("GetProperties",p,Log.Type.Error)}};this.GetID=function(){try{return n.attr("id")}catch(o){g("GetID",o,Log.Type.Error)}};this.SetID=function(o){try{if(o!=n.attr("id")){n.attr("id",o)}}catch(p){g("SetID",p,Log.Type.Error)}};this.GetHTML=function(){try{return n.html()}catch(o){g("GetHTML",o,Log.Type.Error)}};this.SetHTML=function(o){try{n.html(o)}catch(p){g("SetHTML",p,Log.Type.Error)}};this.GetClass=function(){try{return n.attr("class")||""}catch(o){g("GetClass",o,Log.Type.Error)}};this.SetClass=function(p){try{n.attr("class",p)}catch(o){g("SetClass",o,Log.Type.Error)}};this.GetStyle=function(){try{return n.attr("style")||""}catch(o){g("GetStyle",o,Log.Type.Error)}};this.SetStyle=function(p){try{if(!p){p=" "}n.attr("style",p)}catch(o){g("SetStyle",o,Log.Type.Error)}}}catch(h){g("Main",h,Log.Type.Error)}}return a});define("EditorText",["TemplateBase","ValidationBase","PropertyFields","Utilities","PageHelper","Editor"],function(e,g,b,d,f,c){function a(){try{this.inheritFrom=e;this.inheritFrom();this.inheritFrom=g;this.inheritFrom();this.NameRequired=true;this.refClassName="EdText";this.UserUpdate=false;this.Corrected=false;var r=this;var l=null;var o=false;var p=null;var q=null;function h(v,u,t,s){r.Log(r.refClassName+"."+v,u,t,s)}function n(){try{h("ResizeControl","Called");var t=d.ToNumber(p.width()),v=d.ToNumber(p.height());if(t<1||v<1){return}var u=d.ToNumber(l.css("padding-left"))+d.ToNumber(l.css("border-left-width")),A=d.ToNumber(l.css("padding-right"))+d.ToNumber(l.css("border-right-width")),y=d.ToNumber(p.css("margin-top"))+d.ToNumber(p.css("border-top-width")),z=t;if(Browser.IsMSIE()){t-=u}else{t-=(u+A);u+=1;if(Browser.IsFirefox()){y+=1}}q.width(t).height(v);var s=f.GetParentRef(l);if(s=="StaticContainer"){q.css("left",u+"px").css("top",y+"px")}else{q.css("left","").css("top","")}l.css("width",z+"px")}catch(x){h("ResizeControl",x,Log.Type.Error)}}function m(){try{if(o){return}h("AddFeatures","Called");var s=f.GetParentRef(l);if(s=="StaticContainer"){p.addClass("moving");l.draggable({containment:"parent",cancel:"",grid:MP.Tools.Config.Editor.html.snap,start:r.onDragStart,stop:r.onDragStop,drag:r.onDragProgress});l.resizable({autoHide:true,maxHeight:l.height(),minHeight:l.height(),resize:function(v,u){p.width(u.size.width);n()}})}p.bind("click.EditorText",function(u){u.stopPropagation();this.focus()});l.addClass("editing");o=true}catch(t){h("AddFeatures",t,Log.Type.Error)}}function k(){try{if(!o){return}h("RemoveFeatures","Called");l.draggable("destroy").resizable("destroy").removeClass("editing");p.removeClass("moving").unbind("click.EditorText");o=false}catch(s){h("RemoveFeatures",s,Log.Type.Error)}}this.SetFeatures=function(s){o=s};this.AppendTo=function(s){try{h("AppendTo","Called");$(s).append(l);this.BaseLoad(l,p);this.ValidationBaseLoad(l,p);if(c.Enabled){this.EditMode()}this.Refresh()}catch(t){h("AppendTo",t,Log.Type.Error)}};this.Create=function(s){try{h("Create","Called");l=$("<div condition='' />");l.html("<span>"+s+"</span><input id='"+s+"' name='"+s+"' maxlength='30'>");l.addClass("component EditorText");l.attr("ref","EditorText");p=$($(l).find("input"));q=$($(l).find("span"));q.addClass("notRequired");q.click(function(){p.focus()})}catch(t){h("Create",t,Log.Type.Error)}};this.DefaultMode=function(){try{h("DefaultMode","Called");k();this.AttachFilter();this.AttachFunctions();p.css("margin-left","");var E=d.Trim(p.val());p.val(E);if(this.GetFilters&&!p.attr("disabled")&&!p.attr("readonly")){var F=false;var x=null;var H=null;var z="mm/dd/yy";var u=this.GetFilters();for(var B=0;B<u.length;B++){var t=u[B];if(t.Filter=="DATE"&&t.DType=="DATE"&&t.Param){F=true;z=t.Param.toLowerCase().replace("yyyy","yy");break}if(t.Filter=="DATE"){F=true}if(t.DType=="DATE"){var G=t.Param.split("/");var D=parseInt(G[2],10);var w=parseInt(G[0],10)-1;var C=parseInt(G[1],10);if(t.Filter=="GREATERTHANEQUALS"){x=new Date(D,w,C)}if(t.Filter=="GREATERTHAN"){x=new Date(D,w,C+1)}if(t.Filter=="LESSTHANEQUALS"){H=new Date(D,w,C)}if(t.Filter=="LESSTHAN"){H=new Date(D,w,C-1)}}}if(F){p.removeClass("hasDatepicker");p.datepicker({minDate:x,maxDate:H,showOn:"",dateFormat:z,changeMonth:true,changeYear:true,showAnim:"fadeIn",beforeShow:function(J,L){var I=$(J).val();if(I){if(d.IsDate(I,t.Param)){var K=new Date.parse(I);var N=K.getFullYear();var s=K.getMonth();var M=K.getDate();$(this).datepicker("option","defaultDate",new Date(N,s,M))}}else{$(this).datepicker("option","defaultDate",new Date())}}});p.bind("dblclick.datepicker-custom",function(){p.datepicker("show")})}}f.RemoveComponentID(l)}catch(A){h("DefaultMode",A,Log.Type.Error)}};this.EditMode=function(){try{h("EditMode","Called");var s=d.Trim(p.val());p.val(s);m();p.css("margin-left","");this.DetachFilter();this.DetachFunctions();p.unbind(".datepicker-custom");p.datepicker("destroy");p.removeClass("hasDatepicker")}catch(t){h("EditMode",t,Log.Type.Error)}};this.Load=function(s){try{h("Load","Called");l=$(s);q=$(l.find("span"));q.css("cursor","text");p=$(l.find("input"));this.BaseLoad(l,p);q.click(function(){p.focus()});if(!c.Enabled){if(p.attr("sMask")){p.data("submit-type","MASK")}if(d.Trim(p.val()).length==0){q.css("font-size","1em")}else{q.css("font-size",".6em")}p.keyup(function(){if(this.value.length==0){q.css("font-size","1em")}else{q.css("font-size",".6em")}});p.hover(function(){q.css("font-size","1em")},function(){if(d.Trim(p.val()).length==0){q.css("font-size","1em")}else{q.css("font-size",".6em")}});q.hover(function(){q.css("font-size","1em")},function(){if(d.Trim(p.val()).length==0){q.css("font-size","1em")}else{q.css("font-size",".6em")}})}this.ValidationBaseLoad(l,p)}catch(t){h("Load",t,Log.Type.Error)}};this.Refresh=function(){try{h("Refresh","Called");n()}catch(s){h("Refresh",s,Log.Type.Error)}};this.CorrectUI=function(){try{if(this.Corrected){return}h("CorrectUI","Called");n();this.Corrected=true}catch(s){h("CorrectUI",s,Log.Type.Error)}};this.Search=function(w,t){try{h("Search","Called",Log.Type.Info);var u=this.BaseSearch(w,t);if(u){var s=$.grep(this.GetFilters(),function(x){return x.Param.search(u)>-1});if(s.length>0){h("Search",this,Log.Type.Search)}}}catch(v){h("Search",v,Log.Type.Error)}};this.SetFocus=function(){try{p.focus()}catch(s){h("SetFocus",s,Log.Type.Error)}};this.GetControl=function(){try{return l}catch(s){h("GetControl",s,Log.Type.Error)}};this.GetErrorMessage=function(){try{if(this.GetRequired()){if(d.Trim(p.val()).length==0){return"You must enter the field marked '"+q.text()+"'"}return null}}catch(s){h("GetErrorMessage",s,Log.Type.Error)}};this.GetProperties=function(){try{h("GetProperties","Called");var t=this.GetBaseProperties();t[t.length]=new PropertyEd.Property(b.Name,this.GetName,this.SetName);t[t.length]=new PropertyEd.Property(b.Caption,this.GetCaption,this.SetCaption);t[t.length]=new PropertyEd.Property(b.MaxLength,this.GetMaxLength,this.SetMaxLength);t[t.length]=new PropertyEd.Property(b.Required,this.GetRequired,this.SetRequired);t[t.length]=new PropertyEd.Property(b.Secure,this.GetSecure,this.SetSecure);var s=f.GetParentRef(l);if(s=="StaticContainer"){t[t.length]=new PropertyEd.Property(b.Width,this.GetWidth,this.SetWidth)}t=this.GetValidationProperties(t);return t}catch(u){h("GetProperties",u,Log.Type.Error)}};this.GetCaption=function(){try{return q.text()}catch(s){h("GetCaption",s,Log.Type.Error)}};this.SetCaption=function(t){try{q.text(t)}catch(s){h("SetCaption",s,Log.Type.Error)}};this.GetMaxLength=function(){try{return p.attr("maxlength")}catch(s){h("GetMaxLength",s,Log.Type.Error)}};this.SetMaxLength=function(t){try{p.attr("maxlength",t)}catch(s){h("SetMaxLength",s,Log.Type.Error)}};this.GetName=function(){try{return p.attr("name")}catch(s){h("GetName",s,Log.Type.Error)}};this.SetName=function(s){try{if(s!=p.attr("id")){p.attr("id",s)}if(s!=p.attr("name")){p.attr("name",s)}}catch(t){h("SetName",t,Log.Type.Error)}};this.GetRequired=function(){try{return q.hasClass("required")}catch(s){h("GetRequired",s,Log.Type.Error)}};this.SetRequired=function(t){try{if(t==true||t=="true"){q.removeClass("notRequired").addClass("required")}else{q.removeClass("required").addClass("notRequired")}}catch(s){h("SetRequired",s,Log.Type.Error)}};this.GetSecure=function(){try{return p.attr("sValue")&&p.attr("sMask")}catch(s){h("GetSecure",s,Log.Type.Error)}};this.SetSecure=function(t){try{if(t){p.attr("sValue","#S"+p.attr("name")+"-sValue#");p.attr("sMask","#S"+p.attr("name")+"-sMask#")}else{p.removeAttr("sValue");p.removeAttr("sMask")}}catch(s){h("SetSecure",s,Log.Type.Error)}};this.GetWidth=function(){try{return d.ToNumber(p.width())}catch(s){h("GetWidth",s,Log.Type.Error)}};this.SetWidth=function(t){try{p.width(d.ToNumber(t));n()}catch(s){h("SetWidth",s,Log.Type.Error)}}}catch(j){h("Main",j,Log.Type.Error)}}return a});define("EditorMemo",["TemplateBase","PropertyFields","Utilities","PageHelper","Editor"],function(e,a,d,f,b){function c(){try{this.inheritFrom=e;this.inheritFrom();this.NameRequired=true;this.refClassName="EdMemo";this.Corrected=false;var r=this;var k=null;var n=false;var o=null;var p=null;function g(v,u,t,s){r.Log(r.refClassName+"."+v,u,t,s)}function m(){try{g("ResizeControl","Called");var s=r.GetWidth();var t=r.GetHeight();if(s<1||t<1){return}o.width(s).height(t);p.width(s).height(t)}catch(u){g("ResizeControl",u,Log.Type.Error)}}function l(){try{if(n){return}g("AddFeatures","Called");var s=f.GetParentRef(k);if(s=="StaticContainer"){o.addClass("moving");k.draggable({containment:"parent",cancel:"",grid:MP.Tools.Config.Editor.html.snap,start:r.onDragStart,stop:r.onDragStop,drag:r.onDragProgress});k.resizable({autoHide:true,grid:MP.Tools.Config.Editor.html.snap,resize:m,stop:m})}k.addClass("editing");n=true}catch(t){g("AddFeatures",t,Log.Type.Error)}}function j(){try{if(!n){return}g("RemoveFeatures","Called");k.draggable("destroy").resizable("destroy").removeClass("editing");o.removeClass("moving");q(true);n=false}catch(s){g("RemoveFeatures",s,Log.Type.Error)}}function q(u){try{if(u){var t=k.find("div.ckEditorDiv");if(!t.length){t=$("<div class='ckEditorDiv'/>");t.appendTo(k)}t.html(o.val())}if(!p.hasClass("EditorMemoSpan")){g("","Incompatible element! This page must be resaved by the editor.",Log.Type.Warning);p.addClass("EditorMemoSpan");p.removeAttr("style");o.removeAttr("style")}}catch(s){g("CleanUp",s,Log.Type.Error)}}this.SetFeatures=function(s){n=s};this.AppendTo=function(s){try{g("AppendTo","Called");$(s).append(k);this.BaseLoad(k,o);if(b.Enabled){this.EditMode()}this.Refresh()}catch(t){g("AppendTo",t,Log.Type.Error)}};this.Create=function(s){try{g("Create","Called");k=$("<div ref='EditorMemo' style='width: 100px; height: 80px;' condition='' />");k.html("<span>"+s+"</span><textarea id='"+s+"' name='"+s+"'></textarea><div class='ckEditorDiv'/></div>");k.addClass("component EditorMemo");o=k.find("textarea");p=k.find("span");p.addClass("EditorMemoSpan notRequired");p.click(function(){o.focus()})}catch(t){g("Create",t,Log.Type.Error)}};this.DefaultMode=function(){try{g("DefaultMode","Called");j();this.AttachFunctions();f.RemoveComponentID(k);if(b.Enabled){return}if(k.attr("EditHTML")=="true"){var v=o.attr("id"),s=o.attr("title"),u=k.find("div.ckEditorDiv");if(u.length!=1){g("DefaultMode","CkEditor conversion failed! This page must be saved by the editor.",Log.Type.Warning)}else{o.remove();o=u;o.attr("id",v).attr("title",s).show()}p.remove();Global.ConvertToInlineCKEditor(o);return}if(k.attr("SpellCheck")=="true"){k.append("<div class='MemoSpellButton' title='Spellcheck' onclick='Global.AddSpellcheck(this)'></div>");return}}catch(t){g("DefaultMode",t,Log.Type.Error)}};this.EditMode=function(){try{g("EditMode","Called");l();this.DetachFunctions();k.find("div.ckEditorDiv").hide()}catch(s){g("EditMode",s,Log.Type.Error)}};this.Load=function(s){try{g("Load","Called");k=$(s);o=$(k.find("textarea"));p=$(k.find("span.EditorMemoSpan"));if(!p.length){p=$(k.find("span"))}p.click(function(){o.focus()});this.BaseLoad(k,o);q(false)}catch(t){g("Load",t,Log.Type.Error)}};this.Refresh=function(){try{g("Refresh","Called");m()}catch(s){g("Refresh",s,Log.Type.Error)}};this.CorrectUI=function(){try{if(this.Corrected){return}g("CorrectUI","Called");m();this.Corrected=true}catch(s){g("CorrectUI",s,Log.Type.Error)}};this.Search=function(v,s){try{g("Search","Called",Log.Type.Info);var t=this.BaseSearch(v,s);if(t){}}catch(u){g("Search",u,Log.Type.Error)}};this.GetErrorMessage=function(){try{if(this.GetRequired()){if(d.Trim(o.val()).length==0){return"You must enter the field marked '"+p.text()+"'"}return null}}catch(s){g("GetErrorMessage",s,Log.Type.Error)}};this.SetFocus=function(){try{o.focus()}catch(s){g("SetFocus",s,Log.Type.Error)}};this.GetControl=function(){try{return k}catch(s){g("GetControl",s,Log.Type.Error)}};this.GetProperties=function(){try{g("GetProperties","Called");var t=this.GetBaseProperties();t[t.length]=new PropertyEd.Property(a.Name,this.GetName,this.SetName);t[t.length]=new PropertyEd.Property(a.Caption,this.GetCaption,this.SetCaption);t[t.length]=new PropertyEd.Property(a.Required,this.GetRequired,this.SetRequired);t[t.length]=new PropertyEd.Property(a.EditHTML,this.GetEditHTML,this.SetEditHTML);t[t.length]=new PropertyEd.Property(a.Spellcheck,this.GetSpellcheck,this.SetSpellcheck);var s=f.GetParentRef(k);if(s=="StaticContainer"){t[t.length]=new PropertyEd.Property(a.Width,this.GetWidth,this.SetWidth);t[t.length]=new PropertyEd.Property(a.Height,this.GetHeight,this.SetHeight)}return t}catch(u){g("GetProperties",u,Log.Type.Error)}};this.GetName=function(){try{return o.attr("name")}catch(s){g("GetName",s,Log.Type.Error)}};this.SetName=function(s){try{if(s!=o.attr("id")){o.attr("id",s)}if(s!=o.attr("name")){o.attr("name",s)}}catch(t){g("SetName",t,Log.Type.Error)}};this.GetCaption=function(){try{return p.text()}catch(s){g("GetCaption",s,Log.Type.Error)}};this.SetCaption=function(t){try{p.text(t)}catch(s){g("SetCaption",s,Log.Type.Error)}};this.GetRequired=function(){try{return p.hasClass("required")}catch(s){g("GetRequired",s,Log.Type.Error)}};this.SetRequired=function(t){try{if(t==true||t=="true"){p.removeClass("notRequired").addClass("required")}else{p.removeClass("required").addClass("notRequired")}}catch(s){g("SetRequired",s,Log.Type.Error)}};this.GetEditHTML=function(){try{return k.attr("EditHTML")=="true"}catch(s){g("GetEditHTML",s,Log.Type.Error)}};this.SetEditHTML=function(t){try{k.attr("EditHTML",t)}catch(s){g("SetEditHTML",s,Log.Type.Error)}};this.GetSpellcheck=function(){try{return k.attr("Spellcheck")=="true"}catch(s){g("GetSpellcheck",s,Log.Type.Error)}};this.SetSpellcheck=function(t){try{k.attr("Spellcheck",t)}catch(s){g("SetSpellcheck",s,Log.Type.Error)}};this.GetWidth=function(){try{return d.ToNumber(k.css("width"))}catch(s){g("GetWidth",s,Log.Type.Error)}};this.SetWidth=function(s){try{var t=d.ToNumber(s);if(!t){t=d.ToNumber(k.css("width"))}k.css("width",t);m()}catch(u){g("SetWidth",u,Log.Type.Error)}};this.GetHeight=function(){try{return d.ToNumber(k.css("height"))}catch(s){g("GetHeight",s,Log.Type.Error)}};this.SetHeight=function(s){try{var t=d.ToNumber(s);if(!t){t=d.ToNumber(k.css("height"))}k.css("height",t);m()}catch(u){g("SetHeight",u,Log.Type.Error)}}}catch(h){g("Main",h,Log.Type.Error)}}return c});define("EditorCheckBox",["TemplateBase","PropertyFields","PageHelper","Editor"],function(d,b,e,c){function a(){try{this.inheritFrom=d;this.inheritFrom();this.NameRequired=true;this.refClassName="EdCheckBox";var o=this;var h=null;var l=false;var m=null;var n=null;function f(s,r,q,p){o.Log(o.refClassName+"."+s,r,q,p)}function k(){try{if(l){return}f("AddFeatures","Called");var p=e.GetParentRef(h);if(p=="StaticContainer"){n.addClass("moving");m.addClass("moving");h.draggable({containment:"parent",cancel:"",grid:MP.Tools.Config.Editor.html.snap,start:o.onDragStart,stop:o.onDragStop,drag:o.onDragProgress})}h.addClass("editing");n.unbind("click");l=true}catch(q){f("AddFeatures",q,Log.Type.Error)}}function j(){try{if(!l){return}f("RemoveFeatures","Called");h.draggable("destroy").removeClass("editing");m.removeClass("moving");n.removeClass("moving");l=false}catch(p){f("RemoveFeatures",p,Log.Type.Error)}}this.SetFeatures=function(p){l=p};this.AppendTo=function(p){try{f("AppendTo","Called");$(p).append(h);this.BaseLoad(h,m);if(c.Enabled){this.EditMode()}this.Refresh()}catch(q){f("AppendTo",q,Log.Type.Error)}};this.Create=function(p){try{f("Create","Called");h=$("<div condition='' />");h.html("<input type='checkbox' id='"+p+"' name='"+p+"' value='1'><span>"+p+"</span>");h.addClass("component EditorCheckBox");h.attr("ref","EditorCheckBox");m=$($(h).find("input"));n=$($(h).find("span"));n.addClass("notRequired")}catch(q){f("Create",q,Log.Type.Error)}};this.DefaultMode=function(){try{f("DefaultMode","Called");j();this.AttachFunctions();e.RemoveComponentID(h)}catch(p){f("DefaultMode",p,Log.Type.Error)}};this.EditMode=function(){try{f("EditMode","Called");k();this.DetachFunctions()}catch(p){f("EditMode",p,Log.Type.Error)}};this.Load=function(p){try{f("Load","Called");h=$(p);m=$(h.find("input"));n=$(h.find("span"));n.css("cursor","pointer");n.bind("click",function(){o.SetFocus()});this.BaseLoad(h,m)}catch(q){f("Load",q,Log.Type.Error)}};this.Refresh=function(){try{f("Refresh","Called")}catch(p){f("Refresh",p,Log.Type.Error)}};this.Search=function(s,p){try{f("Search","Called",Log.Type.Info);var q=this.BaseSearch(s,p);if(q){if(this.GetValue().search(q)>-1){f("Search",this,Log.Type.Search)}}}catch(r){f("Search",r,Log.Type.Error)}};this.GetErrorMessage=function(){try{if(this.GetRequired()){if(!m[0].checked){return"You must check the box named '"+n.text()+"'"}return null}}catch(p){f("GetErrorMessage",p,Log.Type.Error)}};this.SetFocus=function(){try{m.focus()}catch(p){f("SetFocus",p,Log.Type.Error)}};this.GetControl=function(){try{return h}catch(p){f("GetControl",p,Log.Type.Error)}};this.GetProperties=function(){try{f("GetProperties","Called");var p=this.GetBaseProperties();p[p.length]=new PropertyEd.Property(b.Name,this.GetName,this.SetName);p[p.length]=new PropertyEd.Property(b.Caption,this.GetCaption,this.SetCaption);p[p.length]=new PropertyEd.Property(b.Required,this.GetRequired,this.SetRequired);p[p.length]=new PropertyEd.Property(b.Value,this.GetValue,this.SetValue);p[p.length]=new PropertyEd.Property(b.Flipped,this.GetFlipped,this.SetFlipped);return p}catch(q){f("GetProperties",q,Log.Type.Error)}};this.GetCaption=function(){try{return n.text()}catch(p){f("GetCaption",p,Log.Type.Error)}};this.SetCaption=function(q){try{n.text(q)}catch(p){f("SetCaption",p,Log.Type.Error)}};this.GetName=function(){try{return m.attr("name")}catch(p){f("GetName",p,Log.Type.Error)}};this.SetName=function(p){try{if(p!=m.attr("id")){m.attr("id",p)}if(p!=m.attr("name")){m.attr("name",p)}}catch(q){f("SetName",q,Log.Type.Error)}};this.GetRequired=function(){try{return n.hasClass("required")}catch(p){f("GetRequired",p,Log.Type.Error)}};this.SetRequired=function(q){try{if(q==true||q=="true"){n.removeClass("notRequired").addClass("required")}else{n.removeClass("required").addClass("notRequired")}}catch(p){f("SetRequired",p,Log.Type.Error)}};this.GetValue=function(){try{return m.attr("value")}catch(p){f("GetValue",p,Log.Type.Error)}};this.SetValue=function(q){try{m.attr("value",q)}catch(p){f("SetValue",p,Log.Type.Error)}};this.GetFlipped=function(){try{var q=h.find(":first");var p=q[0]==n[0];return p}catch(r){f("GetFlipped",r,Log.Type.Error)}};this.SetFlipped=function(r){try{var p=n.detach();if(r==true||r=="true"){h.prepend(p)}else{h.append(p)}}catch(q){f("SetFlipped",q,Log.Type.Error)}}}catch(g){f("Main",g,Log.Type.Error)}}return a});define("EditorRadio",["TemplateBase","PropertyFields","PageHelper","Editor"],function(d,b,e,c){function a(){try{this.inheritFrom=d;this.inheritFrom();this.NameRequired=true;this.refClassName="EdRadio";var o=this;var h=null;var l=false;var m=null;var n=null;function f(s,r,q,p){o.Log(o.refClassName+"."+s,r,q,p)}function k(){try{if(l){return}f("AddFeature","Called");var p=e.GetParentRef(h);if(p=="StaticContainer"){n.addClass("moving");m.addClass("moving");h.draggable({containment:"parent",cancel:"",grid:MP.Tools.Config.Editor.html.snap,start:o.onDragStart,stop:o.onDragStop,drag:o.onDragProgress})}h.addClass("editing");l=true}catch(q){f("AddFeatures",q,Log.Type.Error)}}function j(){try{if(!l){return}f("RemoveFeatures","Called");h.draggable("destroy").removeClass("editing");m.removeClass("moving");n.removeClass("moving");l=false}catch(p){f("RemoveFeatures",p,Log.Type.Error)}}this.SetFeatures=function(p){l=p};this.AppendTo=function(p){try{f("AppendTo","Called");$(p).append(h);this.BaseLoad(h,m);if(c.Enabled){this.EditMode()}this.Refresh()}catch(q){f("AppendTo",q,Log.Type.Error)}};this.Create=function(p){try{f("Create","Called");name=p;h=$("<div condition='' />");h.html("<input type='radio' id='"+name+"' name='"+name+"' value='1'><span>"+p+"</span>");h.addClass("component EditorRadio");h.attr("ref","EditorRadio");m=$($(h).find("input"));n=$($(h).find("span"));n.addClass("notRequired")}catch(q){f("Create",q,Log.Type.Error)}};this.DefaultMode=function(){try{f("DefaultMode","Called");j();this.AttachFunctions();e.RemoveComponentID(h)}catch(p){f("DefaultMode",p,Log.Type.Error)}};this.EditMode=function(){try{f("EditMode","Called");k();this.DetachFunctions()}catch(p){f("EditMode",p,Log.Type.Error)}};this.Load=function(p){try{f("Load","Called");h=$(p);m=$(h.find("input"));n=$(h.find("span"));n.css("cursor","pointer");n.bind("click",function(){o.SetFocus()});this.BaseLoad(h,m)}catch(q){f("Load",q,Log.Type.Error)}};this.Refresh=function(){try{f("Refresh","Called")}catch(p){f("Refresh",p,Log.Type.Error)}};this.Search=function(s,p){try{f("Search","Called",Log.Type.Info);var q=this.BaseSearch(s,p);if(q){if(this.GetValue().search(q)>-1){f("Search",this,Log.Type.Search)}}}catch(r){f("Search",r,Log.Type.Error)}};this.GetProperties=function(){try{f("GetProperties","Called");var p=this.GetBaseProperties();p[p.length]=new PropertyEd.Property(b.Name,this.GetName,this.SetName);p[p.length]=new PropertyEd.Property(b.Caption,this.GetCaption,this.SetCaption);p[p.length]=new PropertyEd.Property(b.Required,this.GetRequired,this.SetRequired);p[p.length]=new PropertyEd.Property(b.Value,this.GetValue,this.SetValue);p[p.length]=new PropertyEd.Property(b.Flipped,this.GetFlipped,this.SetFlipped);return p}catch(q){f("GetProperties",q,Log.Type.Error)}};this.GetErrorMessage=function(p){try{if(this.GetRequired()){var q=m.attr("name");if(p.indexOf("&"+q+"=")==-1){return"You must choose one of the radios '"+n.text()+"'"}return null}}catch(r){f("GetErrorMessage",r,Log.Type.Error)}};this.SetFocus=function(){try{m.focus()}catch(p){f("SetFocus",p,Log.Type.Error)}};this.GetControl=function(){try{return h}catch(p){f("GetControl",p,Log.Type.Error)}};this.GetCaption=function(){try{return n.text()}catch(p){f("GetCaption",p,Log.Type.Error)}};this.GetName=function(){try{return m.attr("name")}catch(p){f("GetName",p,Log.Type.Error)}};this.GetRequired=function(){try{return n.hasClass("required")}catch(p){f("GetRequired",p,Log.Type.Error)}};this.GetValue=function(){try{return m.val()}catch(p){f("GetValue",p,Log.Type.Error)}};this.SetCaption=function(q){try{n.text(q)}catch(p){f("SetCaption",p,Log.Type.Error)}};this.SetName=function(p){try{if(p!=m.attr("id")){m.attr("id",p)}if(p!=m.attr("name")){m.attr("name",p)}}catch(q){f("SetName",q,Log.Type.Error)}};this.SetRequired=function(q){try{if(q==true||q=="true"){n.removeClass("notRequired").addClass("required")}else{n.removeClass("required").addClass("notRequired")}}catch(p){f("SetRequired",p,Log.Type.Error)}};this.SetValue=function(q){try{m.val(q)}catch(p){f("SetValue",p,Log.Type.Error)}};this.GetFlipped=function(){try{var q=h.find(":first");var p=q[0]==n[0];return p}catch(r){f("GetFlipped",r,Log.Type.Error)}};this.SetFlipped=function(r){try{var p=n.detach();if(r==true||r=="true"){h.prepend(p)}else{h.append(p)}}catch(q){f("SetFlipped",q,Log.Type.Error)}}}catch(g){f("Main",g,Log.Type.Error)}}return a});define("ValidationBase",["ValidatorContainer","PropertyFields","Utilities","PageHelper","Editor"],function(d,a,c,f,b){var e=function(){this.refClassName="ValidBase";var j=this;var l=null;var m=null;function k(r,q,p,o){Log.Add(j.refClassName+"."+r,q,p,o)}var g=function(t,r,q,u,s,o){u=u||function(v){return v};s=s||$.noop;o=o||$.noop;if(q||$.trim(t)===""){return s(t)}try{$.each(r,function(v,w){t=u(w,t)})}catch(p){return o(p)}return s(t)};var n=function(o){var q=$(o).parents(".component")[0];return f.GetEditorComponent(q)};this.ValidationBaseLoad=function(o,q){try{l=o;m=q}catch(p){k("ValidationBaseLoad",p,Log.Type.Error)}};this.FilterInput=function(p){var q=m.attr("sMask")&&!this.UserUpdate,o=null;g(m.val(),this.GetFilters(),q,function(r,s){return r.FilterText(s)},function(r){m.val(r)},function(r){if(p){o=r}else{var s=f.GetEditorComponent(l);if(s){s.HighlightAsError(true)}jAlert(r,"Invalid Entry",function(){m.select();m.focus()})}});return o};this.AttachFilter=function(){try{if(b.Enabled){return}$.each(this.GetFilters(),function(p,q){q.Attach($(m))});m.bind("change.filter",function(){var p=n(this);p.UserUpdate=true});m.bind("blur.filter",function(){var p=n(this);p.FilterInput()})}catch(o){k("AttachFilter",o,Log.Type.Error)}};this.DetachFilter=function(){try{$.each(this.GetFilters(),function(p,q){q.Detach($(m))});m.unbind(".filter")}catch(o){k("DetachFilter",o,Log.Type.Error)}};this.GetValidationProperties=function(p){try{var o=new RulesMaker.ComplexArgs(this.GetValidationProperties,this.AddFilter,this.DeleteFilter);switch(l.attr("Ref")){case"EditorText":p[p.length]=new PropertyEd.Property(a.EditorTextFilters,this.GetFilters,this.SetFilters,o);break;case"EditorDropdown":break}return p}catch(q){k("GetValidationProperties",q,Log.Type.Error)}};this.AddFilter=function(){try{if((l.attr("filter")==null)||(l.attr("filter").length==0)){l.attr("filter","");l.attr("param","");l.attr("dtype","")}else{l.attr("filter",l.attr("filter")+"|");l.attr("param",l.attr("param")+"|");l.attr("dtype",l.attr("dtype")+"|")}}catch(o){k("AddFilter",o,Log.Type.Error)}};this.DeleteFilter=function(t){try{if(!l.attr("filter")||!l.attr("param")||!l.attr("dtype")){return}var s;s=l.attr("filter");var q=(s.match(/|/))?s.split("|"):[s];q.splice(t,1);l.attr("filter",q.toPipeString());s=l.attr("param");var r=(s.match(/|/))?s.split("|"):[s];r.splice(t,1);l.attr("param",r.toPipeString());s=l.attr("dtype");var o=(s.match(/|/))?s.split("|"):[s];o.splice(t,1);l.attr("dtype",o.toPipeString());if(l.attr("filter").length==0){l.removeAttr("filter");l.removeAttr("param");l.removeAttr("dtype")}}catch(p){k("DeleteFilter",p,Log.Type.Error)}};this.GetFilters=function(){var r=l.attr("filter");var q=l.attr("dtype");var s=l.attr("param");if(r==null||r==""||q==null||s==null){return[]}var o=[];r=r.split("|");q=q.split("|");s=s.split("|");for(var p=0;p<r.length;p++){o.push(new h(r[p],s[p],q[p]))}return o};this.SetFilters=function(o){try{var t="";var v="";var r="";var p=true;var u;if(o.length==0){p=false}if(o.length==1){u=c.ReplaceAll(o[0].Filter," ","");if(u==""){p=false}}if(!p){l.removeAttr("filter");l.removeAttr("param");l.removeAttr("dtype");return}for(var q=0;q<o.length;q++){u=c.ReplaceAll(o[q].Filter," ","");if(u.length>0){t+=o[q].Filter+"|";v+=o[q].Param+"|";r+=o[q].DType+"|"}}if(o.length>0){t=t.removeLastChar();v=v.removeLastChar();r=r.removeLastChar()}l.attr("filter",t);l.attr("param",v);l.attr("dtype",r)}catch(s){k("SetFilters",s,Log.Type.Error)}};function h(p,q,o){this.Filter=p;this.DType=o;this.Param=q;this.Callbacks=d.Filters[this.Filter]}h.prototype.FilterText=function(p){var o=this.Callbacks.filter;if(typeof o!=="function"){return p}return o(p,this.DType,this.Param)};h.prototype.Attach=function(o){if(typeof this.Callbacks.filter!=="object"||!this.Callbacks.filter.attach){return}this.Callbacks.filter.attach(o,this.DType,this.Param)};h.prototype.Detach=function(o){if(typeof this.Callbacks.filter!=="object"||!this.Callbacks.filter.detach){return}this.Callbacks.filter.detach(o,this.DType,this.Param)}};return e});define("EditableContent",["Utilities","PageHelper","Editor"],function(b,d,a){function c(){try{this.NameRequired=false;this.Accept=["StaticContainer","DynamicContainer","EditorLabel","EditorDiv","TransferList","ValidationContainer","ScriptingContainer"];this.refClassName="EditableContent";var e=this;var l=null;var j=false;function f(p,o,n,m){Log.Add(e.refClassName+"."+p,o,n,m)}function h(){try{if(j){return}f("AddFeatures","Called");l.droppable({accept:a.GetAcceptedComponents(e.Accept),greedy:true,activeClass:"droppable-active",hoverClass:"droppable-hover",drop:function(o,p){var n=$(p.draggable).attr("ref");a.BuildComponent(n,$(this))}});l.sortable({items:">.component",handle:">.handle"});l.disableSelection();j=true}catch(m){f("AddFeatures",m,Log.Type.Error)}}function k(){try{if(!j){return}f("RemoveFeatures","Called");l.droppable("destroy").sortable("destroy").enableSelection();j=false}catch(m){f("RemoveFeatures",m,Log.Type.Error)}}return{SetFeatures:function(m){},HighlightAsSelected:function(m){},HighlightAsFound:function(m){},HighlightAsError:function(m){},Search:function(n,m){},DefaultMode:function(){try{f("DefaultMode","Called");k();l.bind("keydown",function(o){if((o.keyCode==13)&&(!$(o.target).is(":button ,textarea"))){var n=$(this).find(".EditorSubmitButton input[DefaultButton='true']");if(n.length>1){f("DefaultMode","There are "+n.length+" default submit buttons on the page! Submit skipped.",Log.Type.Warning);return}var p=new jQuery.Event("click");n.trigger(p)}});d.RemoveComponentID(l)}catch(m){f("DefaultMode",m,Log.Type.Error)}},EditMode:function(){try{f("EditMode","Called");h()}catch(m){f("EditMode",m,Log.Type.Error)}},Load:function(m){try{f("Load","Called");l=$(m)}catch(n){f("Load",n,Log.Type.Error)}},GetControl:function(){try{return l}catch(m){f("GetControl",m,Log.Type.Error)}},Refresh:function(){try{f("Refresh","Called")}catch(m){f("Refresh",m,Log.Type.Error)}}}}catch(g){f("Main",g,Log.Type.Error)}}return c});define("DynamicContainer",["TemplateBase","PropertyFields","Utilities","PageHelper","Editor"],function(e,b,d,f,c){function a(){try{this.inheritFrom=e;this.inheritFrom();this.NameRequired=false;this.refClassName="DynamicCont";this.Accept=["DynamicContainer","StaticContainer","EditorLabel","EditorDiv","TransferList"];var q=this;var j=null;var n=null;var m=false;function g(u,t,s,r){q.Log(q.refClassName+"."+u,t,s,r)}function l(){try{if(m){return}g("AddFeatures","Called");j.droppable({accept:c.GetAcceptedComponents(q.Accept),greedy:true,activeClass:"droppable-active",hoverClass:"droppable-hover",drop:function(t,u){var s=$(u.draggable).attr("ref");c.BuildComponent(s,$(this))}});j.sortable({items:"> .component"});n.addClass("moving");m=true}catch(r){g("AddFeatures",r,Log.Type.Error)}}function k(){try{if(!m){return}g("RemoveFeatures","Called");j.droppable("destroy").sortable("destroy");n.removeClass("moving");m=false}catch(r){g("RemoveFeatures",r,Log.Type.Error)}}var p={dateMDY:function(s){var u=/(\d+)\/(\d+)\/(\d+)/.exec(s.text());if(!u){return s.text()}var r=u[1];var v=u[2];var w=u[3];var t=new Date(w,r,v);return t.getTime()}};function o(){try{var r=j.find(".TableMaster,.TableMasterSM");if(!r.length){return}r.each(function(A){var I=$(this);I.attr("cellspacing",0);var z=$(I).find("thead > tr > td").length,G=$(I).find("tbody > tr > td").length,D;if(G==1||G<z){var y=$(I).find("tr > td[colspan]");y.each(function(){$(this).get(0).removeAttribute("colspan")});for(var A=G;A<z;A++){$("<td></td>").appendTo($(I).find("tbody > tr"))}$(r).find("tbody > tr > td").css({"border-right":"none"})}if(I.attr("wrapped")!="true"){I.find("tr:odd").addClass("even");I.find("tr").hover(function(){$(this).addClass("hover")},function(){$(this).removeClass("hover")});var w=I.attr("id");if(w==null||w.length==0){var u=d.MakeGUID();I.attr("id",u);w=u}I.wrap("<div class='TableMasterWrapper'></div>");I.attr("wrapped","true");superTable(w);var C=false;var H=false;var v=j.find(".TableMaster");var F=$(this).parent(".sData"),B=$(this).parent().parent(".sBase"),E=$(this),x=$(this).parent().parent().parent(".TableMasterWrapper");x.css({margin:"10px"});B.width(x.width());F.width(B.width());F.height(E.height());x.height(F.height());if(F.height()>190){F.height(190);x.height(190+20)}if(E.outerWidth(true)>F.outerWidth(true)){C=true;x.height(x.height()+18)}if(F.height()<E.height()){H=true}if(E.width()<F.width()&&H){F.width(E.width()+18)}}});var s=$(".sHeaderInner").find("table > thead > tr > td");$(s).attr("sortdir","asc");if(s.length){$(s).each(function(){var v=$(this).parent().parent().parent(),u=v.find("thead > tr > td").length;$(this).unbind("click");$(this).bind("click",function(){var x=$(this).attr("sortdir");var z=v.attr("id");var w=$(this).attr("data-sort-attr")||"";var y=$(this).attr("data-sort-form");if(y&&Object.prototype.hasOwnProperty.call(p,y)){y=p[y];w=w||"data-sort-form-data";$(v).parent().parent().next(".sData").find("tbody > tr > td:nth-child("+($(this).index()+1)+")").each(function(){var A=$(this);if(!A.attr(w)){A.attr(w,y(A))}})}$(v).parent().parent().next(".sData").find("tbody>tr").tsort("td:eq("+$(this).index()+")",{order:x,attr:w});$(v).parent().parent().next(".sData").find(".even").removeClass("even");$(v).parent().parent().next(".sData").find("tr:odd").addClass("even");$(this).attr("sortdir",x=="asc"?"desc":"asc");$(this).parents("table").find(".asc").removeClass("asc");$(this).parents("table").find(".desc").removeClass("desc");$(this).addClass(x=="asc"?"asc":"desc")})})}}catch(t){g("FormatTableMaster",t,Log.Type.Error)}}this.SetFeatures=function(r){m=r};this.AppendTo=function(r){try{g("AppendTo","Called");$(r).append(j);this.BaseLoad(j);if(c.Enabled){this.EditMode()}}catch(s){g("AppendTo",s,Log.Type.Error)}};this.Create=function(){try{g("Create","Called");j=$("<div condition='' class='component DynamicContainer' ref='DynamicContainer'><h3 class='handle'>Dynamic Container</h3></div>");n=$(j.find(">h3"))}catch(r){g("Create",r,Log.Type.Error)}};this.DefaultMode=function(){try{g("DefaultMode","Called");k();o();f.RemoveComponentID(j)}catch(r){g("DefaultMode",r,Log.Type.Error)}};this.EditMode=function(){try{g("EditMode","Called");l()}catch(r){g("EditMode",r,Log.Type.Error)}};this.Load=function(r){try{g("Load","Called");j=$(r);this.BaseLoad(j);n=$(j.find(">h3"))}catch(s){g("Load",s,Log.Type.Error)}};this.GetControl=function(){try{return j}catch(r){g("GetControl",r,Log.Type.Error)}};this.Refresh=function(){try{g("Refresh","Called")}catch(r){g("Refresh",r,Log.Type.Error)}};this.Search=function(u,r){try{g("Search","Called",Log.Type.Info);var s=this.BaseSearch(u,r);if(s){}}catch(t){g("Search",t,Log.Type.Error)}};this.GetProperties=function(){try{g("GetProperties","Called");var r=this.GetBaseProperties();r[r.length]=new PropertyEd.Property(b.ID,this.GetID,this.SetID);r[r.length]=new PropertyEd.Property(b.Caption,this.GetCaption,this.SetCaption);return r}catch(s){g("GetProperties",s,Log.Type.Error)}};this.GetID=function(){try{return j.attr("id")}catch(r){g("GetID",r,Log.Type.Error)}};this.SetID=function(r){try{j.attr("id",r)}catch(s){g("SetID",s,Log.Type.Error)}};this.GetCaption=function(){try{return n.text()}catch(r){g("GetCaption",r,Log.Type.Error)}};this.SetCaption=function(s){try{n.text(s)}catch(r){g("SetCaption",r,Log.Type.Error)}}}catch(h){g("Main",h,Log.Type.Error)}}return a});define("StaticContainer",["TemplateBase","PropertyFields","PageHelper","Editor","ContextMenu"],function(c,a,e,b,d){function f(){try{this.inheritFrom=c;this.inheritFrom();this.NameRequired=false;this.refClassName="StaticCont";this.Accept=["StaticContainer","EditorText","EditorLabel","EditorDiv","EditorDropDown","EditorMemo","EditorCheckBox","EditorSubmitButton","EditorRadio","EditorLink","TransferList"];var h=this;var o=null;var g=null;var m=false;function j(s,r,q,p){h.Log(h.refClassName+"."+s,r,q,p)}function l(){try{if(m){return}j("AddFeatures","Called");o.droppable({accept:b.GetAcceptedComponents(h.Accept),greedy:true,activeClass:"droppable-active",hoverClass:"droppable-hover",drop:function(s,t){var r=$(t.draggable).attr("ref");var u={left:t.offset.left-$(this).offset().left,top:t.offset.top-$(this).offset().top};b.BuildComponent(r,$(this),u)}});o.delegate(".moving","mousedown",function(){b.DisableSelectibleInIE(o,true)});o.delegate(".moving","mouseup",function(){b.DisableSelectibleInIE(o,false)});var p=e.GetParentRef(o);if($.inArray(p,["StaticContainer"])>-1){o.draggable({containment:"parent",handle:g,grid:MP.Tools.Config.Editor.html.snap,start:h.onDragStart,stop:h.onDragStop});o.resizable({autoHide:true,grid:MP.Tools.Config.Editor.html.snap,stop:function(){var s=Utilities.ToNumber($(this).css("top"));$(this).css("top",s+1);var r=Utilities.ToNumber($(this).css("left"));$(this).css("left",r+1)}})}o.selectable({filter:".moving",cancel:".handle",selected:function(t,s){var u=e.GetParentID($(s.selected));var r=e.GetParentRef($(s.selected));if(r!="StaticContainer"){e.AddSelected(u)}},start:function(s,r){Global.DisableHighlightingInChrome(true);e.ClearSelected();d.Hide()},stop:function(s,r){Global.DisableHighlightingInChrome(false)}});g.addClass("moving");m=true}catch(q){j("AddFeatures",q,Log.Type.Error)}}function n(){try{if(!m){return}j("RemoveFeatures","Called");o.droppable("destroy").draggable("destroy").resizable("destroy").selectable("destroy");g.removeClass("moving");m=false}catch(p){j("RemoveFeatures",p,Log.Type.Error)}}this.SetFeatures=function(p){m=p};this.AppendTo=function(p){try{j("AppendTo","Called");$(p).append(o);this.BaseLoad(o);if(b.Enabled){this.EditMode()}}catch(q){j("AppendTo",q,Log.Type.Error)}};this.Create=function(){try{j("Create","Called");o=$("<div condition='' class='component StaticContainer' ref='StaticContainer'><h3 class='handle'>Static Container</h3></div>");g=$(o.find("h3"))}catch(p){j("Create",p,Log.Type.Error)}};this.DefaultMode=function(){try{j("DefaultMode","Called");n();e.RemoveComponentID(o)}catch(p){j("DefaultMode",p,Log.Type.Error)}};this.EditMode=function(){try{j("EditMode","Called");l()}catch(p){j("EditMode",p,Log.Type.Error)}};this.Search=function(s,p){try{j("Search","Called",Log.Type.Info);var q=this.BaseSearch(s,p);if(q){}}catch(r){j("Search",r,Log.Type.Error)}};this.GetProperties=function(){try{j("GetProperties","Called");var q=this.GetBaseProperties();q[q.length]=new PropertyEd.Property(a.Borderless,this.GetBorderless,this.SetBorderless);q[q.length]=new PropertyEd.Property(a.ID,this.GetID,this.SetID);q[q.length]=new PropertyEd.Property(a.Caption,this.GetCaption,this.SetCaption);q[q.length]=new PropertyEd.Property(a.Height,this.GetHeight,this.SetHeight);var p=e.GetParentRef(o);if(p=="StaticContainer"){q[q.length]=new PropertyEd.Property(a.Width,this.GetWidth,this.SetWidth)}return q}catch(r){j("GetProperties",r,Log.Type.Error)}};this.Refresh=function(){try{j("Refresh","Called")}catch(p){j("Refresh",p,Log.Type.Error)}};this.Load=function(p){try{j("Load","Called");o=$(p);this.BaseLoad(o);g=$(o.find(">h3"))}catch(q){j("Load",q,Log.Type.Error)}};this.GetBorderless=function(){try{return o.hasClass("borderless")}catch(p){j("GetBorderless",p,Log.Type.Error)}};this.GetCaption=function(){try{return g.text()}catch(p){j("GetCaption",p,Log.Type.Error)}};this.GetControl=function(){try{return o}catch(p){j("GetControl",p,Log.Type.Error)}};this.SetBorderless=function(p){try{if(p){o.addClass("borderless")}else{o.removeClass("borderless")}}catch(q){j("SetBorderless",q,Log.Type.Error)}};this.SetCaption=function(q){try{g.text(q);if(g.text()==""){g.css("visibility","hidden")}else{g.css("visibility","visible")}}catch(p){j("SetCaption",p,Log.Type.Error)}};this.GetHeight=function(){try{return Utilities.ToNumber(o.height())}catch(p){j("GetHeight",p,Log.Type.Error)}};this.SetHeight=function(p){try{o.height(Utilities.ToNumber(p))}catch(q){j("SetHeight",q,Log.Type.Error)}};this.GetID=function(){try{return o.attr("id")}catch(p){j("GetID",p,Log.Type.Error)}};this.SetID=function(p){try{o.attr("id",p)}catch(q){j("SetID",q,Log.Type.Error)}};this.GetWidth=function(){try{return Utilities.ToNumber(o.width())}catch(p){j("GetWidth",p,Log.Type.Error)}};this.SetWidth=function(q){try{o.width(Utilities.ToNumber(q))}catch(p){j("SetWidth",p,Log.Type.Error)}}}catch(k){j("Main",k,Log.Type.Error)}}return f});define("ScriptingContainer",["TemplateBase","PropertyFields","Utilities","PageHelper","Editor"],function(f,b,e,g,c){function d(){try{this.inheritFrom=f;this.inheritFrom();this.NameRequired=false;this.refClassName="ScriptCont";var s=this;var m=null;var p=null;var q=null;var o=false;function h(w,v,u,t){s.Log(s.refClassName+"."+w,v,u,t)}function r(z){try{h("GetFunctions","Called");z="\n"+z.substring(z.indexOf("function "),z.length);var x=new Array();var C=z.split(/[\n\r]function /);if(!C){return x}for(var w=0;w<C.length;w++){var A=C[w];var B=A.substring(0,A.indexOf("{"));var v=B.match(/\([^\)]+\)/g);if(v==null||v.length==0){v=""}else{v=v[0]}v=v.replace("(","").replace(")","");if(B.indexOf("(")>-1){B=B.substring(0,B.indexOf("("))}if(!B){continue}var y=A.substring(A.indexOf("{")+1);y=y.substring(0,y.lastIndexOf("}"));var t=new a(B,v,y);x.push(t)}return x}catch(u){h("GetFunctions",u,Log.Type.Error)}}function n(t){try{h("AttachScript","Called");var v=r(t);if(!v.length){return}CustomScript.Reset();var z="";var x=null;for(var u=0;u<v.length;u++){try{x=v[u];CustomScript[x.Name]=new Function(x.Params,x.Body)}catch(y){var w=x.Name+" : "+y.message;z=z+w+"\n";h("AttachScript",w,Log.Type.Error,true)}}return z}catch(y){h("AttachScript",y,Log.Type.Error,true);return y.message}}function l(){try{if(o){return}h("AddFeatures","Called");m.css("display","block");p.addClass("moving");p.toggle(function(){q.css("display","block")},function(){q.css("display","none")});o=true}catch(t){h("AddFeatures",t,Log.Type.Error)}}function k(){try{if(!o){return}h("RemoveFeatures","Called");p.removeClass("moving");o=false}catch(t){h("RemoveFeatures",t,Log.Type.Error)}}this.SetFeatures=function(t){o=t};this.AppendTo=function(t){try{h("AppendTo","Called");$(t).append(m);this.BaseLoad(m);if(c.Enabled){this.EditMode()}}catch(u){h("AppendTo",u,Log.Type.Error)}};this.Create=function(){try{h("Create","Called");m=$("<div condition='' class='component ScriptingContainer' ref='ScriptingContainer'><h3 class='handle'>Custom Scripts/JS Container</h3><pre>function OnLoad(){scroll(0,0);}</pre></div>");p=$(m.find(">h3"));q=$(m.find(">pre"))}catch(t){h("Create",t,Log.Type.Error)}};this.DefaultMode=function(t){try{h("DefaultMode","Called");$(m).css("display","none");k();var x=m.text();var v=r(x);if(!v.length){return false}if(t){CustomScript.Reset()}var z="";var w=null;for(var u=0;u<v.length;u++){try{w=v[u];CustomScript[w.Name]=new Function(w.Params,w.Body)}catch(y){if(w){z=z+w.Name+" : "+y.message+", "}else{z=z+y.message+", "}}}if(z!=""){h("DefaultMode",z,Log.Type.Error,true)}g.RemoveComponentID(m);return true}catch(y){h("DefaultMode",y,Log.Type.Error)}};this.EditMode=function(){try{h("EditMode","Called");l()}catch(t){h("EditMode",t,Log.Type.Error)}};this.Search=function(w,t){try{h("Search","Called",Log.Type.Info);var u=this.BaseSearch(w,t);if(u){if(this.GetScripts().search(u)>-1){h("Search",this,Log.Type.Search)}}}catch(v){h("Search",v,Log.Type.Error)}};this.GetProperties=function(){try{h("GetProperties","Called");var t=this.GetBaseProperties();t[t.length]=new PropertyEd.Property(b.ID,this.GetID,this.SetID);t[t.length]=new PropertyEd.Property(b.Scripts,this.GetScripts,this.SetScripts);return t}catch(u){h("GetProperties",u,Log.Type.Error)}};this.Refresh=function(){try{h("Refresh","Called")}catch(t){h("Refresh",t,Log.Type.Error)}};this.Load=function(t){try{h("Load","Called");m=$(t);this.BaseLoad(m);p=$(m.find(">h3"));q=$(m.find(">div"));if(!q.length){q=$(m.find(">pre"))}q.css("display","none");var u=q.text();q.text(u)}catch(v){h("Load",v,Log.Type.Error)}};this.Show=function(t){h("Show","Called");m.css("display","block");m.html(t)};this.Hide=function(){h("Hide","Called");m.html("");m.css("display","none")};this.GetControl=function(){try{return m}catch(t){h("GetControl",t,Log.Type.Error)}};this.GetID=function(){try{return m.attr("id")}catch(t){h("GetID",t,Log.Type.Error)}};this.SetID=function(t){try{m.attr("id",t)}catch(u){h("SetID",u,Log.Type.Error)}};this.GetScripts=function(){try{return q.text()}catch(t){h("GetScripts",t,Log.Type.Error)}};this.SetScripts=function(u){try{h("SetScripts","Called");q.text(u);var v=n(u);if(v!=""){jAlert("The following functions may have errors:\n"+v+"Errors due to #S variables may be OK within the editor.")}CustomScript.Reset()}catch(t){h("SetScripts",t,Log.Type.Error)}}}catch(j){h("Main",j,Log.Type.Error)}}CustomScript=new function(){try{this.Reset=function(){jQuery.each(CustomScript,function(k,j){if(k!="Reset"){CustomScript[k]=null}})}}catch(h){iLog(".CustomScript",h,Log.Type.Error)}};function a(j,k,h){this.Name=j;this.Params=k;this.Body=h}return d});define("ValidationContainer",["TemplateBase","PropertyFields","PageHelper","Editor"],function(d,a,e,c){function b(){try{this.inheritFrom=d;this.inheritFrom();this.NameRequired=false;this.refClassName="ValidCont";var p=this;var k=null;var m=false;var o=null;var n=null;var g="Errors were found, please resolve the following before re-submitting";function f(t,s,r,q){p.Log(p.refClassName+"."+t,s,r,q)}function l(){try{if(m){return}f("AddFeatures","Called");k.css("display","block");o.addClass("moving");m=true}catch(q){f("AddFeatures",q,Log.Type.Error)}}function j(){try{if(!m){return}f("RemoveFeatures","Called");k.css("display","none");o.removeClass("moving");m=false}catch(q){f("RemoveFeatures",q,Log.Type.Error)}}this.SetFeatures=function(q){m=q};this.Refresh=function(){try{f("Refresh","Called")}catch(q){f("Refresh",q,Log.Type.Error)}};this.AppendTo=function(q){try{f("AppendTo","Called");$(q).append(k);this.BaseLoad(k);if(c.Enabled){this.EditMode()}}catch(r){f("AppendTo",r,Log.Type.Error)}};this.Create=function(){try{f("Create","Called");k=$("<div condition='' class='component ValidationContainer' ref='ValidationContainer'><h3 class='handle'>"+g+"</h3><div/></div>");o=k.find(">h3");n=k.find(">div")}catch(q){f("Create",q,Log.Type.Error)}};this.DefaultMode=function(){try{f("DefaultMode","Called");j();e.RemoveComponentID(k)}catch(q){f("DefaultMode",q,Log.Type.Error)}};this.EditMode=function(){try{f("EditMode","Called");l()}catch(q){f("EditMode",q,Log.Type.Error)}};this.Search=function(t,q){try{f("Search","Called",Log.Type.Info);var r=this.BaseSearch(t,q);if(r){}}catch(s){f("Search",s,Log.Type.Error)}};this.GetProperties=function(){try{f("GetProperties","Called");var q=this.GetBaseProperties();q[q.length]=new PropertyEd.Property(a.ID,this.GetID,this.SetID);q[q.length]=new PropertyEd.Property(a.Caption,this.GetCaption,this.SetCaption);return q}catch(r){f("GetProperties",r,Log.Type.Error)}};this.Load=function(q){try{f("Load","Called");k=$(q);this.BaseLoad(k);o=k.find(">h3");n=k.find(">div");if(!n.length){n=$("<div/>");k.append(n)}}catch(r){f("Load",r,Log.Type.Error)}};this.Show=function(r){f("Show","Called");k.css("display","block");n.html(r);var q=o.html();if(q==""){o.remove()}if(q.match(/Validation Errors/)){o.html(g)}};this.Hide=function(){f("Hide","Called");n.html("");k.css("display","none")};this.GetCaption=function(){try{return o.text()}catch(q){f("GetCaption",q,Log.Type.Error)}};this.GetControl=function(){try{return k}catch(q){f("GetControl",q,Log.Type.Error)}};this.GetID=function(){try{return k.attr("id")}catch(q){f("GetID",q,Log.Type.Error)}};this.SetCaption=function(r){try{o.text(r)}catch(q){f("SetCaption",q,Log.Type.Error)}};this.SetID=function(q){try{k.attr("id",q)}catch(r){f("SetID",r,Log.Type.Error)}}}catch(h){f("Main",h,Log.Type.Error)}}return b});define("rules/BaseComponent",["PropertyFields","RuleXML"],function(b,a){function c(){this.Type=null;this.Icon=null;this.OldEntry=null;this.OldExit=null;var f="BaseComp.";var d=this;var g=null;var e=null;function h(m,l,k,j){Log.Add(d.GetID()+"."+f+m,l,k,j)}this.BaseCreate=function(){try{g=$(a.GetNewElement("c"));g.append(a.GetNewElement("n"));g.append(a.GetNewElement("t"));g.append(a.GetNewElement("values"));g.append(a.GetNewElement("j"));g.append(a.GetNewElement("j"));var k;k=$(a.GetNewElement("x"));k.text("0");g.append(k);k=$(a.GetNewElement("y"));k.text("0");g.append(k);g.append(a.GetNewElement("c"));g.append(a.GetNewElement("wp"));var j=a.GetNextComponentNumber();g.find(">n").text(j)}catch(l){h("BaseCreate",l,Log.Type.Error)}};this.BaseLoad=function(j){try{g=$(j);this.Type=g.find(">t").text();if(g.find(">c").length==0){g.append(a.GetNewElement("c"))}if(g.find(">wp").length==0){g.append(a.GetNewElement("wp"))}}catch(k){h("BaseLoad",k,Log.Type.Error)}};this.Delete=function(){var j=this.GetIcon();j.Delete();j=null};this.GetIcon=function(){return this.Icon};this.GetNode=function(){try{return g}catch(j){h("GetNode",j,Log.Type.Error)}};this.GetFormatedData=function(){try{var j;j=Utilities.GetXmlString(g[0]);j=Utilities.RemoveWhiteSpaces(j);return j}catch(k){h("GetFormatedData",k,Log.Type.Error)}};this.UpdateWatchpoint=function(){try{var j=this.GetWatchpoint();this.HighlightAsWatchpoint(j)}catch(k){h("UpdateWatchpoint",k,Log.Type.Error)}};this.ToggleWatchpoint=function(){try{var j=!this.GetWatchpoint();this.SetWatchpoint(j);this.HighlightAsWatchpoint(j)}catch(k){h("ToggleWatchpoint",k,Log.Type.Error)}};this.GetBaseProperties=function(){var j=new Array();j[j.length]=new PropertyEd.Property(b.ID,this.GetID,null);j[j.length]=new PropertyEd.Property(b.Comment,this.GetComment,this.SetComment);j[j.length]=new PropertyEd.Property(b.Watchpoint,this.GetWatchpoint,this.SetWatchpoint);return j};this.GetID=function(){try{return g.find(">n").text()}catch(j){h("GetID",j,Log.Type.Error)}};this.GetComment=function(){try{return g.find(">c").text()}catch(j){h("GetComment",j,Log.Type.Error)}};this.SetComment=function(k){try{$(g.find(">c")[0]).text(k);e.UpdateComment()}catch(j){h("SetComment",j,Log.Type.Error)}};this.GetWatchpoint=function(){try{return g.find(">wp").text()=="1"}catch(j){h("GetWatchpoint",j,Log.Type.Error)}};this.SetWatchpoint=function(k){try{$(g.find(">wp")[0]).text(k?"1":"0")}catch(j){h("SetWatchpoint",j,Log.Type.Error)}};this.GetJ1=function(){try{return $(g.find(">j")[0]).text()}catch(j){h("GetJ1",j,Log.Type.Error)}};this.GetX=function(){try{return parseInt(g.find(">x").text(),10)}catch(j){h("GetX",j,Log.Type.Error)}};this.GetY=function(){try{return parseInt(g.find(">y").text(),10)}catch(j){h("GetY",j,Log.Type.Error)}};this.SetIcon=function(j){this.Icon=j;e=j};this.SetJ1=function(k){try{$(g.find(">j")[0]).text(k)}catch(j){h("SetJ1",j,Log.Type.Error)}};this.SetType=function(k){try{$(g.find(">t")[0]).text(k)}catch(j){h("SetType",j,Log.Type.Error)}};this.SetX=function(k){try{$(g.find(">x")[0]).text(Utilities.ToNumber(k))}catch(j){h("SetX",j,Log.Type.Error)}};this.SetY=function(k){try{$(g.find(">y")[0]).text(Utilities.ToNumber(k))}catch(j){h("SetY",j,Log.Type.Error)}};this.HighlightAsSelected=function(l){var k=this.Icon.GetImage();var j="ui-selected";k.toggleClass(j,l);if(l){this.HighlightAsWatchpoint(false)}else{this.UpdateWatchpoint()}};this.HighlightAsFound=function(l){var k=this.Icon.GetImage();var j=Browser.IsMSIE()?"ui-searchIE":"ui-search";k.toggleClass(j,l);if(l){this.HighlightAsWatchpoint(false)}else{this.UpdateWatchpoint()}};this.HighlightAsError=function(l){var k=this.Icon.GetImage();var j=Browser.IsMSIE()?"ui-errorIE":"ui-error";k.toggleClass(j,l);if(l){this.HighlightAsWatchpoint(false)}else{this.UpdateWatchpoint()}};this.HighlightAsWatchpoint=function(l){var k=this.Icon.GetImage();var j=Browser.IsMSIE()?"ui-watchpointIE":"ui-watchpoint";k.toggleClass(j,l)};this.HighlightAsConnecting=function(l){var k=this.Icon.GetImage();var j=Browser.IsMSIE()?"ui-connectingIE":"ui-connecting";k.toggleClass(j,l);if(l){this.HighlightAsWatchpoint(false)}else{this.UpdateWatchpoint()}}}return c});define("rules/component/CompiledScriptFunction",["rules/BaseComponent","PropertyFields","Utilities","RuleXML","rules/CDATABatch","Undo","UndoObject"],function(d,c,f,b,a,h,g){function e(){this.inheritFrom=d;this.inheritFrom();this.Src="../../images/ruleCOMPILEDSCRIPT.png";this.Title="Script Function Component";this.ToolTip="Executes stingray functions";var l="CSF.";var k=this;var j=null;function n(r,q,p,o){Log.Add(k.GetID()+"."+l+r,q,p,o)}function m(o,p){this.Name=o;this.Value=p}this.Create=function(){try{this.BaseCreate();this.SetType("CSF");j=this.GetNode();var p=$(j.find(">values")[0]);p.append(b.GetNewElement("n"));p.append(b.GetNewElement("v"));p.find(">n").text("GetConstant")}catch(o){n("Create",o,Log.Type.Error)}};this.Load=function(o){try{j=$(o);this.BaseLoad(j)}catch(p){n("Load",p,Log.Type.Error)}};this.Search=function(s,o){try{n("Search","Called",Log.Type.Info);this.HighlightAsFound(false);if(!s){return}var p=(o)?new RegExp(s,""):new RegExp(s,"i");var r=$.grep(this.GetFunction(),function(t){return t.Value.search(p)>-1});if(this.GetID().search(p)>-1||this.GetComment().search(p)>-1||r.length>0){n("Search",this,Log.Type.Search)}}catch(q){n("Search",q,Log.Type.Error)}};this.AddParam=function(){try{}catch(o){n("AddParam",o,Log.Type.Error)}};this.DeleteFunction=function(){try{}catch(o){n("DeleteFunction",o,Log.Type.Error)}};this.GetProperties=function(){try{var p=this.GetBaseProperties();var o=new RulesMaker.ComplexArgs(this.GetProperties,null,null);p[p.length]=new PropertyEd.Property(c.CompiledScriptFunction,this.GetFunction,this.SetFunction,o);return p}catch(q){n("GetProperties",q,Log.Type.Error)}};this.GetFunction=function(){try{var p=new Array();$(j.find(">values")[0]).find(">n").each(function(){var r=$(this).text();var q=$(this).next().text();q=q.replace(/''/g,"'");p[p.length]=new m(r,q)});return p}catch(o){n("GetFunction",o,Log.Type.Error)}};this.SetFunction=function(q){try{var o=$(j.find(">values")[0]);o.empty();$.each(q,function(r,v){var u,t;t=v.Name;u=$(b.GetNewElement("n"));o.append(u);u.text(t);t=v.Value||"",u=$(b.GetNewElement("v"));o.append(u);t=t.replace(/'/g,"''");b.ReplaceCDATA(u,t)})}catch(p){n("SetFunction",p,Log.Type.Error)}}}return e});define("rules/component/Script",["rules/BaseComponent","PropertyFields","RuleXML","Undo","UndoObject"],function(d,c,a,f,e){function b(){this.inheritFrom=d;this.inheritFrom();this.Src="../../images/RulePascal.png";this.Title="Scripting Component";this.ToolTip="Add scripting code";var j="Script.";var h=this;var g=null;function k(o,n,m,l){Log.Add(j+o+"."+h.GetID(),n,m,l)}this.Create=function(){try{this.BaseCreate();this.SetType("SCRIPT");g=this.GetNode();var l=$(g.find(">values")[0]);l.append(a.GetNewElement("v"));l.append(a.GetNewElement("lng"))}catch(m){k("Create",m,Log.Type.Error)}};this.Load=function(m){try{g=$(m);this.BaseLoad(g);if(g.find(">values>lng").length==0){var l=g.find(">values");l.append(a.GetNewElement("lng"))}}catch(n){k("Load",n,Log.Type.Error)}};this.Search=function(o,l){try{k("Search","Called",Log.Type.Info);this.HighlightAsFound(false);if(!o){return}var m=(l)?new RegExp(o,""):new RegExp(o,"i");if(this.GetID().search(m)>-1||this.GetComment().search(m)>-1||this.GetScript().search(m)>-1){k("Search",this,Log.Type.Search)}}catch(n){k("Search",n,Log.Type.Error)}};this.GetProperties=function(){try{var l=this.GetBaseProperties();l[l.length]=new PropertyEd.Property(c.Language,this.GetLanguage,this.SetLanguage);l[l.length]=new PropertyEd.Property(c.SCRIPT,this.GetScript,this.SetScript);return l}catch(m){k("GetProperties",m,Log.Type.Error)}};this.GetScript=function(){try{return $(g.find(">values>v")[0]).text()}catch(l){k("GetScript",l,Log.Type.Error)}};this.SetScript=function(m){try{a.ReplaceCDATA(g.find(">values>v")[0],m)}catch(l){k("SetScript",l,Log.Type.Error)}};this.GetLanguage=function(){try{var m=$(g.find(">values>lng")[0]).text();if(m=="Pascal"){m="Server Script"}return m}catch(l){k("GetLanguage",l,Log.Type.Error)}};this.SetLanguage=function(m){try{if(m=="Server Script"){m="Pascal"}$(g.find(">values>lng")[0]).text(m)}catch(l){k("SetLanguage",l,Log.Type.Error)}}}return b});define("rules/component/SqlTrn",["rules/BaseComponent","PropertyFields","RuleXML","Undo","UndoObject"],function(c,b,a,f,e){function d(){this.inheritFrom=c;this.inheritFrom();this.Src="../../images/RuleSqlTrn.png";this.Title="SQL Transaction Component";this.ToolTip="Add SQL Transaction";var j="SqlTrn.";var h=this;var g=null;function k(o,n,m,l){Log.Add(j+o+"."+h.GetID(),n,m,l)}this.Create=function(){try{this.BaseCreate();this.SetType("SQLTRN");g=this.GetNode();var l=$(g.find(">values")[0]);l.append(a.GetNewElement("n"));l.append(a.GetNewElement("t"))}catch(m){k("Create",m,Log.Type.Error)}};this.Load=function(l){try{g=$(l);this.BaseLoad(g)}catch(m){k("Load",m,Log.Type.Error)}};this.Search=function(o,l){try{k("Search","Called",Log.Type.Info);this.HighlightAsFound(false);if(!o){return}var m=(l)?new RegExp(o,""):new RegExp(o,"i");if(this.GetID().search(m)>-1||this.GetComment().search(m)>-1||this.GetSqlTrnName().search(m)>-1||this.GetSqlTrnType().search(m)>-1){k("Search",this,Log.Type.Search)}}catch(n){k("Search",n,Log.Type.Error)}};this.GetProperties=function(){try{var l=this.GetBaseProperties();l[l.length]=new PropertyEd.Property(b.SqlTrnName,this.GetSqlTrnName,this.SetSqlTrnName);l[l.length]=new PropertyEd.Property(b.SqlTrnType,this.GetSqlTrnType,this.SetSqlTrnType);return l}catch(m){k("GetProperties",m,Log.Type.Error)}};this.GetSqlTrnName=function(){try{return $(g.find(">values>n")[0]).text()}catch(l){k("GetSqlTrnName",l,Log.Type.Error)}};this.SetSqlTrnName=function(m){try{$(g.find(">values>n")[0]).text(m)}catch(l){k("SetSqlTrnName",l,Log.Type.Error)}};this.GetSqlTrnType=function(){try{return $(g.find(">values>t")[0]).text()}catch(l){k("GetSqlTrnType",l,Log.Type.Error)}};this.SetSqlTrnType=function(m){try{$(g.find(">values>t")[0]).text(m)}catch(l){k("SetSqlTrnType",l,Log.Type.Error)}}}return d});define("rules/component/Error",["rules/BaseComponent","PropertyFields","RuleXML","Undo","UndoObject"],function(c,b,a,f,e){function d(){this.inheritFrom=c;this.inheritFrom();this.Src="../../images/RuleERROR.png";this.Title="ERROR Component";this.ToolTip="Displays an html message to the user when an error occurs";var j="Error.";var h=this;var g=null;function k(o,n,m,l){Log.Add(j+o+"."+h.GetID(),n,m,l)}this.Create=function(){try{this.BaseCreate();this.SetType("ERROR");g=this.GetNode();var l=$(g.find(">values")[0]);l.append(a.GetNewElement("v"))}catch(m){k("Create",m,Log.Type.Error)}};this.Load=function(l){try{g=$(l);this.BaseLoad(g)}catch(m){k("Load",m,Log.Type.Error)}};this.Search=function(o,l){try{k("Search","Called",Log.Type.Info);this.HighlightAsFound(false);if(!o){return}var m=(l)?new RegExp(o,""):new RegExp(o,"i");if(this.GetID().search(m)>-1||this.GetComment().search(m)>-1||this.GetErrorMessage().search(m)>-1){k("Search",this,Log.Type.Search)}}catch(n){k("Search",n,Log.Type.Error)}};this.GetProperties=function(){try{var l=this.GetBaseProperties();l[l.length]=new PropertyEd.Property(b.ErrorMessage,this.GetErrorMessage,this.SetErrorMessage);return l}catch(m){k("GetProperties",m,Log.Type.Error)}};this.GetErrorMessage=function(){try{return $(g.find(">values>v")[0]).text()}catch(l){k("GetErrorMessage",l,Log.Type.Error)}};this.SetErrorMessage=function(m){try{a.ReplaceCDATA(g.find(">values>v")[0],m)}catch(l){k("SetErrorMessage",l,Log.Type.Error)}};this.SetJ1=null}return d});define("rules/component/External",["rules/BaseComponent","PropertyFields","RuleXML","Undo","UndoObject"],function(c,b,a,f,e){function d(){this.inheritFrom=c;this.inheritFrom();this.Title="External Component";this.ToolTip="Delivers a template to the specified screen target after executing the pre-process function";this.Src="../../images/RuleEXTERNAL.png";var j="External.";var h=this;var g=null;function k(o,n,m,l){Log.Add(j+o+"."+h.GetID(),n,m,l)}this.Create=function(){try{this.BaseCreate();this.SetType("EXTERNAL");g=this.GetNode();var l=$(g.find(">values")[0]);l.append(a.GetNewElement("n"))}catch(m){k("Create",m,Log.Type.Error)}};this.Load=function(l){try{g=$(l);this.BaseLoad(g)}catch(m){k("Load",m,Log.Type.Error)}};this.Search=function(o,l){try{k("Search","Called",Log.Type.Info);this.HighlightAsFound(false);if(!o){return}var m=(l)?new RegExp(o,""):new RegExp(o,"i");if(this.GetID().search(m)>-1||this.GetComment().search(m)>-1||this.GetRuleName().search(m)>-1){k("Search",this,Log.Type.Search)}}catch(n){k("Search",n,Log.Type.Error)}};this.GetProperties=function(){try{var l=this.GetBaseProperties();l[l.length]=new PropertyEd.Property(b.RuleName,this.GetRuleName,this.SetRuleName);return l}catch(m){k("GetProperties",m,Log.Type.Error)}};this.GetRuleName=function(){try{return $(g.find(">values>n")[0]).text()}catch(l){k("GetRuleName",l,Log.Type.Error)}};this.SetRuleName=function(l){try{$(g.find(">values>n")[0]).text(l)}catch(m){k("SetRuleName",m,Log.Type.Error)}}}return d});define("rules/component/If",["rules/BaseComponent","PropertyFields","RuleXML","Undo","UndoObject"],function(c,b,a,f,d){function e(){this.inheritFrom=c;this.inheritFrom();this.Src="../../images/RuleIF.png";this.Title="IF Component";this.ToolTip="Makes a binary decision to determine which of two components will be called next";var j="IF.";var h=this;var g=null;function k(o,n,m,l){Log.Add(j+o+"."+h.GetID(),n,m,l)}this.Create=function(){try{this.BaseCreate();this.SetType("IF");g=this.GetNode();var l=$(g.find(">values")[0]);l.append(a.GetNewElement("v"))}catch(m){k("Create",m,Log.Type.Error)}};this.Load=function(l){try{g=$(l);this.BaseLoad(g)}catch(m){k("Load",m,Log.Type.Error)}};this.Search=function(o,l){try{k("Search","Called",Log.Type.Info);this.HighlightAsFound(false);if(!o){return}var m=(l)?new RegExp(o,""):new RegExp(o,"i");if(this.GetID().search(m)>-1||this.GetComment().search(m)>-1||this.GetSvrCondition().search(m)>-1){k("Search",this,Log.Type.Search)}}catch(n){k("Search",n,Log.Type.Error)}};this.GetProperties=function(){try{var l=this.GetBaseProperties();l[l.length]=new PropertyEd.Property(b.SvrCondition,this.GetSvrCondition,this.SetSvrCondition);return l}catch(m){k("GetProperties",m,Log.Type.Error)}};this.GetSvrCondition=function(){try{var l=$(g.find(">values>v")[0]).text();return l.replace(/''/g,"'")}catch(m){k("GetSvrCondition",m,Log.Type.Error)}};this.SetSvrCondition=function(m){try{var l=m.replace(/'/g,"''");var p=a.GetNewCDATA(l);var o=a.GetNewElement("v");$(o).append(p);g.find(">values")[0].replaceChild(o,g.find(">values>v")[0])}catch(n){k("SetSvrCondition",n,Log.Type.Error)}};this.GetJ2=function(){try{return $(g.find(">j")[1]).text()}catch(l){k("GetJ2",l,Log.Type.Error)}};this.SetJ2=function(m){try{$(g.find(">j")[1]).text(m)}catch(l){k("SetJ2",l,Log.Type.Error)}}}return e});define("rules/component/InsertUpdateQuery",["rules/BaseComponent","PropertyFields","Utilities","RuleXML","Undo","UndoObject"],function(c,b,d,a,g,e){function f(){this.inheritFrom=c;this.inheritFrom();this.Src="../../images/RuleINSERTUPDATEQUERY.png";this.Title="Insert / Update Query Component";this.ToolTip="Performs a SQL Insert or Update command";var l="InsertUpdateQuery.";var k=this;var j=null;function m(q,p,o,n){Log.Add(l+q+"."+k.GetID(),p,o,n)}function h(n,p,o){this.Name=n;this.Type=p;this.Value=o}this.Create=function(){try{this.BaseCreate();this.SetType("INSERTUPDATEQUERY");j=this.GetNode();var n=$(j.find(">values")[0]);n.append(a.GetNewElement("query"))}catch(o){m("Create",o,Log.Type.Error)}};this.Load=function(n){try{j=$(n);this.BaseLoad(j)}catch(o){m("Load",o,Log.Type.Error)}};this.AddParam=function(o){try{var n=$(j.find(">values")[0]);var q=$(a.GetNewElement("param"));var r;r=a.GetNewElement("n");q.append(r);if(o){$(r).text(d.Trim(o.Name))}r=a.GetNewElement("t");q.append(r);if(o){$(r).text(d.Trim(o.Type))}r=a.GetNewElement("v");q.append(r);if(o){$(r).html(a.GetNewCDATA(d.Trim(o.Value)))}n.append(q)}catch(p){m("AddParam",p,Log.Type.Error)}};this.DeleteParam=function(n){try{var o=j.find(">values>param")[n];o.parentNode.removeChild(o)}catch(p){m("DeleteParam",p,Log.Type.Error)}};this.Search=function(s,o){try{m("Search","Called",Log.Type.Info);this.HighlightAsFound(false);if(!s){return}var q=(o)?new RegExp(s,""):new RegExp(s,"i");if(this.GetID().search(q)>-1||this.GetComment().search(q)>-1||this.GetQuery().search(q)>-1){m("Search",this,Log.Type.Search);return}var n=this.GetQueryParams();for(var p=0;p<n.length;p++){if(n[p].Name.search(q)>-1||n[p].Value.search(q)>-1){m("Search",this,Log.Type.Search);return}}}catch(r){m("Search",r,Log.Type.Error)}};this.GetProperties=function(){try{var o=this.GetBaseProperties();o[o.length]=new PropertyEd.Property(b.Query,this.GetQuery,this.SetQuery);var n=new RulesMaker.ComplexArgs(this.GetProperties,null,null);o[o.length]=new PropertyEd.Property(b.QueryParams,this.GetQueryParams,this.SetQueryParams,n);return o}catch(p){m("GetProperties",p,Log.Type.Error)}};this.GetQuery=function(){try{var n=$(j.find(">values>query")[0]).text();return n.replace(/''/g,"'")}catch(o){m("GetQuery",o,Log.Type.Error)}};this.SetQuery=function(r){try{var n=r.replace(/'/g,"''");var q=a.GetNewCDATA(n);var p=a.GetNewElement("query");$(p).append(q);j.find(">values")[0].replaceChild(p,j.find(">values>query")[0])}catch(o){m("SetQuery",o,Log.Type.Error)}};this.GetQueryParams=function(){try{var o=new Array();j.find(">values>param").each(function(){var r=$(this);var s=r.find(">n").text();var q=r.find(">t").text().toUpperCase();var p=r.find(">v").text();o.push(new h(s,q,p))});return o}catch(n){m("GetQueryParams",n,Log.Type.Error)}};this.SetQueryParams=function(u){try{var q,o,r,p;var t=[];var n=j.find(">values>param");for(q=0;q<n.length;q++){k.DeleteParam(0)}for(q=0;q<u.length;q++){r=d.Trim(u[q].Name);if(r){k.AddParam(u[q]);t.push(r)}}for(q=0;q<t.length;q++){r=t[q].toUpperCase();for(o=0;o<t.length;o++){p=t[o].toUpperCase();if(o!=q&&p==r){jAlert("The parameter '"+t[q]+"' is used more than once!");return}}}}catch(s){m("SetQueryParams",s,Log.Type.Error)}}}return f});define("rules/component/Math",["rules/BaseComponent","PropertyFields","RuleXML","Undo","UndoObject"],function(d,c,b,f,e){function a(){this.inheritFrom=d;this.inheritFrom();this.Src="../../images/RuleMATH.png";this.Title="Math Component";this.ToolTip="Create, modify, or delete multiple variables with mathematical expressions";var j="Math.";var h=this;var g=null;function l(p,o,n,m){Log.Add(j+p+"."+h.GetID(),o,n,m)}function k(m,o,n){this.Name=m;this.Format=o;this.Value=n}this.Create=function(){try{this.BaseCreate();this.SetType("MATH");g=this.GetNode();var m=$(g.find(">values")[0]);m.append(b.GetNewElement("n"));m.append(b.GetNewElement("f"));m.append(b.GetNewElement("v"))}catch(n){l("Create",n,Log.Type.Error)}};this.Load=function(m){try{g=$(m);this.BaseLoad(g)}catch(n){l("Load",n,Log.Type.Error)}};this.AddParam=function(n){try{var m=$(g.find(">values")[0]);var p;p=b.GetNewElement("n");m.append(p);if(n){$(p).text(Utilities.Trim(n.Name))}p=b.GetNewElement("f");m.append(p);if(n){$(p).text(Utilities.Trim(n.Format))}p=b.GetNewElement("v");m.append(p);if(n){$(p).text(n.Value)}}catch(o){l("AddParam",o,Log.Type.Error)}};this.DeleteParam=function(m){try{var r=g.find(">values>n")[m];var q=g.find(">values>f")[m];var o=g.find(">values>v")[m];r.parentNode.removeChild(r);q.parentNode.removeChild(q);o.parentNode.removeChild(o)}catch(p){l("DeleteParam",p,Log.Type.Error)}};this.Search=function(r,n){try{l("Search","Called",Log.Type.Info);this.HighlightAsFound(false);if(!r){return}var p=(n)?new RegExp(r,""):new RegExp(r,"i");if(this.GetID().search(p)>-1||this.GetComment().search(p)>-1){l("Search",this,Log.Type.Search);return}var m=this.GetParams();for(var o=0;o<m.length;o++){if(m[o].Name.search(p)>-1||m[o].Value.search(p)>-1){l("Search",this,Log.Type.Search);return}}}catch(q){l("Search",q,Log.Type.Error)}};this.GetProperties=function(){try{var n=this.GetBaseProperties();var m=new RulesMaker.ComplexArgs(this.GetProperties,null,null);n[n.length]=new PropertyEd.Property(c.MathParams,this.GetParams,this.SetParams,m);return n}catch(o){l("GetProperties",o,Log.Type.Error)}};this.GetParams=function(){try{var n=new Array();g.find(">values>n").each(function(){var q=$(this).text();var p=$(this).next().text();var o=$(this).next().next().text();n[n.length]=new k(q,p,o)});return n}catch(m){l("GetParams",m,Log.Type.Error)}};this.SetParams=function(q){try{var n,o;var m=g.find(">values>n");for(n=0;n<m.length;n++){h.DeleteParam(0)}for(n=0;n<q.length;n++){o=Utilities.Trim(q[n].Name);if(o){h.AddParam(q[n])}}}catch(p){l("SetParams",p,Log.Type.Error)}}}return a});define("rules/component/SelectQuery",["rules/BaseComponent","PropertyFields","Utilities","RuleXML","Undo","UndoObject"],function(c,b,d,a,g,f){function e(){this.inheritFrom=c;this.inheritFrom();this.Src="../../images/RuleSELECTQUERY.png";this.Title="Select Query Component";this.ToolTip="Performs a SQL select with parameters";var l="SelectQuery.";var k=this;var j=null;function m(q,p,o,n){Log.Add(l+q+"."+k.GetID(),p,o,n)}function h(n,p,o){this.Name=n;this.Type=p;this.Value=o}this.Create=function(){try{this.BaseCreate();this.SetType("SELECTQUERY");j=this.GetNode();var n=$(j.find(">values")[0]);n.append(a.GetNewElement("query"))}catch(o){m("Create",o,Log.Type.Error)}};this.Load=function(n){try{j=$(n);this.BaseLoad(j)}catch(o){m("Load",o,Log.Type.Error)}};this.AddParam=function(o){try{var n=$(j.find(">values")[0]);var q=$(a.GetNewElement("param"));var r;r=a.GetNewElement("n");q.append(r);if(o){$(r).text(d.Trim(o.Name))}r=a.GetNewElement("t");q.append(r);if(o){$(r).text(d.Trim(o.Type))}r=a.GetNewElement("v");q.append(r);if(o){$(r).html(a.GetNewCDATA(d.Trim(o.Value)))}n.append(q)}catch(p){m("AddParam",p,Log.Type.Error)}};this.DeleteParam=function(n){try{var o=j.find(">values>param")[n];o.parentNode.removeChild(o)}catch(p){m("DeleteParam",p,Log.Type.Error)}};this.Search=function(s,o){try{m("Search","Called",Log.Type.Info);this.HighlightAsFound(false);if(!s){return}var q=(o)?new RegExp(s,""):new RegExp(s,"i");if(this.GetID().search(q)>-1||this.GetComment().search(q)>-1||this.GetQuery().search(q)>-1){m("Search",this,Log.Type.Search);return}var n=this.GetQueryParams();for(var p=0;p<n.length;p++){if(n[p].Name.search(q)>-1||n[p].Value.search(q)>-1){m("Search",this,Log.Type.Search);return}}}catch(r){m("Search",r,Log.Type.Error)}};this.GetProperties=function(){try{var o=this.GetBaseProperties();o[o.length]=new PropertyEd.Property(b.Query,this.GetQuery,this.SetQuery);var n=new RulesMaker.ComplexArgs(this.GetProperties,null,null);o[o.length]=new PropertyEd.Property(b.QueryParams,this.GetQueryParams,this.SetQueryParams,n);return o}catch(p){m("GetProperties",p,Log.Type.Error)}};this.GetJ2=function(){try{return $(j.find(">j")[1]).text()}catch(n){m("GetJ2",n,Log.Type.Error)}};this.SetJ2=function(o){try{$(j.find(">j")[1]).text(o)}catch(n){m("SetJ2",n,Log.Type.Error)}};this.GetQuery=function(){try{var n=$(j.find(">values>query")[0]).text();return n.replace(/''/g,"'")}catch(o){m("GetQuery",o,Log.Type.Error)}};this.SetQuery=function(r){try{var n=r.replace(/'/g,"''");var q=a.GetNewCDATA(n);var p=a.GetNewElement("query");$(p).append(q);j.find(">values")[0].replaceChild(p,j.find(">values>query")[0])}catch(o){m("SetQuery",o,Log.Type.Error)}};this.GetQueryParams=function(){try{var o=new Array();j.find(">values>param").each(function(){var r=$(this);var s=r.find(">n").text();var q=r.find(">t").text().toUpperCase();var p=r.find(">v").text();o.push(new h(s,q,p))});return o}catch(n){m("GetQueryParams",n,Log.Type.Error)}};this.SetQueryParams=function(u){try{var q,o,r,p;var t=[];var n=j.find(">values>param");for(q=0;q<n.length;q++){k.DeleteParam(0)}for(q=0;q<u.length;q++){r=d.Trim(u[q].Name);if(r){k.AddParam(u[q]);t.push(r)}}for(q=0;q<t.length;q++){r=t[q].toUpperCase();for(o=0;o<t.length;o++){p=t[o].toUpperCase();if(o!=q&&p==r){jAlert("The parameter '"+t[q]+"' is used more than once!");return}}}}catch(s){m("SetQueryParams",s,Log.Type.Error)}}}return e});define("rules/CDATABatch",["RuleXML"],function(b){function a(){var c=new Array();function d(g,f){this.e=g;this.v=f}this.Add=function(e,f){c[c.length]=new d(e,f)};this.Process=function(){for(var e=0;e<c.length;e++){b.ReplaceCDATA(c[e].e,c[e].v)}}}return a});define("rules/component/Set",["rules/BaseComponent","PropertyFields","RuleXML","rules/CDATABatch","Undo","UndoObject"],function(d,c,b,a,g,f){function e(){this.inheritFrom=d;this.inheritFrom();this.Src="../../images/RuleSET.png";this.Title="Multi Set Component";this.ToolTip="Create, modify, or delete multiple variables with string expressions";var k="Set.";var j=this;var h=null;function m(q,p,o,n){Log.Add(k+q+"."+j.GetID(),p,o,n)}function l(n,o){this.Name=n;this.Value=o}this.Create=function(){try{this.BaseCreate();this.SetType("SET");h=this.GetNode();var n=$(h.find(">values")[0]);n.append(b.GetNewElement("n"));n.append(b.GetNewElement("v"))}catch(o){m("Create",o,Log.Type.Error)}};this.Load=function(n){try{h=$(n);this.BaseLoad(h)}catch(o){m("Load",o,Log.Type.Error)}};this.AddParam=function(o){try{var n=$(h.find(">values")[0]);var q;q=b.GetNewElement("n");n.append(q);if(o){$(q).html(b.GetNewCDATA(Utilities.Trim(o.Name)))}q=b.GetNewElement("v");n.append(q);if(o){$(q).html(b.GetNewCDATA(o.Value))}}catch(p){m("AddParam",p,Log.Type.Error)}};this.DeleteParam=function(o){try{var r=h.find(">values>n")[o];var p=h.find(">values>v")[o];r.parentNode.removeChild(r);p.parentNode.removeChild(p)}catch(q){m("DeleteParam",q,Log.Type.Error)}};this.Search=function(s,o){try{m("Search","Called",Log.Type.Info);this.HighlightAsFound(false);if(!s){return}var q=(o)?new RegExp(s,""):new RegExp(s,"i");if(this.GetID().search(q)>-1||this.GetComment().search(q)>-1){m("Search",this,Log.Type.Search);return}var n=this.GetParams();for(var p=0;p<n.length;p++){if(n[p].Name.search(q)>-1||n[p].Value.search(q)>-1){m("Search",this,Log.Type.Search);return}}}catch(r){m("Search",r,Log.Type.Error)}};this.GetProperties=function(){try{var o=this.GetBaseProperties();var n=new RulesMaker.ComplexArgs(this.GetProperties,null,null);o[o.length]=new PropertyEd.Property(c.SetParams,this.GetParams,this.SetParams,n);return o}catch(p){m("GetProperties",p,Log.Type.Error)}};this.GetParams=function(){try{var o=new Array();h.find(">values>n").each(function(){var q=$(this).text();var p=$(this).next().text();o[o.length]=new l(q,p)});return o}catch(n){m("GetParams",n,Log.Type.Error)}};this.SetParams=function(r){try{var o,p;var n=h.find(">values>n");for(o=0;o<n.length;o++){j.DeleteParam(0)}for(o=0;o<r.length;o++){p=Utilities.Trim(r[o].Name);if(p){j.AddParam(r[o])}}}catch(q){m("SetParams",q,Log.Type.Error)}}}return e});define("rules/component/Template",["rules/BaseComponent","PropertyFields","RuleXML","Undo","UndoObject"],function(d,c,a,f,e){function b(){this.inheritFrom=d;this.inheritFrom();this.Src="../../images/RuleTEMPLATE.png";this.Title="Template Component";this.ToolTip="Delivers a template to the specified screen target WITHOUT executing the pre-process function";var j="Template.";var h=this;var g=null;function k(o,n,m,l){Log.Add(j+o+"."+h.GetID(),n,m,l)}this.Create=function(){try{this.BaseCreate();this.SetType("TEMPLATE");g=this.GetNode();var l=$(g.find(">values")[0]);l.append(a.GetNewElement("n"));l.append(a.GetNewElement("t"))}catch(m){k("Create",m,Log.Type.Error)}};this.Load=function(l){try{g=$(l);this.BaseLoad(g)}catch(m){k("Load",m,Log.Type.Error)}};this.Search=function(o,l){try{k("Search","Called",Log.Type.Info);this.HighlightAsFound(false);if(!o){return}var m=(l)?new RegExp(o,""):new RegExp(o,"i");if(this.GetID().search(m)>-1||this.GetComment().search(m)>-1||this.GetName().search(m)>-1||this.GetTarget().search(m)>-1){k("Search",this,Log.Type.Search)}}catch(n){k("Search",n,Log.Type.Error)}};this.GetProperties=function(){try{var l=this.GetBaseProperties();l[l.length]=new PropertyEd.Property(c.Name,this.GetName,this.SetName);l[l.length]=new PropertyEd.Property(c.Target,this.GetTarget,this.SetTarget);return l}catch(m){k("GetProperties",m,Log.Type.Error)}};this.GetName=function(){try{return $(g.find(">values>n")[0]).text()}catch(l){k("GetName",l,Log.Type.Error)}};this.GetTarget=function(){try{return $(g.find(">values>t")[0]).text()}catch(l){k("GetTarget",l,Log.Type.Error)}};this.SetName=function(l){try{$(g.find(">values>n")[0]).text(l)}catch(m){k("SetName",m,Log.Type.Error)}};this.SetTarget=function(m){try{$(g.find(">values>t")[0]).text(m)}catch(l){k("SetTarget",l,Log.Type.Error)}}}return b});